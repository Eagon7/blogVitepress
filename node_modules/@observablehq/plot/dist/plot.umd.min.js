// @observablehq/plot v0.6.7 Copyright 2020-2023 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.8.4/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.8.4/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t){return null!=t&&!Number.isNaN(t)}function r(t,r){return+n(r)-+n(t)||e.ascending(t,r)}function o(t,r){return+n(r)-+n(t)||e.descending(t,r)}function i(t){return null!=t&&""!=`${t}`}function a(t){return isFinite(t)?t:NaN}function l(t){return t>0&&isFinite(t)?t:NaN}function s(t){return t<0&&isFinite(t)?t:NaN}function c(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${u(-a,6)}`:a>9999?`+${u(a,6)}`:u(a,4)}-${u(t.getUTCMonth()+1,2)}-${u(t.getUTCDate(),2)}${n||r||o||i?`T${u(n,2)}:${u(r,2)}${o||i?`:${u(o,2)}${i?`.${u(i,3)}`:""}`:""}Z`:""}`;var a}function u(t,e){return`${t}`.padStart(e,"0")}const f=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function h(t,e){return f.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const d=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["week",e.timeWeek],["month",e.timeMonth],["year",e.timeYear],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday]]),p=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.unixDay],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);function m(t,e){let n=`${t}`.toLowerCase();n.endsWith("s")&&(n=n.slice(0,-1));let r=1;const o=/^(?:(\d+)\s+)/.exec(n);switch(o&&(n=n.slice(o[0].length),r=+o[1]),n){case"quarter":n="month",r*=3;break;case"half":n="month",r*=6}let i=e.get(n);if(!i)throw new Error(`unknown interval: ${t}`);if(!(r>1))return i;if(!i.every)throw new Error(`non-periodic interval: ${n}`);return i.every(r)}function y(t){return m(t,d)}function g(t){return m(t,p)}const v=Object.getPrototypeOf(Uint8Array),x=Object.prototype.toString;function w(t,e,n){const r=typeof e;return"string"===r?b(t,M(e),n):"function"===r?b(t,e,n):"number"===r||e instanceof Date||"boolean"===r?G(t,B(e),n):k("function"==typeof e?.transform?e.transform(t):e,n)}function b(t,e,n){return G(t,n?.prototype instanceof v?function(t){return(e,n)=>I(t(e,n))}(e):e,n)}function k(t,e){return void 0===e?_(t):t instanceof e?t:e.prototype instanceof v&&!(t instanceof v)?e.from(t,I):e.from(t)}const $=[null],M=t=>e=>e[t],L={transform:rt},A={transform:t=>t},z=()=>1,S=()=>!0,E=t=>null==t?t:`${t}`,R=t=>null==t?t:+t,O=t=>t?t[0]:void 0,C=t=>t?t[1]:void 0,T=t=>t?t[2]:void 0,B=t=>()=>t;function N(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function P(t){return t instanceof v?t:G(t,I,Float64Array)}function I(t){return null==t?NaN:Number(t)}function W(t){return G(t,j)}function j(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?h(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function D(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:At(t)?[void 0,t]:[t,void 0]}function F(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function q(t,e,n){if(null!=t)return Y(t,e,n)}function Y(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function _(t){return null==t||t instanceof Array||t instanceof v?t:Array.from(t)}function G(t,e,n=Array){return null==t?t:t instanceof n?t.map(e):n.from(t,e)}function X(t,e=Array){return t instanceof e?t.slice():e.from(t)}function U({x:t,x1:e,x2:n}){return void 0!==t||void 0!==e||void 0!==n}function V({y:t,y1:e,y2:n}){return void 0!==t||void 0!==e||void 0!==n}function H(t){return U(t)||V(t)||void 0!==t.interval}function Z(t){return t?.toString===x}function Q(t){return Z(t)&&(void 0!==t.type||void 0!==t.domain)}function J(t){return Z(t)&&"function"!=typeof t.transform}function K(t){return J(t)&&void 0===t.value&&void 0===t.channel}function tt(t,e,n,r=A){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function et(t,e){return void 0===t&&void 0===e?[O,C]:[t,e]}function nt({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=D(e)),void 0===t&&([t]=D(n)),t}function rt(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function ot(t,e){return G(e,(e=>t[e]))}function at(t){return 1===t.length?(e,n)=>t(ot(n,e)):t}function lt(t){return null!==t&&"object"==typeof t?t.valueOf():t}function st(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function ct(t){let e;return[{transform:()=>e,label:ft(t)},t=>e=t]}function ut(t){return null==t?[t]:ct(t)}function ft(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function ht(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return bt(r)||bt(o)?G(r,((t,e)=>new Date((+r[e]+ +o[e])/2))):G(r,((t,e)=>(+r[e]+ +o[e])/2),Float64Array)},label:t.label}}function dt(t,e){const n=pt(e?.interval,e?.type);return n?G(t,n):t}function pt(t,e){const r=mt(t,e);return r&&(t=>n(t)?r.floor(t):t)}function mt(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,r)=>e.range(Math.ceil(t*n),r*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?y:g)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function yt(t,e){if((t=mt(t,e))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function gt(t){return void 0===t||J(t)?t:{value:t}}function vt(t){return t&&"function"==typeof t[Symbol.iterator]}function xt(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function wt(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function bt(t){for(const e of t)if(null!=e)return e instanceof Date}function kt(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&h(e)}function $t(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function Mt(t){for(const e of t)if(null!=e)return"number"==typeof e}function Lt(t,e){let n;for(const r of t)if(null!=r){if(!e(r))return!1;n=!0}return n}function At(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function zt(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function St(t){return null==t||Et(t)}function Et(t){return/^\s*none\s*$/i.test(t)}function Rt(t,e){return q(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Ot(t="middle"){return Rt(t,"frameAnchor")}function Ct(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function Tt(t){return vt(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}const Bt=Symbol("position"),Nt=Symbol("color"),Pt=Symbol("radius"),It=Symbol("length"),Wt=Symbol("opacity"),jt=Symbol("symbol"),Dt=new Map([["x",Bt],["y",Bt],["fx",Bt],["fy",Bt],["r",Pt],["color",Nt],["opacity",Wt],["symbol",jt],["length",It]]),Ft=Math.sqrt(3),qt=2/Ft,Yt={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*qt,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},_t=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",Yt],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function Gt(t){return t&&"function"==typeof t.draw}function Xt(t){return!!Gt(t)||"string"==typeof t&&_t.has(t.toLowerCase())}function Ut(t){if(null==t||Gt(t))return t;const e=_t.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function Vt({filter:t,sort:e,reverse:n,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=Kt(t)),null==e||K(e)||(r=Zt(r,ne(e))),n&&(r=Zt(r,te))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===e||K(e))&&{sort:e},transform:Zt(r,a)}}function Ht({filter:t,sort:e,reverse:n,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=Kt(t)),null==e||K(e)||(r=Qt(r,ne(e))),n&&(r=Qt(r,te))),{...o,...(null===e||K(e))&&{sort:e},initializer:Qt(r,i)}}function Zt(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o){return({data:n,facets:r}=t.call(this,n,r,o)),e.call(this,_(n),r,o)}}function Qt(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o,...i){let a,l,s,c,u,f;return({data:l=n,facets:s=r,channels:a}=t.call(this,n,r,o,...i)),({data:u=l,facets:f=s,channels:c}=e.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function Jt(t,e){return(null!=t.initializer?Ht:Vt)(t,e)}function Kt(t){return(e,n)=>{const r=w(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function te(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function ee(t,{sort:e,...n}={}){return{...(J(t)&&void 0!==t.channel?Ht:Jt)(n,ne(t)),sort:K(e)?e:null}}function ne(t){return("function"==typeof t&&1!==t.length?re:oe)(t)}function re(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function oe(t){let e,n;({channel:e,value:t,order:n}={...gt(t)});const i=e?.startsWith("-");if(i&&(e=e.slice(1)),void 0===n&&(n=i?o:r),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=r;break;case"descending":n=o;break;default:throw new Error(`invalid order: ${n}`)}return(r,o,i)=>{let a;if(void 0===e)a=w(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[e],!a)return{};a=a.value}const l=(t,e)=>n(a[t],a[e]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function ie(t,e){return ce(null,null,t,e)}function ae(t={y:"count"},e={}){const{x:n=A}=e;if(null==n)throw new Error("missing channel: x");return ce(n,null,t,e)}function le(t={x:"count"},e={}){const{y:n=A}=e;if(null==n)throw new Error("missing channel: y");return ce(null,n,t,e)}function se(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=et(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return ce(n,r,t,e)}function ce(t,e,{data:n=be,filter:r,sort:o,reverse:i,...a}={},l={}){a=fe(a,l),n=me(n,A),o=null==o?void 0:he("sort",o,l),r=null==r?void 0:de("filter",r,l);const[s,c]=ut(t),[u,f]=ut(e),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[b,k]=ut(h),[$]=D(d),[M]=D(p),[L,z]=ut($),[S,E]=ut(M);return{..."z"in l&&{z:b||h},..."fill"in l&&{fill:L||d},..."stroke"in l&&{stroke:S||p},...Vt(x,((l,s,u)=>{const d=dt(w(l,t),u?.x),p=dt(w(l,e),u?.y),m=w(l,h),y=w(l,$),g=w(l,M),v=ge(a,{z:m,fill:y,stroke:g}),x=[],b=[],L=d&&c([]),A=p&&f([]),S=m&&k([]),R=y&&z([]),O=g&&E([]);let C=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const e=[];for(const e of a)e.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of pe(t,v))for(const[t,c]of pe(s,p))for(const[s,u]of pe(c,d))if(!r||r.reduce(u)){e.push(C++),b.push(n.reduceIndex(u,l)),d&&L.push(s),p&&A.push(t),m&&S.push(v===m?i:m[u[0]]),y&&R.push(v===y?i:y[u[0]]),g&&O.push(v===g?i:g[u[0]]);for(const t of a)t.reduce(u);o&&o.reduce(u)}x.push(e)}return ve(x,o,i),{data:b,facets:x}})),...!ue(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!ue(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function ue(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function fe(t,e,n=he){const r=Object.entries(t);return null!=e.title&&void 0===t.title&&r.push(["title",$e]),null!=e.href&&void 0===t.href&&r.push(["href",ke]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):n(t,r,e)))}function he(t,e,n,r=de){let o;Z(e)&&"reduce"in e&&(o=e.scale,e=e.reduce);const i=r(t,e,n),[a,l]=ct(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,e){i.scope(t,e)},reduce(t,e){s.push(i.reduce(t,e))}}}function de(t,e,n,r=me){const o=st(t,n),i=r(e,o);let a,l;return{label:ft(i===Le?null:o,i.label),initialize(t){a=void 0===o?t:w(t,o),"data"===i.scope&&(l=i.reduceIndex(rt(t),a))},scope(t,e){i.scope===t&&(l=i.reduceIndex(e,a))},reduce:(t,e)=>null==i.scope?i.reduceIndex(t,a,e):i.reduceIndex(t,a,l,e)}}function pe(t,n){return n?e.sort(e.group(t,(t=>n[t])),O):[[,t]]}function me(t,n,r=ye){if(null==t)return r(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&Z(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return o=t,{reduceIndex:(t,e,n)=>o(ot(e,t),n)};var o;if(/^p\d{2}$/i.test(t))return xe(N(t));switch(`${t}`.toLowerCase()){case"first":return ke;case"last":return Me;case"identity":return be;case"count":return Le;case"distinct":return Ae;case"sum":return null==n?Le:ze;case"proportion":return Se(n,"data");case"proportion-facet":return Se(n,"facet");case"deviation":return xe(e.deviation);case"min":return xe(e.min);case"min-index":return xe(e.minIndex);case"max":return xe(e.max);case"max-index":return xe(e.maxIndex);case"mean":return we(e.mean);case"median":return we(e.median);case"variance":return xe(e.variance);case"mode":return xe(e.mode)}return r(t)}function ye(t){throw new Error(`invalid reduce: ${t}`)}function ge(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function ve(t,e,n){if(e){const n=e.output.transform(),o=(t,e)=>r(n[t],n[e]);t.forEach((t=>t.sort(o)))}n&&t.forEach((t=>t.reverse()))}function xe(t){return{reduceIndex:(e,n)=>t(e,(t=>n[t]))}}function we(t){return{reduceIndex(e,n){const r=t(e,(t=>n[t]));return bt(n)?new Date(r):r}}}const be={reduceIndex:(t,e)=>ot(e,t)},ke={reduceIndex:(t,e)=>e[t[0]]},$e={reduceIndex(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),C),o=r.slice(-5).reverse();if(o.length<r.length){const t=r.slice(0,-4);o[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,C)]}return o.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},Me={reduceIndex:(t,e)=>e[t[t.length-1]]},Le={label:"Frequency",reduceIndex:t=>t.length},Ae={label:"Distinct",reduceIndex(t,n){const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},ze=xe(e.sum);function Se(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,e,n=1)=>t.length/n}:{scope:n,reduceIndex:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function Ee(t,{scale:e,type:n,value:r,filter:o,hint:i},a){return void 0===i&&"function"==typeof r?.transform&&(i=r.hint),Ce(a,{scale:e,type:n,value:w(t,r),label:ft(r),filter:o,hint:i})}function Re(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,Ee(e,n,t)])))}function Oe(t,e){const n=Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{const o=null==n?null:e[n];return[t,null==o?r:G(r,o)]})));return n.channels=t,n}function Ce(t,e){const{scale:n,value:r}=e;if(!0===n||"auto"===n)switch(t){case"fill":case"stroke":case"color":e.scale=!0!==n&&Lt(r,At)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=!0!==n&&Lt(r,zt)?null:"opacity";break;case"symbol":!0!==n&&Lt(r,Xt)?(e.scale=null,e.value=G(r,Ut)):e.scale="symbol";break;default:e.scale=Dt.has(t)?t:null}else if(!1===n)e.scale=null;else if(null!=n&&!Dt.has(n))throw new Error(`unknown scale: ${n}`);return e}function Te(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function Be(t,e){const n=t.original;if(n===t)return e;const r=e.value,o=e.value=[];for(let e=0;e<n.length;++e){const i=r[n[e][0]];for(const n of t[e])o[n]=i}return e}function Ne(t,e,n){const r=Pe(t,e);return G(Pe(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function Pe(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function Ie(t){if(null==t||"function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"ascending":return We;case"descending":return je}throw new Error(`invalid order: ${t}`)}function We([t,e],[n,o]){return r(e,o)||r(t,n)}function je([t,e],[n,i]){return o(e,i)||r(t,n)}function De(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return null===n.source?null:n}}function Fe(t={}){const{document:e=("undefined"!=typeof window?window.document:void 0)}=t;return{document:e}}function qe(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}let Ye=0;function _e(t){console.warn(t),++Ye}const Ge=Math.PI,Xe=2*Ge,Ue=.618;function Ve({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},l){if(null==t)return;if("function"==typeof t.stream)return t;let s,c,u="frame";if(Z(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:u=u,...s}=t),null==t)return}"function"!=typeof t&&({type:t}=He(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:y}=l,g=f-d-p-a-o,v=h-m-y-r-i;if(t=t?.({width:g,height:v,clip:u,...s}),null==t)return;u=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-y);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(g/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-g)/2,b-=(a*(r+i)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):_e("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?Je():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function He(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Ze(e.geoAlbersUsa,.7463,.4673);case"albers":return Qe(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return Ze(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return Ze(e.geoAzimuthalEquidistant,Xe,Xe);case"conic-conformal":return Qe(e.geoConicConformal,Xe,Xe);case"conic-equal-area":return Qe(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return Qe(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return Ze(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return Ze(e.geoEquirectangular,Xe,Ge);case"gnomonic":return Ze(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:Je};case"reflect-y":return{type:Ke};case"mercator":return Ze(e.geoMercator,Xe,Xe);case"orthographic":return Ze(e.geoOrthographic,2,2);case"stereographic":return Ze(e.geoStereographic,2,2);case"transverse-mercator":return Ze(e.geoTransverseMercator,Xe,Xe);default:throw new Error(`unknown projection type: ${t}`)}}function Ze(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/e,o/n)),s.translate([r/2,o/2]),s},aspectRatio:n/e}}function Qe(t,e,n){const{type:r,aspectRatio:o}=Ze(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const Je=B({stream:t=>t}),Ke=B(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function tn(t,e,n,r){const o=n[t],i=n[e],a=o.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){l[c]=t,s[c]=e}});for(c=0;c<a;++c)u.point(o[c],i[c])}function en(t,e,{projection:n}){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=Oe(i,e),n&&"x"===r?.scale&&"y"===o?.scale&&tn("x","y",i,n),r&&(i.x=P(i.x)),o&&(i.y=P(i.y)),i}const nn=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10]]);const rn=new Map([...nn,["brbg",an(e.schemeBrBG,e.interpolateBrBG)],["prgn",an(e.schemePRGn,e.interpolatePRGn)],["piyg",an(e.schemePiYG,e.interpolatePiYG)],["puor",an(e.schemePuOr,e.interpolatePuOr)],["rdbu",an(e.schemeRdBu,e.interpolateRdBu)],["rdgy",an(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",an(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",an(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",an(e.schemeSpectral,e.interpolateSpectral)],["burd",ln(e.schemeRdBu,e.interpolateRdBu)],["buylrd",ln(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",on(e.schemeBlues,e.interpolateBlues)],["greens",on(e.schemeGreens,e.interpolateGreens)],["greys",on(e.schemeGreys,e.interpolateGreys)],["oranges",on(e.schemeOranges,e.interpolateOranges)],["purples",on(e.schemePurples,e.interpolatePurples)],["reds",on(e.schemeReds,e.interpolateReds)],["turbo",sn(e.interpolateTurbo)],["viridis",sn(e.interpolateViridis)],["magma",sn(e.interpolateMagma)],["inferno",sn(e.interpolateInferno)],["plasma",sn(e.interpolatePlasma)],["cividis",sn(e.interpolateCividis)],["cubehelix",sn(e.interpolateCubehelixDefault)],["warm",sn(e.interpolateWarm)],["cool",sn(e.interpolateCool)],["bugn",on(e.schemeBuGn,e.interpolateBuGn)],["bupu",on(e.schemeBuPu,e.interpolateBuPu)],["gnbu",on(e.schemeGnBu,e.interpolateGnBu)],["orrd",on(e.schemeOrRd,e.interpolateOrRd)],["pubu",on(e.schemePuBu,e.interpolatePuBu)],["pubugn",on(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",on(e.schemePuRd,e.interpolatePuRd)],["rdpu",on(e.schemeRdPu,e.interpolateRdPu)],["ylgn",on(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",on(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",on(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",on(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",cn(e.interpolateRainbow)],["sinebow",cn(e.interpolateSinebow)]]);function on(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function an(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function ln(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function sn(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function cn(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function un(t){const e=`${t}`.toLowerCase();if(!rn.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return rn.get(e)}function fn(t,e){const n=un(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const hn=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function dn(t){const e=`${t}`.toLowerCase();if(!hn.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return hn.get(e)}const pn=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);const mn=t=>e=>t(1-e),yn=[0,1],gn=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function vn(t){const e=`${t}`.toLowerCase();if(!gn.has(e))throw new Error(`unknown interpolator: ${e}`);return gn.get(e)}function xn(t,n,r,{type:o,nice:i,clamp:a,zero:l,domain:s=$n(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(Dt.get(t)===Pt?Ln(r,s):Dt.get(t)===It?An(r,s):Dt.get(t)===Wt?yn:void 0),interpolate:p=(Dt.get(t)===Nt?null==f&&void 0!==d?e.interpolateRgb:dn(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=yt(h,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),m=!!m,"function"!=typeof p&&(p=vn(p)),1===p.length?(m&&(p=mn(p),m=!1),void 0===d&&2===(d=Float64Array.from(s,((t,e)=>e/(s.length-1)))).length&&(d=yn),n.interpolate((d===yn?B:En)(p))):n.interpolate(p),l){const[t,n]=e.extent(s);(t>0||n<0)&&(Ct(s=X(s))!==Math.sign(t)?s[s.length-1]=0:s[0]=0)}return m&&(s=e.reverse(s)),n.domain(s).unknown(c),i&&(n.nice(function(t,e){return!0===t?void 0:"number"==typeof t?t:function(t,e){if((t=yt(t,e))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,e)}(i,o)),s=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:s,range:d,scale:n,interpolate:p,interval:h}}function wn(t,n,{exponent:r=1,...o}){return xn(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function bn(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?e.quantize(a,r.length+1):Dt.get(t)===Nt?fn(i,r.length+1):void 0),reverse:s}){const c=Ct(r=_(r));if(!isNaN(c)&&!function(t,n){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=e.descending(i,i=t[r]);if(0!==o&&o!==n)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=e.reverse(l)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function kn(t,n=a){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function $n(t,e){const n=Dt.get(t);return(n===Pt||n===Wt||n===It?Mn:kn)(e)}function Mn(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,a))):1]}function Ln(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,l))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function An(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function zn(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n>0)return kn(t,l);if(n<0)return kn(t,s)}return[1,10]}function Sn(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function En(t){return(e,n)=>r=>t(e+r*(n-e))}function Rn(t,n,r,o,{type:i,nice:a,clamp:l,domain:s=kn(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(Dt.get(t)===Nt?null==f&&void 0!==h?e.interpolateRgb:dn(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u;let[y,g]=s;if(e.descending(y,g)<0&&([y,g]=[g,y],m=!m),y=Math.min(y,u),g=Math.max(g,u),"function"!=typeof p&&(p=vn(p)),void 0!==h&&(p=1===p.length?En(p)(...h):e.piecewise(p,h)),m&&(p=mn(p)),d){const t=r.apply(u),e=t-r.apply(y),n=r.apply(g)-t;e<n?y=r.invert(t-n):e>n&&(g=r.invert(t+e))}return n.domain([y,u,g]).unknown(c).interpolator(p),l&&n.clamp(l),a&&n.nice(a),{type:i,domain:[y,g],pivot:u,interpolate:p,scale:n}}function On(t,n,{exponent:r=1,...o}){return Rn(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Nn:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function Cn(t,n,{constant:r=1,...o}){return Rn(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Tn={apply:t=>t,invert:t=>t},Bn={apply:Math.log,invert:Math.exp},Nn={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Pn(t,e,n,r){return xn(t,e,n,r)}const In=Symbol("ordinal");function Wn(t,n,r,{type:o,interval:i,domain:a,range:l,reverse:s,hint:c}){return i=yt(i,o),void 0===a&&(a=Fn(r,i,t)),"categorical"!==o&&o!==In||(o="ordinal"),s&&(a=e.reverse(a)),n.domain(a),void 0!==l&&("function"==typeof l&&(l=l(a)),n.range(l)),{type:o,domain:a,range:l,scale:n,hint:c,interval:i}}function jn(t,n,{type:r,interval:o,domain:i,range:a,scheme:l,unknown:s,...c}){let u;if(o=yt(o,r),void 0===i&&(i=Fn(n,o,t)),Dt.get(t)===jt)u=function(t){return{fill:qn(t,"fill"),stroke:qn(t,"stroke")}}(n),a=void 0===a?function(t){return St(t.fill)?e.symbolsStroke:e.symbolsFill}(u):G(a,Ut);else if(Dt.get(t)===Nt&&(void 0!==a||"ordinal"!==r&&r!==In||(a=function(t,e="greys"){const n=new Set,[r,o]=fn(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,l),void 0!==a&&(l=void 0)),void 0===l&&void 0===a&&(l="ordinal"===r?"turbo":"tableau10"),void 0!==l))if(void 0!==a){const t=dn(l),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=un(l);if(s===e.scaleImplicit)throw new Error(`implicit unknown on ${t} scale is not supported`);return Wn(t,e.scaleOrdinal().unknown(s),n,{...c,type:r,domain:i,range:a,hint:u})}function Dn(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=Wn(r,t,e,n)).round=o,t}function Fn(t,n,o){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&Dt.get(o)===Bt)throw new Error(`implicit ordinal domain of ${o} scale has more than 10,000 values`);return e.sort(i,r)}function qn(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Yn(t,{label:e,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=e}={},...m}={}){const y={};for(const[n,g]of t){const t=m[n],v=Kn(n,g,{round:Dt.get(n)===Bt?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===n||"fy"===n?p:e),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===n?r:0),insetRight:h=(void 0!==u?u:"x"===n?o:0),insetBottom:d=(void 0!==u?u:"y"===n?i:0),insetLeft:m=(void 0!==u?u:"x"===n?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?Gn(g,v):l,v.transform=c,"x"===n||"fx"===n?(v.insetLeft=+m,v.insetRight=+h):"y"!==n&&"fy"!==n||(v.insetTop=+f,v.insetBottom=+d),y[n]=v}}return y}function _n(t){return Object.fromEntries(Object.entries(t).filter((([,{scale:t}])=>t)).map((([t,{scale:e,type:n,interval:r,label:o}])=>(e.type=n,null!=r&&(e.interval=r),null!=o&&(e.label=o),[t,e]))))}function Gn(t=[],e){let n;for(const{label:e}of t)if(void 0!==e)if(void 0===n)n=e;else if(n!==e)return;if(void 0!==n)return!or(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function Xn(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function Un({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Xn(n);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:e?e.scale.bandwidth()+r+i:s,facet:{width:l,height:s}}}function Vn(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,l=i+n,s=o-a-r;t.range=[l,Math.max(l,s)],or(t)||(t.range=Qn(t)),t.scale.range(t.range)}Zn(t)}function Hn(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,l=i+n,s=o-a-r;t.range=[Math.max(l,s),l],or(t)?t.range.reverse():t.range=Qn(t),t.scale.range(t.range)}Zn(t)}function Zn(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,l=Math.abs(r-n)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function Qn(t){const e=t.scale.domain().length+ir(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,o)=>n+o/(e-1)*(r-n)))}function Jn(t,e,n){return Kn(t,void 0===n?void 0:[{hint:n}],{...e})}function Kn(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:l}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(n=er);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===er)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const s=Dt.get(t);if(s===Pt)return"sqrt";if(s===Wt||s===It)return"linear";if(s===jt)return"ordinal";if((r||o||[]).length>2)return nr(s);if(void 0!==r){if(wt(r))return nr(s);if(bt(r))return"utc"}else{const t=e.map((({value:t})=>t)).filter((t=>void 0!==t));if(t.some(wt))return nr(s);if(t.some(bt))return"utc"}if(s===Nt){if(null!=a||function(t){return null!=t&&pn.has(`${t}`.toLowerCase())}(i))return"diverging";if(function(t){return null!=t&&nn.has(`${t}`.toLowerCase())}(i))return"categorical"}return"linear"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&or({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(bt)?_e(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${tr(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${tr(o)}".`):e.some(kt)?_e(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${tr(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${tr(o)}".`):e.some($t)&&_e(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${tr(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${tr(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=lr(n,r,P);break;case"identity":switch(Dt.get(t)){case Bt:r=lr(n,r,P);break;case jt:r=lr(n,r,sr)}break;case"utc":case"time":r=lr(n,r,W)}switch(o){case"diverging":return function(t,n,r){return Rn(t,e.scaleDiverging(),Tn,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return On(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return On(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=kn(n,o<0?s:l),...a}){return Rn(t,e.scaleDivergingLog().base(r=+r),Bn,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return Cn(t,n,r);case"categorical":case"ordinal":case In:return jn(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return xn(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return wn(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return bn(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:l=Sn(n),unknown:s,interpolate:c,reverse:u}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):Dt.get(t)===Nt?fn(a,i):void 0),l.length>0&&(l=e.scaleQuantile(l,void 0===r?{length:i}:r).quantiles()),bn(t,0,{domain:l,range:r,reverse:u,unknown:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=$n(t,n),unknown:l,interpolate:s,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,o),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==s?e.quantize(s,o):Dt.get(t)===Nt?fn(i,o):void 0):(h=e.quantize(e.interpolateNumber(u,f),o+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),Ct(_(a))<0&&h.reverse(),bn(t,0,{domain:h,range:r,reverse:c,unknown:l})}(t,n,r);case"pow":return wn(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=zn(n),...i}){return xn(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return xn(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return Pn(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Pn(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return Dn(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...l}){return Dn(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,l,t)}(t,n,r);case"identity":return Dt.get(t)===Bt?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}function tr(t){return"symbol"==typeof t?t.description:t}const er={toString:()=>"projection"};function nr(t){switch(t){case Bt:return"point";case Nt:return In;default:return"ordinal"}}function rr({type:t}){return"time"===t||"utc"===t}function or({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===In}function ir({type:t}){return"threshold"===t}function ar(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function lr(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function sr(t){return G(t,Ut)}function cr({scale:t,type:e,domain:n,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:e,domain:X(n),...void 0!==r&&{range:X(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function ur(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const fr=ur((t=>new Intl.NumberFormat(t))),hr=ur(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),dr=ur(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function pr(t){return c(t,"Invalid Date")}const mr=function(t="en-US"){const e=function(t="en-US"){const e=fr(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?pr:"number"==typeof t?e:E)(t)}(),yr=("undefined"!=typeof window?window.devicePixelRatio>1:"undefined"==typeof it)?0:.5;let gr=0;function vr(){return"plot-clip-"+ ++gr}function xr(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,imageFilter:x,paintOrder:w,pointerEvents:b,shapeRendering:k},{ariaLabel:$,fill:M="currentColor",fillOpacity:L,stroke:A="none",strokeOpacity:z,strokeWidth:S,strokeLinecap:R,strokeLinejoin:O,strokeMiterlimit:C,paintOrder:T}){null===M&&(l=null,s=null),null===A&&(c=null,f=null),St(M)?St(A)||St(l)||(A="none"):St(A)&&!St(c)&&(M="none");const[B,N]=D(l,M),[P,I]=F(s,L),[W,j]=D(c,A),[q,Y]=F(f,z),[_,G]=F(g);Et(j)||(void 0===u&&(u=S),void 0===d&&(d=R),void 0===h&&(h=O),void 0!==p||/^\s*round\s*$/i.test(h)||(p=C),Et(N)||void 0!==w||(w=T));const[X,U]=F(u);return null!==M&&(t.fill=Or(N,"currentColor"),t.fillOpacity=Cr(I,1)),null!==A&&(t.stroke=Or(j,"none"),t.strokeWidth=Cr(U,1),t.strokeOpacity=Cr(Y,1),t.strokeLinejoin=Or(h,"miter"),t.strokeLinecap=Or(d,"butt"),t.strokeMiterlimit=Cr(p,4),t.strokeDasharray=Or(m,"none"),t.strokeDashoffset=Or(y,"0")),t.target=E(a),t.ariaLabel=E($),t.ariaDescription=E(o),t.ariaHidden=E(i),t.opacity=Cr(G,1),t.mixBlendMode=Or(v,"normal"),t.imageFilter=Or(x,"none"),t.paintOrder=Or(w,"normal"),t.pointerEvents=Or(b,"auto"),t.shapeRendering=Or(k,"auto"),{title:{value:e,optional:!0},href:{value:n,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:B,scale:"auto",optional:!0},fillOpacity:{value:P,scale:"auto",optional:!0},stroke:{value:W,scale:"auto",optional:!0},strokeOpacity:{value:q,scale:"auto",optional:!0},strokeWidth:{value:X,optional:!0},opacity:{value:_,scale:"auto",optional:!0}}}function wr(t,e){e&&t.text((t=>mr(e[t])))}function br(t,e){e&&t.text((([t])=>mr(e[t])))}function kr(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&Er(t,"aria-label",(t=>r[t])),a&&Er(t,"fill",(t=>a[t])),l&&Er(t,"fill-opacity",(t=>l[t])),s&&Er(t,"stroke",(t=>s[t])),c&&Er(t,"stroke-opacity",(t=>c[t])),u&&Er(t,"stroke-width",(t=>u[t])),f&&Er(t,"opacity",(t=>f[t])),h&&Sr(t,(t=>h[t]),e),n||function(t,e){e&&t.filter((t=>i(e[t]))).append("title").call(wr,e)}(t,o)}function $r(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&Er(t,"aria-label",(([t])=>r[t])),a&&Er(t,"fill",(([t])=>a[t])),l&&Er(t,"fill-opacity",(([t])=>l[t])),s&&Er(t,"stroke",(([t])=>s[t])),c&&Er(t,"stroke-opacity",(([t])=>c[t])),u&&Er(t,"stroke-width",(([t])=>u[t])),f&&Er(t,"opacity",(([t])=>f[t])),h&&Sr(t,(([t])=>h[t]),e),n||function(t,e){e&&t.filter((([t])=>i(e[t]))).append("title").call(br,e)}(t,o)}function Mr(t,n,r){const o=e.group(t,(t=>n[t]));return void 0===r&&o.size>t.length>>1&&_e("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),o.values()}function*Lr(t,e,r,o){const{z:i}=r,{z:a}=o,l=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s},{tip:c}){return[t,c?void 0:e,n,r,o,i,a,l,s].filter((t=>void 0!==t))}(o,r),s=[...e,...l];for(const e of a?Mr(t,a,i):[t]){let t,r;t:for(const o of e){for(const t of s)if(!n(t[o])){r&&r.push(-1);continue t}if(void 0!==t){r.push(o);for(let e=0;e<l.length;++e){if(lt(l[e][o])!==t[e]){yield r,t=l.map((t=>lt(t[o]))),r=[o];continue t}}}else r&&(yield r),t=l.map((t=>lt(t[o]))),r=[o]}r&&(yield r)}}function Ar(t,n,r,o){!function(t,n,r,o){let i;switch(n.clip){case"frame":{const{width:e,height:n,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=r,u=vr();i=`url(#${u})`,t=qe("svg:g",o).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",e-l-a).attr("height",n-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=vr();i=`url(#${r})`,t.append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}Er(t,"aria-label",n.ariaLabel),Er(t,"aria-description",n.ariaDescription),Er(t,"aria-hidden",n.ariaHidden),Er(t,"clip-path",i)}(t,n,r,o),Er(t,"fill",n.fill),Er(t,"fill-opacity",n.fillOpacity),Er(t,"stroke",n.stroke),Er(t,"stroke-width",n.strokeWidth),Er(t,"stroke-opacity",n.strokeOpacity),Er(t,"stroke-linejoin",n.strokeLinejoin),Er(t,"stroke-linecap",n.strokeLinecap),Er(t,"stroke-miterlimit",n.strokeMiterlimit),Er(t,"stroke-dasharray",n.strokeDasharray),Er(t,"stroke-dashoffset",n.strokeDashoffset),Er(t,"shape-rendering",n.shapeRendering),Er(t,"filter",n.imageFilter),Er(t,"paint-order",n.paintOrder),Er(t,"pointer-events",n.pointerEvents)}function zr(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),Er(t,"opacity",e.opacity)}function Sr(t,n,r){t.each((function(t){const o=n(t);if(null!=o){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",o),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Er(t,e,n){null!=n&&t.attr(e,n)}function Rr(t,e,{x:n,y:r},o=yr,i=yr){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function Or(t,e){if((t=E(t))!==e)return t}function Cr(t,e){if((t=R(t))!==e)return t}const Tr=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Br(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!Tr.test(t))throw new Error(`invalid class name: ${t}`);return t}function Nr(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function Pr({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}function Ir({x:t,y:e,fy:n,fx:r},o,{projection:i,aspectRatio:a},{width:l,marginTopDefault:s,marginRightDefault:c,marginBottomDefault:u,marginLeftDefault:f}){const h=n?n.scale.domain().length:1,d=function(t,e){if("function"==typeof t?.stream)return Ue;if(Z(t)&&(t=t.type),null==t)return function(t){for(const e of t)if(e.channels.geometry)return!0;return!1}(e)?Ue:void 0;if("function"!=typeof t){const{aspectRatio:e}=He(t);if(e)return e}return Ue}(i,o);if(d){const t=(1.1*h-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*d,e=Math.max(.1,Math.min(10,t));return Math.round((l-f-c)*e+s+u)}const p=e?or(e)?e.scale.domain().length:Math.max(7,17/h):1;if(null!=a){if(a=+a,!(isFinite(a)&&a>0))throw new Error(`invalid aspectRatio: ${a}`);const o=Wr("y",e)/(Wr("x",t)*a),i=r?r.scale.bandwidth():1,h=n?n.scale.bandwidth():1;return(o*(i*(l-f-c)-t.insetLeft-t.insetRight)+e.insetTop+e.insetBottom)/h+s+u}return!(!e&&!n)*Math.max(1,Math.min(60,p*h))*20+30*!!r+60}function Wr(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:r,domain:o}=n;let i;switch(r){case"linear":case"utc":case"time":i=Number;break;case"pow":{const t=n.scale.exponent();i=e=>Math.pow(e,t);break}case"log":i=Math.log;break;case"point":case"band":return o.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${r}`)}const[a,l]=e.extent(o);return Math.abs(i(l)-i(a))}function jr(t,{fx:n,fy:r}){const o=rt(t),i=n?.value,a=r?.value;return n&&r?e.rollup(o,(t=>(t.fx=i[t[0]],t.fy=a[t[0]],t)),(t=>i[t]),(t=>a[t])):n?e.rollup(o,(t=>(t.fx=i[t[0]],t)),(t=>i[t])):e.rollup(o,(t=>(t.fy=a[t[0]],t)),(t=>a[t]))}function Dr(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let o=0;for(const n of t)e!==n&&(r.set(n,o),o+=n.length);n.push(r.slice(0,o))}return n}const Fr=new Map([["top",Xr],["right",Hr],["bottom",Ur],["left",Vr],["top-left",Zr(Xr,Vr)],["top-right",Zr(Xr,Hr)],["bottom-left",Zr(Ur,Vr)],["bottom-right",Zr(Ur,Hr)],["top-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=_r(e,r);if(i>0)return Gr(t,n,e[i-1])}],["right-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=_r(e,n);if(i<e.length-1)return Gr(t,e[i+1],r)}],["bottom-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=_r(e,r);if(i<e.length-1)return Gr(t,n,e[i+1])}],["left-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=_r(e,n);if(i>0)return Gr(t,e[i-1],r)}],["empty",function(t,e,{empty:n}){return n}]]);const qr=new WeakMap;function Yr(t){let n=qr.get(t);return n||qr.set(t,n=new e.InternMap(G(t,((t,e)=>[t,e])))),n}function _r(t,e){return Yr(t).get(e)}function Gr(t,e,n){return function(t,e,n){return e=lt(e),n=lt(n),t.find((t=>Object.is(lt(t.x),e)&&Object.is(lt(t.y),n)))}(t,e,n)?.empty}function Xr(t,{y:e},{y:n}){return!e||0===_r(e,n)}function Ur(t,{y:e},{y:n}){return!e||_r(e,n)===e.length-1}function Vr(t,{x:e},{x:n}){return!e||0===_r(e,n)}function Hr(t,{x:e},{x:n}){return!e||_r(e,n)===e.length-1}function Zr(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function Qr(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e)??[])):e?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}class Jr{constructor(t,e={},n={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y,channels:g,tip:v,render:x}=n;if(this.data=t,this.sort=K(s)?s:null,this.initializer=Ht(n).initializer,this.transform=this.initializer?n.transform:Vt(n).transform,null===o||!1===o?this.facet=null:(this.facet=Y(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===$&&"string"==typeof a?[a]:a,this.fy=t===$&&"string"==typeof l?[l]:l),this.facetAnchor=function(t){if(null==t)return null;const e=Fr.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}(i),e=Tt(e),void 0!==g&&(e={...eo(g),...e}),void 0!==r&&(e={...xr(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).map((([e,n])=>{if(J(n.value)){const{value:t,scale:e=n.scale}=n.value;n={...n,scale:e,value:t}}if(t===$&&"string"==typeof n.value){const{value:t}=n;n={...n,value:[t]}}return[e,n]})).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),q(t,"clip",["frame","sphere"])}(y),this.tip=function(t){return!0===t?"xy":!1===t?null:q(t,"tip",["x","y","xy"])}(v),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:n}=e[t];if("x"===n||"y"===n)throw new Error("super-faceting cannot use x or y")}}null!=x&&(this.render=to(x,this.render))}initialize(t,n,r){let o=_(this.data);void 0===t&&null!=o&&(t=[rt(o)]);const i=t;null!=this.transform&&(({facets:t,data:o}=this.transform(o,t,r)),o=_(o)),void 0!==t&&(t.original=i);const a=Re(this.channels,o);return null!=this.sort&&function(t,n,r,o,i){const{order:a,reverse:l,reduce:s=!0,limit:c}=i;for(const u in i){if(!Dt.has(u))continue;let{value:f,order:h=a,reverse:d=l,reduce:p=s,limit:m=c}=gt(i[u]);const y=f?.startsWith("-");if(y&&(f=f.slice(1)),h=void 0===h?y!==("width"===f||"height"===f)?je:We:Ie(h),null==p||!1===p)continue;const g="fx"===u||"fy"===u?Be(n,o[u]):Te(r,u);if(!g)throw new Error(`missing channel for scale: ${u}`);const v=g.value,[x=0,w=1/0]=vt(m)?m:m<0?[m]:[0,m];if(null==f)g.domain=()=>{let t=Array.from(new e.InternSet(v));return d&&(t=t.reverse()),0===x&&w===1/0||(t=t.slice(x,w)),t};else{const n="data"===f?t:"height"===f?Ne(r,"y1","y2"):"width"===f?Ne(r,"x1","x2"):Pe(r,f,"y"===f?"y2":"x"===f?"x2":void 0),o=me(!0===p?"max":p,n);g.domain=()=>{let t=e.rollups(rt(v),(t=>o.reduceIndex(t,n)),(t=>v[t]));return h&&t.sort(h),d&&t.reverse(),0===x&&w===1/0||(t=t.slice(x,w)),t.map(O)}}}}(o,t,a,n,this.sort),{data:o,facets:t,channels:a}}filter(t,e,r){for(const o in e){const{filter:i=n}=e[o];if(null!==i){const e=r[o];t=t.filter((t=>i(e[t])))}}return t}project(t,e,n){for(const r in t)if("x"===t[r].scale&&/^x|x$/.test(r)){const o=r.replace(/^x|x$/,"y");o in t&&"y"===t[o].scale&&tn(r,o,e,n.projection)}}scale(t,e,n){const r=Oe(t,e);return n.projection&&this.project(t,r,n),r}}function Kr(...t){return t.plot=Jr.prototype.plot,t}function to(t,e){if(null==t)return null===e?void 0:e;if(null==e)return null===t?void 0:t;if("function"!=typeof t)throw new TypeError(`invalid render transform: ${t}`);if("function"!=typeof e)throw new TypeError(`invalid render transform: ${e}`);return function(n,r,o,i,a,l){return t.call(this,n,r,o,i,a,((t,n,r,o,i)=>e.call(this,t,n,r,o,i,l)))}}function eo(t){return Object.fromEntries(Object.entries(Tt(t)).map((([t,e])=>(void 0===(e=gt(e)).filter&&null==e.scale&&(e={...e,filter:null}),[t,e]))))}function no(t,e){return!0===t?.tip?{...t,tip:e}:t}const ro=new WeakMap;function oo(t,n,{x:r,y:o,px:i,py:a,maxRadius:l=40,channels:s,render:c,...u}={}){return l=+l,null!=i&&(r??=null,s={...s,px:{value:i,scale:"x"}}),null!=a&&(o??=null,s={...s,py:{value:a,scale:"y"}}),{x:r,y:o,channels:s,...u,render:to((function(r,o,i,a,s,c){const u=s.ownerSVGElement,{data:f}=s.getMarkState(this);let h=ro.get(u);h||ro.set(u,h={sticky:!1,roots:[],renders:[]});let d=h.renders.push(C)-1;const{x:p,y:m,fx:y,fy:g}=o;let v=y?y(r.fx)-a.marginLeft:0,x=g?g(r.fy)-a.marginTop:0;p?.bandwidth&&(v+=p.bandwidth()/2),m?.bandwidth&&(x+=m.bandwidth()/2);const w=null!=r.fi;let b;if(w){let t=h.facetStates;t||(h.facetStates=t=new Map),b=t.get(this),b||t.set(this,b=new Map)}const[k,$]=Pr(this,a),{px:M,py:L}=i,A=M?t=>M[t]:so(i,k),z=L?t=>L[t]:co(i,$);let S,E,R;function O(t,e){if(w){if(R&&(R=cancelAnimationFrame(R)),null!=t)return b.set(r.fi,e),void(R=requestAnimationFrame((()=>{R=null;for(const n of b.values())if(n<e){t=null;break}C(t)})));b.delete(r.fi)}C(t)}function C(t){if(S===t)return;S=t;const e=null==S?[]:[S];w&&(e.fx=r.fx,e.fy=r.fy,e.fi=r.fi);const n=c(e,o,i,a,s);if(E){if(w){const t=E.parentNode,e=E.getAttribute("transform"),r=n.getAttribute("transform");e?n.setAttribute("transform",e):n.removeAttribute("transform"),r?t.setAttribute("transform",r):t.removeAttribute("transform"),n.removeAttribute("aria-label"),n.removeAttribute("aria-description"),n.removeAttribute("aria-hidden")}E.replaceWith(n)}return h.roots[d]=E=n,s.dispatchValue(null==S?null:f[S]),n}function T(o){if(h.sticky||"mouse"===o.pointerType&&1===o.buttons)return;let[i,a]=e.pointer(o);i-=v,a-=x;let s=null,c=l*l;for(const e of r){const r=t*(A(e)-i),o=n*(z(e)-a),l=r*r+o*o;l<=c&&(s=e,c=l)}O(s,c)}return u.addEventListener("pointerenter",T),u.addEventListener("pointermove",T),u.addEventListener("pointerdown",(function(t){"mouse"===t.pointerType&&null!=S&&(h.sticky&&h.roots.some((e=>e?.contains(t.target)))||(h.sticky?(h.sticky=!1,h.renders.forEach((t=>t(null)))):h.sticky=!0,t.stopImmediatePropagation()))})),u.addEventListener("pointerleave",(function(t){"mouse"===t.pointerType&&(h.sticky||O(null))})),C(null)}),c)}}function io(t){return oo(1,1,t)}function ao(t){return oo(1,.01,t)}function lo(t){return oo(.01,1,t)}function so({x1:t,x2:e,x:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function co({y1:t,y2:e,y:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function uo(t){return or(t)&&void 0===t.interval?void 0:"tabular-nums"}function fo(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function ho(t,n={},r){let{columns:o,tickFormat:i,fontVariant:a=uo(t),swatchSize:l=15,swatchWidth:s=l,swatchHeight:c=l,marginLeft:u=0,className:f,style:h,width:d}=n;const p=Fe(n);f=Br(f),i=function(t,n){return void 0===t?bt(n)?pr:E:"function"==typeof t?t:("string"==typeof t?bt(n)?e.utcFormat:e.format:B)(t)}(i,t.domain);const m=qe("div",p).attr("class",`${f}-swatches ${f}-swatches-${null!=o?"columns":"wrap"}`);let y;return null!=o?(y=`.${f}-swatches-columns .${f}-swatch {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n.${f}-swatches-columns .${f}-swatch::before {\n  flex-shrink: 0;\n}\n.${f}-swatches-columns .${f}-swatch-label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,m.style("columns",o).selectAll().data(t.domain).enter().append("div").attr("class",`${f}-swatch`).call(r,t,s,c).call((t=>t.append("div").attr("class",`${f}-swatch-label`).attr("title",i).text(i)))):(y=`.${f}-swatches-wrap {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n.${f}-swatches-wrap .${f}-swatch {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,m.selectAll().data(t.domain).enter().append("span").attr("class",`${f}-swatch`).call(r,t,s,c).append((function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`.${f}-swatches {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n.${f}-swatch > svg {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${y}`))).style("margin-left",u?+u+"px":null).style("width",void 0===d?null:+d+"px").style("font-variant",Or(a,"normal")).call(Nr,h).node()}const po=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:St(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:l=4.5,...s}={},c){const[u,f]=D(n),[h,d]=D(o),p=fo(c,u),m=fo(c,h),y=l*l*Math.PI;return r=F(r)[1],i=F(i)[1],a=F(a)[1],ho(t,s,((n,o,l,s)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",l).attr("height",s).attr("fill","color"===u?t=>p.scale(t):f).attr("fill-opacity",r).attr("stroke","color"===h?t=>m.scale(t):d).attr("stroke-opacity",i).attr("stroke-width",a).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,y),r}))))}],["color",yo],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return yo({type:t,...r,interpolate:go(i)},{legend:o,...a})}]]);function mo({className:t,...e},{label:n,ticks:r,tickFormat:o}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(i,{className:t,...e},{label:n,ticks:r,tickFormat:o})}function yo(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:e,...n}={}){if(!or(t)&&!ir(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return ho(t,n,((t,n,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",n.scale).attr("fill-opacity",F(e)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:l=18,marginRight:s=0,marginBottom:c=16+o,marginLeft:u=0,style:f,ticks:h=(i-u-s)/64,tickFormat:d,fontVariant:p=uo(t),round:m=!0,opacity:y,className:g}=n;const v=Fe(n);g=Br(g),y=F(y)[1],null===d&&(d=()=>null);const x=qe("svg",v).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`.${g}-ramp {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n.${g}-ramp text {\n  white-space: pre;\n}`))).call(Nr,f);let w,b=t=>t.selectAll(".tick line").attr("y1",l+c-a);const k=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:$,domain:M,range:L,interpolate:A,scale:z,pivot:S}=t;if(A){const t=void 0===L?A:e.piecewise(1===A.length?En(A):A,L);w=k(z.copy(),e.quantize(e.interpolateNumber(u,i-s),Math.min(M.length+(void 0!==S),void 0===L?1/0:L.length)));const n=256,r=v.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);x.append("image").attr("opacity",y).attr("x",u).attr("y",l).attr("width",i-u-s).attr("height",a-l-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===$){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;w=k(e.scaleLinear().domain([-1,L.length-1]),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(L).enter().append("rect").attr("x",((t,e)=>w(e-1))).attr("y",l).attr("width",((t,e)=>w(e)-w(e-1))).attr("height",a-l-c).attr("fill",(t=>t)),h=G(t,((t,e)=>e)),d=e=>n(t[e],e)}else w=k(e.scaleBand().domain(M),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(M).enter().append("rect").attr("x",w).attr("y",l).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-l-c).attr("fill",z),b=()=>{};return x.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(w).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Or(p,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==r&&x.append("text").attr("x",u).attr("y",l-6).attr("fill","currentColor").attr("font-weight","bold").text(r),x.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function go(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}const vo=Math.PI/180;function xo(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=wo(n),t.markerMid=wo(r),t.markerEnd=wo(o)}function wo(t){if(null==t||!1===t)return null;if(!0===t)return $o;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return bo("auto");case"arrow-reverse":return bo("auto-start-reverse");case"dot":return ko;case"circle":case"circle-fill":return $o;case"circle-stroke":return Mo}throw new Error(`invalid marker: ${t}`)}function bo(t){return(e,n)=>qe("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function ko(t,e){return qe("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function $o(t,e){return qe("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function Mo(t,e){return qe("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let Lo=0;function Ao(t,e,{stroke:n},r){return So(t,e,n&&(t=>n[t]),r)}function zo(t,e,{stroke:n},r){return So(t,e,n&&(([t])=>n[t]),r)}function So(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(e){const n=i(e);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(n);if(!o){const e=this.parentNode.insertBefore(t(n,a),this),i="plot-marker-"+ ++Lo;e.setAttribute("id",i),r.set(n,o=`url(#${i})`)}return o}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}function Eo({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Oo(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function Ro({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Oo(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Oo(t,e,n){return void 0===t&&void 0===e&&void 0===n?yr?[1,0]:[.5,.5]:[e,n]}function Co(t,{interval:e}){return(t={...gt(t)}).interval=mt(void 0===t.interval?e:t.interval),t}function To(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:l,interval:s}=Co(o,n);if(null==l||null==s&&!r)return n;const c=ft(o);if(null==s){let e;const r={transform:t=>e||(e=w(t,l)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===i?r:i,[`${t}2`]:void 0===a?r:a}}let u,f;function h(t){return void 0!==f&&t===u?f:f=G(w(u=t,l),(t=>s.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function Bo(t,e,n){const{[t]:r}=n,{value:o,interval:i}=Co(r,n);return null==o||null==i?n:e({...n,[t]:{label:ft(r),transform:t=>{const e=G(w(t,o),(t=>i.floor(t))),n=e.map((t=>i.offset(t)));return e.map(bt(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function No(t={}){return To("x",Eo,t,!0)}function Po(t={}){return To("y",Ro,t,!0)}function Io(t={}){return To("x",Eo,t)}function Wo(t={}){return To("y",Ro,t)}function jo(t={}){return Bo("x",Eo,t)}function Do(t={}){return Bo("y",Ro,t)}const Fo={ariaLabel:"rule",fill:null,stroke:"currentColor"};class qo extends Jr{constructor(t,e={}){const{x:n,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},no(e,"x"),Fo),this.insetTop=R(a),this.insetBottom=R(l),xo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y1:s,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return qe("svg:g",o).call(Ar,this,r).call(Rr,this,{x:l&&i},yr,0).call((e=>e.selectAll().data(t).enter().append("line").call(zr,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!ar(a)?t=>s[t]+y:h+y).attr("y2",c&&!ar(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(kr,this,n).call(Ao,this,n,o))).node()}}class Yo extends Jr{constructor(t,e={}){const{x1:n,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=e;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},no(e,"y"),Fo),this.insetRight=R(a),this.insetLeft=R(l),xo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{y:l,x1:s,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return qe("svg:g",o).call(Ar,this,r,o).call(Rr,this,{y:l&&a},0,yr).call((e=>e.selectAll().data(t).enter().append("line").call(zr,this).attr("x1",s&&!ar(i)?t=>s[t]+y:p+y).attr("x2",c&&!ar(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(kr,this,n).call(Ao,this,n,o))).node()}}function _o(t,e){let{x:n=A,y:r,y1:o,y2:i,...a}=Wo(e);return[o,i]=Xo(r,o,i),new qo(t,{...a,x:n,y1:o,y2:i})}function Go(t,e){let{y:n=A,x:r,x1:o,x2:i,...a}=Io(e);return[o,i]=Xo(r,o,i),new Yo(t,{...a,y:n,x1:o,x2:i})}function Xo(t,e,n){if(null==t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}function Uo(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)"function"!=typeof e[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const Vo={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Ho="­";class Zo extends Jr{constructor(t,e={}){const{x:n,y:r,text:o=(vt(t)&&xt(t)?A:L),frameAnchor:a,textAnchor:l=(/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle"),lineAnchor:s=(/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle"),lineHeight:c=1,lineWidth:u=1/0,textOverflow:f,monospace:h,fontFamily:d=(h?"ui-monospace, monospace":void 0),fontSize:p,fontStyle:m,fontVariant:y,fontWeight:g,rotate:v}=e,[x,b]=F(v,0),[k,$]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),ri.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(p);var M;if(super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:k,optional:!0},rotate:{value:(M=x,null==M?null:{transform:t=>w(t,M,Float64Array),label:ft(M)}),optional:!0},text:{value:o,filter:i,optional:!0}},e,Vo),this.rotate=b,this.textAnchor=Or(l,"middle"),this.lineAnchor=Y(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=Qo(f),this.monospace=!!h,this.fontFamily=E(d),this.fontSize=$,this.fontStyle=E(m),this.fontVariant=E(y),this.fontWeight=E(g),this.frameAnchor=Ot(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=si(this),this.clipLine=ci(this)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=n,{rotate:d}=this,[p,m]=Pr(this,r);return qe("svg:g",o).call(Ar,this,r,o).call(ni,this,u,r).call(Rr,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(zr,this).call(Jo,this,u,f).attr("transform",Uo`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(Er,"font-size",h&&(t=>h[t])).call(kr,this,n))).node()}}function Qo(t){return null==t?null:Y(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function Jo(t,n,r,o){if(!r)return;const{lineAnchor:i,lineHeight:a,textOverflow:l,splitLines:s,clipLine:c}=n;t.each((function(t){const n=s(mr(r[t])??"").map(c),u=n.length,f="top"===i?.71:"bottom"===i?1-u:(164-100*u)/200;if(u>1){let t=0;for(let r=0;r<u;++r){if(++t,!n[r])continue;const o=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");o.setAttribute("x",0),r===t-1?o.setAttribute("y",(f+r)*a+"em"):o.setAttribute("dy",t*a+"em"),o.textContent=n[r],this.appendChild(o),t=0}}else f&&this.setAttribute("y",f*a+"em"),this.textContent=n[0];if(l&&!o&&n[0]!==r[t]){const n=this.ownerDocument.createElementNS(e.namespaces.svg,"title");n.textContent=r[t],this.appendChild(n)}}))}function Ko(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=et(e,n)),new Zo(t,{...r,x:e,y:n})}function ti(t,{x:e=A,...n}={}){return new Zo(t,Do({...n,x:e}))}function ei(t,{y:e=A,...n}={}){return new Zo(t,jo({...n,y:e}))}function ni(t,e,n){Er(t,"text-anchor",e.textAnchor),Er(t,"font-family",e.fontFamily),Er(t,"font-size",e.fontSize),Er(t,"font-style",e.fontStyle),Er(t,"font-variant",void 0===e.fontVariant?function(t){return t&&(Mt(t)||bt(t))?"tabular-nums":void 0}(n):e.fontVariant),Er(t,"font-weight",e.fontWeight)}const ri=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function oi(t,e,n){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case Ho:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===o&&(o=a),i>o&&n(t,o,l)>e&&(r.push(t.slice(o,i)+(t[i-1]===Ho?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}const ii={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function ai(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=yi(t,o))r+=ii[t[o]]??(vi(t,o)?120:ii.e);return r}function li(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=yi(t,o))r+=vi(t,o)?200:100;return r}function si({monospace:t,lineWidth:e,textOverflow:n}){if(null!=n||e==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?li:ai,o=100*e;return t=>oi(t,o,r)}function ci({monospace:t,lineWidth:e,textOverflow:n}){if(null==n||e==1/0)return t=>t;const r=t?li:ai,o=100*e;switch(n){case"clip-start":return t=>di(t,o,r,"");case"clip-end":return t=>hi(t,o,r,"");case"ellipsis-start":return t=>di(t,o,r,ui);case"ellipsis-middle":return t=>function(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r)/2,[a,l]=fi(t,e/2,n,i),[s]=fi(t,o-e/2-l+i,n,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(yi(t,s)).trimStart()}(t,o,r,ui);case"ellipsis-end":return t=>hi(t,o,r,ui)}}const ui="…";function fi(t,e,n,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=yi(t,a);const s=n(t,a,l);if(i+s>e){for(i+=r;i>e&&a>0;)l=a,a=o.pop(),i-=n(t,a,l);return[a,e-i]}i+=s,o.push(a)}return[-1,0]}function hi(t,e,n,r){t=t.trim();const o=n(r),[i]=fi(t,e,n,o);return i<0?t:t.slice(0,i).trimEnd()+r}function di(t,e,n,r){const o=n(t=t.trim());if(o<=e)return t;const i=n(r),[a]=fi(t,o-e+i,n,-i);return a<0?r:r+t.slice(yi(t,a)).trimStart()}const pi=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,mi=/\p{Extended_Pictographic}/uy;function yi(t,e){return e+=function(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const n=t.charCodeAt(e+1);return n>=56320&&n<57344}return!1}(t,e)?2:1,function(t,e){return!gi(t,e)&&(pi.lastIndex=e,pi.test(t))}(t,e)&&(e=pi.lastIndex),function(t,e){return 8205===t.charCodeAt(e)}(t,e)?yi(t,e+1):e}function gi(t,e){return t.charCodeAt(e)<128}function vi(t,e){return!gi(t,e)&&(mi.lastIndex=e,mi.test(t))}const xi={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},wi=3.5,bi=5*wi,ki={draw(t,e,n){const r=e*n/bi;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},$i={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},Mi=new Map([["arrow",ki],["spike",$i]]);class Li extends Jr{constructor(t,e={}){const{x:n,y:r,r:o=wi,length:i,rotate:a,shape:l=ki,anchor:s="middle",frameAnchor:c}=e,[u,f]=F(i,12),[h,d]=F(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},e,xi),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const e=Mi.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=Y(s,"anchor",["start","middle","end"]),this.frameAnchor=Ot(c)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:y}=this,[g,v]=Pr(this,o);return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,{x:s&&a,y:c&&l}).call((n=>n.selectAll().data(t).enter().append("path").call(zr,this).attr("transform",Uo`translate(${s?t=>s[t]:g},${c?t=>c[t]:v})${f?t=>` rotate(${f[t]})`:d?` rotate(${d})`:""}${"start"===p?"":"end"===p?u?t=>` translate(0,${u[t]})`:` translate(0,${h})`:u?t=>` translate(0,${u[t]/2})`:` translate(0,${h/2})`}`).attr("d",u?t=>{const n=e.pathRound();return m.draw(n,u[t],y),n}:(()=>{const t=e.pathRound();return m.draw(t,h,y),t})()).call(kr,this,r))).node()}}function Ai(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=et(n,r)),new Li(t,{...o,x:n,y:r})}function zi(t,e={}){const{x:n=A,...r}=e;return new Li(t,{...r,x:n})}function Si(t,e={}){const{y:n=A,...r}=e;return new Li(t,{...r,y:n})}function Ei(t,e){return arguments.length<2&&!vt(t)&&(e=t,t=null),void 0===e&&(e={}),[t,e]}function Ri({anchor:t}={},e){return void 0===t?e[0]:Y(t,"anchor",e)}function Oi(t){return Ri(t,["left","right"])}function Ci(t){return Ri(t,["right","left"])}function Ti(t){return Ri(t,["bottom","top"])}function Bi(t){return Ri(t,["top","bottom"])}function Ni(){const[t,e]=Ei(...arguments);return ji("y",Oi(e),t,e)}function Pi(){const[t,e]=Ei(...arguments);return ji("fy",Ci(e),t,e)}function Ii(){const[t,e]=Ei(...arguments);return Di("x",Ti(e),t,e)}function Wi(){const[t,e]=Ei(...arguments);return Di("fx",Bi(e),t,e)}function ji(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,margin:v,marginTop:x=(void 0===v?20:v),marginRight:w=(void 0===v?"right"===e?40:0:v),marginBottom:b=(void 0===v?20:v),marginLeft:k=(void 0===v?"left"===e?40:0:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...z}){return p=R(p),m=R(m),y=R(y),void 0!==M&&(M=Y(M,"labelAnchor",["center","top","bottom"])),L=oa(L),Kr(p&&!St(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("y"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return Hi(Si,t,`${t}-axis tick`,n,{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===e?+h-yr+ +u:+h+yr-f,anchor:"start",length:s,shape:"left"===e?ta:ea})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...z}):null,St(s)?null:function(t,e,n,{facetAnchor:r=e+("y"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*vo):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>60?"middle":"left"===e?"end":"start"),lineAnchor:f=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:h,inset:d=0,insetLeft:p=d,insetRight:m=d,dx:y=0,y:g=("y"===t?void 0:null),...v}){return Hi(ei,t,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,y:g,...v,dx:"left"===e?+y-i-l+ +p:+y+ +i+ +l-m},(function(t,e,n){void 0===h&&(this.fontVariant=na(t)),void 0===c&&(n.text=Zi(t,e,s))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...z}),St(s)||null===$?null:Ko([],Vi({fill:s,fillOpacity:c,...z},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=A??("right"===e?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===e?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor="right"===e?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${e}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===e?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[ra(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function Di(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,margin:v,marginTop:x=(void 0===v?"top"===e?30:0:v),marginRight:w=(void 0===v?20:v),marginBottom:b=(void 0===v?"bottom"===e?30:0:v),marginLeft:k=(void 0===v?20:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...z}){return p=R(p),m=R(m),y=R(y),void 0!==M&&(M=Y(M,"labelAnchor",["center","left","right"])),L=oa(L),Kr(p&&!St(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("x"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return Hi(zi,t,`${t}-axis tick`,n,{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===e?+h-yr-f:+h+yr+ +u,anchor:"start",length:s,shape:"bottom"===e?Ji:Ki})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...z}):null,St(s)?null:function(t,e,n,{facetAnchor:r=e+("x"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*vo):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>=10?a<0^"bottom"===e?"start":"end":"middle"),lineAnchor:f=(Math.abs(a)>=10?"middle":"bottom"===e?"top":"bottom"),fontVariant:h,inset:d=0,insetTop:p=d,insetBottom:m=d,dy:y=0,x:g=("x"===t?void 0:null),...v}){return Hi(ti,t,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,x:g,...v,dy:"bottom"===e?+y+ +i+ +l-m:+y-i-l+ +p},(function(t,e,n){void 0===h&&(this.fontVariant=na(t)),void 0===c&&(n.text=Zi(t,e,s))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...z}),St(s)||null===$?null:Ko([],Vi({fill:s,fillOpacity:c,...z},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=M??(l.bandwidth?"center":"right"),d=A??("top"===e?s:u)-3;return"center"===h?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=e,this.dy="top"===e?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[ra(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function Fi(){const[t,e]=Ei(...arguments);return Gi("y",Oi(e),t,e)}function qi(){const[t,e]=Ei(...arguments);return Gi("fy",Ci(e),t,e)}function Yi(){const[t,e]=Ei(...arguments);return Xi("x",Ti(e),t,e)}function _i(){const[t,e]=Ei(...arguments);return Xi("fx",Bi(e),t,e)}function Gi(t,e,n,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===e?o:null),x2:a=("right"===e?o:null),...l}){return Hi(Go,t,`${t}-grid`,n,{y:r,x1:i,x2:a,...Ui(l)})}function Xi(t,e,n,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===e?o:null),y2:a=("bottom"===e?o:null),...l}){return Hi(_o,t,`${t}-grid`,n,{x:r,y1:i,y2:a,...Ui(l)})}function Ui({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:o=1,...i}){return{stroke:n,strokeOpacity:r,strokeWidth:o,...i}}function Vi({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontWeight:i,monospace:a,pointerEvents:l,shapeRendering:s},c){return[,t]=D(t),[,e]=F(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontWeight:i,monospace:a,pointerEvents:l,shapeRendering:s,initializer:c}}function Hi(t,n,r,o,i,a){let l;const s=t(o,Ht(i,(function(t,r,o,s,c,u){const f=null==t&&("fx"===n||"fy"===n),{[n]:h}=s;if(!h)throw new Error(`missing scale: ${n}`);let{ticks:d,tickSpacing:p,interval:m}=i;if(rr(h)&&"string"==typeof d&&(m=d,d=void 0),null==t){if(vt(d))t=_(d);else if(h.ticks)if(void 0!==d)t=h.ticks(d);else if(m=yt(void 0===m?h.interval:m,h.type),void 0!==m){const[n,r]=e.extent(h.domain());t=m.range(n,m.offset(m.floor(r)))}else{const[r,o]=e.extent(h.range());d=(o-r)/(void 0===p?"x"===n?80:35:p),t=h.ticks(d)}else t=h.domain();"y"===n||"x"===n?r=[rt(t)]:l[n]={scale:n,value:A}}a?.call(this,h,d,l);const y=Object.fromEntries(Object.entries(l).map((([e,n])=>[e,{...n,value:w(t,n.value)}])));return f&&(r=u.filterFacets(t,y)),{data:t,facets:r,channels:y}})));return null==o?(l=s.channels,s.channels={}):l={},s.ariaLabel=r,s}function Zi(t,e,n){return{value:Qi(t,e,n)}}function Qi(t,n,r){return t.tickFormat?t.tickFormat(vt(n)?null:n,r):void 0===r?function(t){if(!t)return!1;const n=t.floor(new Date(Date.UTC(2e3,11,31)));return e.utcYear(n)>=n}(t.interval)?e.utcFormat("%Y"):function(t){if(!t)return!1;const n=t.floor(new Date(2e3,11,31));return e.timeYear(n)>=n}(t.interval)?e.timeFormat("%Y"):mr:"string"==typeof r?(bt(t.domain())?e.utcFormat:e.format)(r):B(r)}const Ji={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},Ki={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},ta={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},ea={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function na(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function ra(t,e,{anchor:n,label:r=e.label,labelAnchor:o,labelArrow:i}={}){if(!(null==r||r.inferred&&function(t){return rr(t)||null!=t.interval}(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),"auto"===i&&(i=(!e.bandwidth||e.interval)&&!/[↑↓→←]/.test(r)),!i)return r;if(!0===i){const n=function(t){return Math.sign(Ct(t.domain()))*Math.sign(Ct(t.range()))}(e);n&&(i=/x$/.test(t)||"center"===o?/x$/.test(t)===n<0?"left":"right":n<0?"up":"down")}switch(i){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return"right"===n?`${r} ↑`:`↑ ${r}`;case"down":return"right"===n?`${r} ↓`:`↓ ${r}`}return r}}function oa(t="auto"){return!St(t)&&("boolean"==typeof t?t:Y(t,"labelArrow",["auto","up","right","down","left"]))}const ia={ariaLabel:"frame",fill:"none",stroke:"currentColor"},aa={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"};class la extends Jr{constructor(t={}){const{anchor:e=null,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,rx:l,ry:s}=t;super($,void 0,t,null==e?ia:aa),this.anchor=q(e,"anchor",["top","right","bottom","left"]),this.insetTop=R(r),this.insetRight=R(o),this.insetBottom=R(i),this.insetLeft=R(a),this.rx=R(l),this.ry=R(s)}render(t,e,n,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return qe(f?"svg:line":"svg:rect",o).datum(0).call(Ar,this,r,o).call(zr,this).call(kr,this,n).call(Rr,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function sa(t){return new la(t)}const ca={ariaLabel:"tip",fill:"white",stroke:"currentColor"},ua=new Set(["geometry","href","src","ariaLabel"]);class fa extends Jr{constructor(t,e={}){e.tip&&(e={...e,tip:!1}),void 0===e.title&&vt(t)&&xt(t)&&(e={...e,title:A});const{x:n,y:r,x1:o,x2:i,y1:a,y2:l,anchor:s,monospace:c,fontFamily:u=(c?"ui-monospace, monospace":void 0),fontSize:f,fontStyle:h,fontVariant:d,fontWeight:p,lineHeight:m=1,lineWidth:y=20,frameAnchor:g,textAnchor:v="start",textOverflow:x,textPadding:w=8,pointerSize:b=12,pathFilter:k="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=e;super(t,{x:{value:null!=o&&null!=i?null:n,scale:"x",optional:!0},y:{value:null!=a&&null!=l?null:r,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:null==i},y1:{value:a,scale:"y",optional:null==l},x2:{value:i,scale:"x",optional:null==o},y2:{value:l,scale:"y",optional:null==a}},e,ca),this.anchor=Rt(s,"anchor"),this.previousAnchor=this.anchor??"top-left",this.frameAnchor=Ot(g),this.textAnchor=Or(v,"middle"),this.textPadding=+w,this.pointerSize=+b,this.pathFilter=E(k),this.lineHeight=+m,this.lineWidth=+y,this.textOverflow=Qo(x),this.monospace=!!c,this.fontFamily=E(u),this.fontSize=R(f),this.fontStyle=E(h),this.fontVariant=E(d),this.fontWeight=E(p);for(const t in ca)t in this.channels&&(this[t]=ca[t]);this.splitLines=si(this),this.clipLine=ci(this)}render(t,r,o,i,a){const l=this,{x:s,y:c,fx:u,fy:f}=r,{ownerSVGElement:h,document:d}=a,{anchor:p,monospace:m,lineHeight:y,lineWidth:g}=this,{textPadding:v,pointerSize:x,pathFilter:w}=this,{marginTop:b,marginLeft:k}=i,$=function({channels:t}){const e={};for(const n in t){if(ua.has(n))continue;const r=De(t,n);r&&(e[n]=r)}return e}(o),{x1:M,y1:L,x2:A,y2:z,x:S=M??A,y:E=L??z}=o,R=u?u(t.fx)-k:0,O=f?f(t.fy)-b:0,[C,T]=Pr(this,i),B=so(o,C),N=co(o,T),P=m?li:ai,I=P(ui),W=u&&Qi(u),j=f&&Qi(f);const D=qe("svg:g",a).call(Ar,this,i,a).call(ni,this).call(Rr,this,{x:S&&s,y:E&&c}).call((i=>i.selectAll().data(t).enter().append("g").attr("transform",(t=>`translate(${Math.round(B(t))},${Math.round(N(t))})`)).call(zr,this).call((t=>t.append("path").attr("filter",w))).call((i=>i.append("text").each((function(i){const a=e.select(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const s=new Set;for(const e of function*(e,i){if("title"in e){const t=e.title.value[i];for(const e of l.splitLines(mr(t)))yield{name:"",value:l.clipLine(e)}}else{for(const t in e){if("x1"===t&&"x2"in e)continue;if("y1"===t&&"y2"in e)continue;const a=e[t],l=a.value[i];if(n(l)||null!=a.scale)if("x2"===t&&"x1"in e)yield{name:pa(r,a,"x"),value:da(e.x1,a,i)};else if("y2"===t&&"y1"in e)yield{name:pa(r,a,"y"),value:da(e.y1,a,i)};else{const e=a.scale,n={name:pa(r,a,t),value:mr(l)};"color"!==e&&"opacity"!==e||(n[e]=o[t][i]),yield n}}null!=t.fi&&u&&(yield{name:String(u.label??"fx"),value:W(t.fx)}),null!=t.fi&&f&&(yield{name:String(f.label??"fy"),value:j(t.fy)})}}($,i)){const t=e.name;t&&s.has(t)||(s.add(t),F(a,e))}}))))));function F(t,{name:e,value:n,color:r,opacity:o}){const i=null!=r||null!=o;let a,l=100*g;const[s]=fi(e,l,P,I);if(s>=0)e=e.slice(0,s).trimEnd()+ui,a=n.trim(),n="";else{(e||!n&&!i)&&(n=" "+n);const[t]=fi(n,l-P(e),P,I);t>=0&&(a=(n=n.slice(0,t).trimEnd()+ui).trim())}const c=t.append("tspan").attr("x",0).attr("dy",`${y}em`).text("​");e&&c.append("tspan").attr("font-weight","bold").text(e),n&&c.append((()=>d.createTextNode(n))),i&&c.append("tspan").text(" ■").attr("fill",r).attr("fill-opacity",o).style("user-select","none"),a&&c.append("title").text(a)}function q(){const{width:t,height:e}=i.facet??i;D.selectChildren().each((function(n){let{x:r,width:o,height:i}=this.getBBox();o=Math.round(o),i=Math.round(i);let a=p;if(void 0===a){a=l.previousAnchor;const r=B(n)+R,s=N(n)+O,c=r+o+2*v<t,u=r-o-2*v>0,f=s+i+x+2*v+7<e,h=s-i-x-2*v>0,d=(/-left$/.test(a)?c||!u:c&&!u)?"left":"right",p=(/^top-/.test(a)?f||!h:f&&!h)?"top":"bottom";a=l.previousAnchor=`${p}-${d}`}const s=this.firstChild,c=this.lastChild;if(s.setAttribute("d",function(t,e,n,r,o){const i=r+2*n,a=o+2*n;switch(t){case"middle":return`M${-i/2},${-a/2}h${i}v${a}h${-i}z`;case"top-left":return`M0,0l${e},${e}h${i-e}v${a}h${-i}z`;case"top":return`M0,0l${e/2},${e/2}h${(i-e)/2}v${a}h${-i}v${-a}h${(i-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-i}v${a}h${i}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-i}v${a}h${i}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${i-e}v${-a}h${-i}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(i-e)/2}v${-a}h${-i}v${a}h${(i-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-i}v${-a}h${i}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${i}v${a}h${-i}v${e/2-a/2}z`}}(a,x,v,o,i)),r)for(const t of c.childNodes)t.setAttribute("x",-r);c.setAttribute("y",+function(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}(a,c.childNodes.length,y).toFixed(6)+"em"),c.setAttribute("transform",`translate(${function(t,e,n,r,o){switch(t){case"middle":return[-r/2,o/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,o/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,o/2]}}(a,x,v,o,i)})`)}))}return h.isConnected?Promise.resolve().then(q):"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(q),D.node()}}function ha(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=et(e,n)),new fa(t,{...r,x:e,y:n})}function da(t,e,n){return e.hint?.length?`${mr(e.value[n]-t.value[n])}`:`${mr(t.value[n])}–${mr(e.value[n])}`}function pa(t,e,n){return String(t[e.scale]?.label??e?.label??n)}function ma(t={}){const{facet:n,style:r,caption:o,ariaLabel:i,ariaDescription:a}=t,l=Br(t.className),s=void 0===t.marks?[]:ya(t.marks);s.push(...function(t){const e=[];for(const n of t){const t=n.tip;if(t){const r="x"===t?ao:"y"===t?lo:io;e.push(ha(n.data,r(Ma(n))))}}return e}(s));const c=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const o=_(t.data);if(null==o)throw new Error("missing facet data");const i={};null!=n&&(i.fx=Ee(o,{value:n,scale:"fx"}));null!=r&&(i.fy=Ee(o,{value:r,scale:"fy"}));xa(i,e);const a=jr(o,i);return{channels:i,groups:a,data:t.data}}(n,t),u=new Map;for(const e of s){const n=$a(e,c,t);n&&u.set(e,n)}const f=new Map;c&&ka(f,[c]),ka(f,u);const h=ya(function(t,e,n){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=n;(r||!Q(o)&&!Ea("x",t))&&(d=p=null);(r||!Q(i)&&!Ea("y",t))&&(m=y=null);e.has("fx")||(g=v=null);e.has("fy")||(x=w=null);void 0===d&&(d=!Sa(t,"x"));void 0===m&&(m=!Sa(t,"y"));void 0===g&&(g=!Sa(t,"fx"));void 0===x&&(x=!Sa(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return Aa(b,w,qi,l),La(b,x,Pi,"right","left",u,l),Aa(b,v,_i,a),La(b,g,Wi,"top","bottom",u,a),Aa(b,y,Fi,i),La(b,m,Ni,"left","right",n,i),Aa(b,p,Yi,o),La(b,d,Ii,"bottom","top",n,o),b}(s,f,t));for(const e of h){const n=$a(e,c,t);n&&u.set(e,n)}s.unshift(...h);let d=function(t,n){const{fx:r,fy:o}=Yn(t,n),i=r?.scale.domain(),a=o?.scale.domain();return i&&a?e.cross(i,a).map((([t,e],n)=>({x:t,y:e,i:n}))):i?i.map(((t,e)=>({x:t,i:e}))):a?a.map(((t,e)=>({y:t,i:e}))):void 0}(f,t);if(void 0!==d){const t=c?Qr(d,c):void 0;for(const e of s){if(null===e.facet||"super"===e.facet)continue;const n=u.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?Qr(d,n):t)}const e=new Set;for(const{facetsIndex:t}of u.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));d.forEach(0<e.size&&e.size<d.length?(t,n)=>t.empty=!e.has(n):t=>t.empty=!1);for(const t of s)if("exclude"===t.facet){const e=u.get(t);void 0!==e&&(e.facetsIndex=Dr(e.facetsIndex))}}for(const e of Dt.keys())Q(t[e])&&"fx"!==e&&"fy"!==e&&f.set(e,[]);const p=new Map;for(const e of s){if(p.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=u.get(e)??{},{data:o,facets:i,channels:a}=e.initialize(n,r,t);xa(a,t),p.set(e,{data:o,facets:i,channels:a})}const m=Yn(ka(f,p),t),y=_n(m),g=function(t,e,n={}){let r=.5-yr,o=.5+yr,i=.5+yr,a=.5-yr;for(const{marginTop:t,marginRight:n,marginBottom:l,marginLeft:s}of e)t>r&&(r=t),n>o&&(o=n),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=n;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=Ir(t,e,n,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:e=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=n.facet??{};e=+e,r=+r,o=+o,i=+i,p.facet={marginTop:e,marginRight:r,marginBottom:o,marginLeft:i}}return p}(m,s,t);!function(t,e){const{x:n,y:r,fx:o,fy:i}=t,a=o||i?Xn(e):e;o&&Vn(o,a),i&&Hn(i,a);const l=o||i?Un(t,e):e;n&&Vn(n,l),r&&Hn(r,l)}(m,g);const{fx:v,fy:x}=y,w=v||x?Un(m,g):g,b=v||x?function({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Xn(n),c=t&&Ra(t),u=e&&Ra(e);return{marginTop:e?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:e?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}(y,g):g,k=Fe(t),$=k.document,M=e.creator("svg").call($.documentElement);let L=M;k.ownerSVGElement=M,k.className=l,k.projection=Ve(t,w),k.filterFacets=(t,e)=>Qr(d,{channels:e,groups:jr(t,e)}),k.getMarkState=t=>{const e=p.get(t),n=u.get(t);return{...e,channels:{...e.channels,...n?.channels}}},k.dispatchValue=t=>{L.value!==t&&(L.value=t,L.dispatchEvent(new Event("input",{bubbles:!0})))};const A=new Set;for(const[e,n]of p)if(null!=e.initializer){const r="super"===e.facet?b:w,o=e.initializer(n.data,n.facets,n.channels,y,r,k);if(void 0!==o.data&&(n.data=o.data),void 0!==o.facets&&(n.facets=o.facets),void 0!==o.channels){const{fx:r,fy:i,...a}=o.channels;ba(a),Object.assign(n.channels,a);for(const e of Object.values(a)){const{scale:n}=e;null!=n&&Dt.get(n)!==Bt&&(wa(e,t),A.add(n))}null==r&&null==i||u.set(e,!0)}}if(A.size){const e=new Map;ka(e,p,(t=>A.has(t))),ka(f,p,(t=>A.has(t)));const n=function(t,e){for(const n in t){const r=t[n],o=e[n];void 0===r.label&&o&&(r.label=o.label)}return t}(Yn(e,t),m),r=_n(n);Object.assign(m,n),Object.assign(y,r)}let z,S;void 0!==d&&(z={x:v?.domain(),y:x?.domain()},d=function(t,{x:e,y:n}){return e&&=Yr(e),n&&=Yr(n),t.filter(e&&n?t=>e.has(t.x)&&n.has(t.y):e?t=>e.has(t.x):t=>n.has(t.y)).sort(e&&n?(t,r)=>e.get(t.x)-e.get(r.x)||n.get(t.y)-n.get(r.y):e?(t,n)=>e.get(t.x)-e.get(n.x):(t,e)=>n.get(t.y)-n.get(e.y))}(d,z),S=function(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:o,y:i})=>`translate(${t(o)-r},${e(i)-n})`:t?({x:e})=>`translate(${t(e)-r},0)`:({y:t})=>`translate(0,${e(t)-n})`}(v,x,g));for(const[t,e]of p)e.values=t.scale(e.channels,y,k);const{width:E,height:R}=g;e.select(M).attr("class",l).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",E).attr("height",R).attr("viewBox",`0 0 ${E} ${R}`).attr("aria-label",i).attr("aria-description",a).call((t=>t.append("style").text(`.${l} {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n}\n.${l} text,\n.${l} tspan {\n  white-space: pre;\n}`))).call(Nr,r);for(const t of s){const{channels:n,values:r,facets:o}=p.get(t);if(void 0===d||"super"===t.facet){let e=null;if(o&&(e=o[0],e=t.filter(e,n,r),0===e.length))continue;const i=t.render(e,y,r,b,k);if(null==i)continue;M.appendChild(i)}else{let i;for(const a of d){if(!(t.facetAnchor?.(d,z,a)??!a.empty))continue;let l=null;if(o){const e=u.has(t);if(l=o[e?a.i:0],l=t.filter(l,n,r),0===l.length)continue;e&&(l.fx=a.x,l.fy=a.y,l.fi=a.i)}const s=t.render(l,y,r,w,k);if(null!=s){(i??=e.select(M).append("g")).append((()=>s)).datum(a);for(const t of["aria-label","aria-description","aria-hidden","transform"])s.hasAttribute(t)&&(i.attr(t,s.getAttribute(t)),s.removeAttribute(t))}}i?.selectChildren().attr("transform",S)}}const O=function(t,e,n){const r=[];for(const[o,i]of po){const a=n[o];if(a?.legend&&o in t){const n=i(t[o],mo(e,t[o],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(m,k,t);if(null!=o||O.length>0){L=$.createElement("figure"),L.style.maxWidth="initial";for(const t of O)L.appendChild(t);if(L.appendChild(M),null!=o){const t=$.createElement("figcaption");t.appendChild(o?.ownerDocument?o:$.createTextNode(o)),L.appendChild(t)}}L.scale=function(t){return e=>{if(!Dt.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?cr(t[e]):void 0}}(m),L.legend=function(t,e,n={}){return(r,o)=>{if(!po.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return po.get(r)(t[r],mo(e,n[r],o),(e=>t[e]))}}(m,k,t);const C=function(){const t=Ye;return Ye=0,t}();return C>0&&e.select(M).append("text").attr("x",E).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${C.toLocaleString("en-US")} warning${1===C?"":"s"}. Please check the console.`),L}function ya(t){return t.flat(1/0).filter((t=>null!=t)).map(ga)}function ga(t){return"function"==typeof t.render?t:new va(t)}Jr.prototype.plot=function({marks:t=[],...e}={}){return ma({...e,marks:[...t,this]})};class va extends Jr{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function xa(t,e){for(const n in t)wa(t[n],e);return t}function wa(t,e){const{scale:n}=t;if(null==n)return;const{type:r,percent:o,interval:i,transform:a=(o?t=>100*t:pt(i,r))}=e[n]??{};null!=a&&(t.value=G(t.value,a))}function ba(t){for(const e in t)Ce(e,t[e])}function ka(t,e,n=S){for(const{channels:r}of e.values())for(const e in r){const o=r[e],{scale:i}=o;if(null!=i&&n(i)){const e=t.get(i);void 0!==e?e.push(o):t.set(i,[o])}}return t}function $a(t,e,n){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const e=_(t.data??r??o);if(void 0===e)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===e)return;const i={};return null!=r&&(i.fx=Ee(e,{value:r,scale:"fx"})),null!=o&&(i.fy=Ee(e,{value:o,scale:"fy"})),xa(i,n),{channels:i,groups:jr(e,i)}}if(void 0===e)return;const{channels:i,groups:a,data:l}=e;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&_(t.data)?.length===l.length&&_e(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function Ma(t,e={}){return Ht({...e,x:null,y:null},((e,n,r,o,i,a)=>a.getMarkState(t)))}function La(t,e,n,r,o,i,a){if(!e)return;const l=/^\s*both\s*$/i.test(e);a=function(t,e,{line:n=e.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=e.label,labelAnchor:d,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:m}}(l?r:e,i,a);const{line:s}=a;n!==Ni&&n!==Ii||!s||Et(s)||t.push(sa(function(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:!0===n?void 0:n}}(a))),t.push(n(a)),l&&t.push(n({...a,anchor:o,label:null}))}function Aa(t,e,n,r){e&&!Et(e)&&t.push(n(function(t,{stroke:e=(At(t)?t:void 0),ticks:n=(za(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(e,r)))}function za(t){switch(typeof t){case"number":return!0;case"string":return!At(t)}return vt(t)||"function"==typeof t?.range}function Sa(t,e){const n=`${e}-axis `;return t.some((t=>t.ariaLabel?.startsWith(n)))}function Ea(t,e){for(const n of e)for(const e in n.channels)if(n.channels[e].scale===t)return!0;return!1}function Ra(t){const e=t.domain();let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const Oa=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function Ca(t=e.curveLinear,n){if("function"==typeof t)return t;const r=Oa.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function Ta(t=Ba,e){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?Ba:Ca(t,e)}function Ba(t){return e.curveLinear(t)}function Na(t={y:"count"},e={}){[t,e]=qa(t,e);const{x:n,y:r}=e;return Fa(Ya(n,e,A),null,null,r,t,Eo(e))}function Pa(t={x:"count"},e={}){[t,e]=qa(t,e);const{x:n,y:r}=e;return Fa(null,Ya(r,e,A),n,null,t,Ro(e))}function Ia(t={fill:"count"},e={}){[t,e]=qa(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=Ya(e,t),n=Ya(n,t),[e.value,n.value]=et(e.value,n.value),{x:e,y:n}}(e);return Fa(n,r,null,null,t,Eo(Ro(e)))}function Wa(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?ke:n.reduce,filter:null},n)}function ja(t={}){return Wa(Na,"y",no(t,"x"))}function Da(t={}){return Wa(Pa,"x",no(t,"y"))}function Fa(t,e,n,r,{data:o=be,filter:i=Le,sort:a,reverse:l,...s}={},c={}){t=_a(t),e=_a(e),s=function(t,e){return fe(t,e,Xa)}(s,c),o=Va(o,A),a=null==a?void 0:Xa("sort",a,c),i=null==i?void 0:Ua("filter",i,c),null!=n&&ue(s,"x","x1","x2")&&(n=null),null!=r&&ue(s,"y","y1","y2")&&(r=null);const[u,f]=ut(t),[h,d]=ut(t),[p,m]=ut(e),[y,g]=ut(e),[v,x]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[b,k]=ut(v),{x:$,y:M,z:L,fill:z,stroke:S,x1:E,x2:R,y1:O,y2:C,domain:T,cumulative:B,thresholds:N,interval:P,...I}=c,[W,j]=ut(L),[F]=D(z),[q]=D(S),[Y,_]=ut(F),[G,X]=ut(q);return{..."z"in c&&{z:W||L},..."fill"in c&&{fill:Y||z},..."stroke"in c&&{stroke:G||S},...Vt(I,((n,r,c)=>{const u=dt(w(n,v),c?.[x]),h=w(n,L),p=w(n,F),y=w(n,q),b=ge(s,{z:h,fill:p,stroke:y}),$=[],M=[],A=u&&k([]),z=h&&j([]),S=p&&_([]),E=y&&X([]),R=t&&f([]),O=t&&d([]),C=e&&m([]),T=e&&g([]),B=(N=t?.(n),P=e?.(n),N&&P?function*(t){const e=N.bin(t);for(const[t,[n,r]]of N.entries()){const o=P.bin(e[t]);for(const[t,[e,i]]of P.entries())yield[o[t],{x1:n,y1:e,x2:r,y2:i}]}}:N?function*(t){const e=N.bin(t);for(const[t,[n,r]]of N.entries())yield[e[t],{x1:n,x2:r}]}:function*(t){const e=P.bin(t);for(const[t,[n,r]]of P.entries())yield[e[t],{y1:n,y2:r}]});var N,P;let I=0;for(const t of s)t.initialize(n);a&&a.initialize(n),i&&i.initialize(n);for(const t of r){const e=[];for(const e of s)e.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of pe(t,b))for(const[t,c]of pe(l,u))for(const[l,f]of B(c))if(!i||i.reduce(l,f)){e.push(I++),M.push(o.reduceIndex(l,n,f)),u&&A.push(t),h&&z.push(b===h?r:h[l[0]]),p&&S.push(b===p?r:p[l[0]]),y&&E.push(b===y?r:y[l[0]]),R&&(R.push(f.x1),O.push(f.x2)),C&&(C.push(f.y1),T.push(f.y2));for(const t of s)t.reduce(l,f);a&&a.reduce(l)}$.push(e)}return ve($,a,l),{data:M,facets:$}})),...!ue(s,"x")&&(u?{x1:u,x2:h,x:ht(u,h)}:{x:$,x1:E,x2:R}),...!ue(s,"y")&&(p?{y1:p,y2:y,y:ht(p,y)}:{y:M,y1:O,y2:C}),...b&&{[x]:b},...Object.fromEntries(s.map((({name:t,output:e})=>[t,e])))}}function qa({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function Ya(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return void 0===(t={...gt(t)}).domain&&(t.domain=n),void 0===t.cumulative&&(t.cumulative=e),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=Ga(t.thresholds,t.interval),t}function _a(t){if(null==t)return;const{value:n,cumulative:r,domain:o=e.extent,thresholds:i}=t,a=t=>{let a,l=w(t,n);if(bt(l)||(function(t){return Qa(t)&&"function"==typeof t&&t()instanceof Date}(s=i)||vt(s)&&bt(s))){l=G(l,j,Float64Array);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||Qa(i)?i:i(l,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),Qa(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n))),a=r}else{l=P(l);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||Qa(i)?i:i(l,t,n);if("number"==typeof r)if(o===e.extent){let o=e.tickIncrement(t,n,r);if(isFinite(o))if(o>0){let e=Math.round(t/o),i=Math.round(n/o);e*o<=t||--e,i*o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)*o}else if(o<0){o=-o;let e=Math.round(t*o),i=Math.round(n*o);e/o<=t||--e,i/o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)/o}else r=[t];else r=[t]}else r=e.ticks(t,n,r);else Qa(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n)));a=r}var s;const c=[];if(1===a.length)c.push([a[0],a[0]]);else for(let t=1;t<a.length;++t)c.push([a[t-1],a[t]]);return c.bin=(r<0?tl:r>0?Ka:Ja)(c,a,l),c};return a.label=ft(n),a}function Ga(t,n,r=Za){if(void 0===t)return void 0===n?r:yt(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return Za}return g(t)}return t}function Xa(t,e,n){return he(t,e,n,Ua)}function Ua(t,e,n){return de(t,e,n,Va)}function Va(t,e){return me(t,e,Ha)}function Ha(t){switch(`${t}`.toLowerCase()){case"x":return nl;case"x1":return ol;case"x2":return il;case"y":return rl;case"y1":return al;case"y2":return ll}throw new Error(`invalid bin reduce: ${t}`)}function Za(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function Qa(t){return"function"==typeof t?.range}function Ja(t,n,r){return n=P(n),o=>{const i=t.map((()=>[]));for(const t of o)i[e.bisect(n,r[t])-1]?.push(t);return i}}function Ka(t,e,n){const r=Ja(t,e,n);return t=>{const e=r(t);for(let t=1,n=e.length;t<n;++t){const n=e[t-1],r=e[t];for(const t of n)r.push(t)}return e}}function tl(t,e,n){const r=Ja(t,e,n);return t=>{const e=r(t);for(let t=e.length-2;t>=0;--t){const n=e[t+1],r=e[t];for(const t of n)r.push(t)}return e}}function el(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const nl={reduceIndex:(t,e,{x1:n,x2:r})=>el(n,r)},rl={reduceIndex:(t,e,{y1:n,y2:r})=>el(n,r)},ol={reduceIndex:(t,e,{x1:n})=>n},il={reduceIndex:(t,e,{x2:n})=>n},al={reduceIndex:(t,e,{y1:n})=>n},ll={reduceIndex:(t,e,{y2:n})=>n};function sl(t={}){return U(t)?t:{...t,x:A}}function cl(t={}){return V(t)?t:{...t,y:A}}function ul(t={},e={}){1===arguments.length&&([t,e]=pl(t));const{y1:n,y:r=n,x:o,...i}=e,[a,l,s,c]=yl(r,o,"y","x",t,i);return{...a,y1:n,y:l,x1:s,x2:c,x:ht(s,c)}}function fl(t={},e={}){1===arguments.length&&([t,e]=pl(t));const{x1:n,x:r=n,y:o,...i}=e,[a,l,s,c]=yl(r,o,"x","y",t,i);return{...a,x1:n,x:l,y1:s,y2:c,y:ht(s,c)}}function hl({x:t,x1:e,x2:n,...r}={}){return r=no(r,"y"),void 0===e&&void 0===n?ul({x:t,...r}):([e,n]=tt(t,e,n),{...r,x1:e,x2:n})}function dl({y:t,y1:e,y2:n,...r}={}){return r=no(r,"x"),void 0===e&&void 0===n?fl({y:t,...r}):([e,n]=tt(t,e,n),{...r,y1:e,y2:n})}function pl(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const ml={length:!0};function yl(t,n=z,r,o,{offset:i,order:a,reverse:l},s){const c=nt(s),[u,f]=ut(t),[h,d]=ct(n),[p,m]=ct(n);return h.hint=p.hint=ml,i=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return vl;case"center":case"silhouette":return xl;case"wiggle":return wl}throw new Error(`unknown offset: ${t}`)}(i),a=function(t,e,n){if(void 0===t&&e===wl)return zl;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return $l;case"z":return Ml;case"sum":return Ll;case"appearance":return Al;case"inside-out":return zl}return Sl(M(t))}if("function"==typeof t)return Sl(t);if(Array.isArray(t))return r=t,(t,e,n,o)=>El(o,r);var r;throw new Error(`invalid order: ${t}`)}(a,i,o),[Vt(s,((o,s,u)=>{const h=null==t?void 0:f(dt(w(o,t),u?.[r])),p=w(o,n,Float64Array),y=w(o,c),g=a&&a(o,h,p,y),v=o.length,x=d(new Float64Array(v)),b=m(new Float64Array(v)),k=[];for(const t of s){const n=h?Array.from(e.group(t,(t=>h[t])).values()):[t];g&&Rl(n,g);for(const t of n){let e=0,n=0;l&&t.reverse();for(const r of t){const t=p[r];t<0?e=b[r]=(x[r]=e)+t:t>0?n=b[r]=(x[r]=n)+t:b[r]=x[r]=n}}k.push(n)}return i&&i(k,x,b,y),{data:o,facets:s}})),u,h,p]}function gl(t,e){let n=0,r=0;for(const o of t){const t=e[o];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function vl(t,e,n){for(const r of t)for(const t of r){const[r,o]=gl(t,n);for(const i of t){const t=1/(o-r||1);e[i]=t*(e[i]-r),n[i]=t*(n[i]-r)}}}function xl(t,e,n){for(const r of t){for(const t of r){const[r,o]=gl(t,n);for(const i of t){const t=(o+r)/2;e[i]-=t,n[i]-=t}}bl(r,e,n)}kl(t,e,n)}function wl(t,n,r,o){for(const i of t){const t=new e.InternMap;let a=0;for(const l of i){let i=-1;const s=l.map((t=>Math.abs(r[t]-n[t]))),c=l.map((e=>{i=o?o[e]:++i;const a=r[e]-n[e],l=t.has(i)?a-t.get(i):0;return t.set(i,a),l})),u=[0,...e.cumsum(c)];for(const t of l)n[t]+=a,r[t]+=a;const f=e.sum(s);f&&(a-=e.sum(s,((t,e)=>(c[e]/2+u[e])*t))/f)}bl(i,n,r)}kl(t,n,r)}function bl(t,n,r){const o=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=o,r[t]-=o}function kl(t,n,r){const o=t.length;if(1===o)return;const i=t.map((t=>t.flat())),a=i.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),l=e.min(a);for(let t=0;t<o;t++){const e=l-a[t];for(const o of i[t])n[o]+=e,r[o]+=e}}function $l(t,e,n){return n}function Ml(t,e,n,r){return r}function Ll(t,n,r,o){return El(o,e.groupSort(rt(t),(t=>e.sum(t,(t=>r[t]))),(t=>o[t])))}function Al(t,n,r,o){return El(o,e.groupSort(rt(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])))}function zl(t,n,r,o){const i=rt(t),a=e.groupSort(i,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])),l=e.rollup(i,(t=>e.sum(t,(t=>r[t]))),(t=>o[t])),s=[],c=[];let u=0;for(const t of a)u<0?(u+=l.get(t),s.push(t)):(u-=l.get(t),c.push(t));return El(o,c.reverse().concat(s))}function Sl(t){return e=>w(e,t)}function El(t,n){if(!t)throw new Error("missing channel: z");return n=new e.InternMap(n.map(((t,e)=>[t,e]))),t.map((t=>n.get(t)))}function Rl(t,e){for(const n of t)n.sort(((t,n)=>r(e[t],e[n])))}const Ol={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Cl extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:nt(e),optional:!0}},e,Ol),this.z=a,this.curve=Ca(l,s)}filter(t){return t}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r;return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,n,0,0).call((n=>n.selectAll().data(Lr(t,[a,l,s,c],this,r)).enter().append("path").call(zr,this).call($r,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>l[t])).x1((t=>s[t])).y1((t=>c[t]))))).node()}}function Tl(t,e){const{y:n=L,...r}=Da(e);return new Cl(t,hl(sl({...r,y1:n,y2:void 0})))}function Bl(t,e){const{x:n=L,...r}=ja(e);return new Cl(t,dl(cl({...r,x1:n,x2:void 0})))}const Nl={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Pl extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,curve:a,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Nl),this.curve=Ta(a,l),xo(this,e)}project(t,e,n){this.curve!==Ba&&super.project(t,e,n)}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r,{curve:u}=this;return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(zr,this).attr("d",u===Ba&&i.projection?function(t,n,r,o,i){const a=e.geoPath(t);return n=P(n),r=P(r),o=P(o),i=P(i),t=>a({type:"LineString",coordinates:[[n[t],r[t]],[o[t],i[t]]]})}(i.projection,a,l,s,c):t=>{const n=e.pathRound(),r=u(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n}).call(kr,this,r).call(Ao,this,r,i))).node()}}function Il(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=Wl(e,n,r),[i,a]=Wl(o,i,a),new Pl(t,{...l,x1:n,x2:r,y1:i,y2:a})}function Wl(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const jl={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Dl extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,bend:a=0,headAngle:l=60,headLength:s=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,jl),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+l,this.headLength=+s,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:B(void 0===u?1:u),g=f*vo,v=h*vo/2,x=d/1.5;return qe("svg:g",o).call(Ar,this,r,o).call(Rr,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(zr,this).attr("d",(t=>{let e=i[t],n=a[t],r=l[t],o=s[t];const c=Math.hypot(r-e,o-n);if(c<=p+m)return null;let u=Math.atan2(o-n,r-e);const f=Math.min(x*y(t),c/3),h=Math.hypot(c/Math.tan(g),c)/2;if(p||m)if(h<1e5){const t=Math.sign(g),[i,a]=function([t,e],[n,r],o,i){const a=n-t,l=r-e,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+n)/2-l*c,(e+r)/2+a*c]}([e,n],[r,o],h,t);if(p&&([e,n]=Fl([i,a,h],[e,n,p],-t*Math.sign(p))),m){const[e,n]=Fl([i,a,h],[r,o,m],t*Math.sign(m));u+=Math.atan2(n-a,e-i)-Math.atan2(o-a,r-i),r=e,o=n}}else{const t=r-e,i=o-n,a=Math.hypot(t,i);p&&(e+=t/a*p,n+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const d=u+g,w=d+v,b=d-v,k=r-f*Math.cos(w),$=o-f*Math.sin(w),M=r-f*Math.cos(b),L=o-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${g>0?1:0} `:"L"}${r},${o}M${k},${$}L${r},${o}L${M},${L}`})).call(kr,this,n))).node()}}function Fl([t,e,n],[r,o,i],a){const l=r-t,s=o-e,c=Math.hypot(l,s),u=(l*l+s*s-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(l*u+s*f)/c,e+(s*u-l*f)/c]}class ql extends Jr{constructor(t,e,n={},r){super(t,e,n,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=n;this.insetTop=R(i),this.insetRight=R(a),this.insetBottom=R(l),this.insetLeft=R(s),this.rx=Or(c,"auto"),this.ry=Or(u,"auto")}render(t,e,n,r,o){const{rx:i,ry:a}=this;return qe("svg:g",o).call(Ar,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("rect").call(zr,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(Er,"rx",i).call(Er,"ry",a).call(kr,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}}const Yl={ariaLabel:"bar"};class _l extends ql{constructor(t,e={}){const{x1:n,x2:r,y:o}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},e,Yl)}_transform(t,e,{x:n}){t.call(Rr,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:o}=this;return ar(t)?r+o:t=>Math.min(e[t],n[t])+o}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return ar(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}class Gl extends ql{constructor(t,e={}){const{x:n,y1:r,y2:o}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,Yl)}_transform(t,e,{y:n}){t.call(Rr,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:o}=this;return ar(t)?r+o:t=>Math.min(e[t],n[t])+o}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return ar(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}function Xl(t,e={}){return H(e)||(e={...e,y:L,x2:A}),new _l(t,hl(Io(sl(e))))}function Ul(t,e={}){return H(e)||(e={...e,x:L,y2:A}),new Gl(t,dl(Wo(cl(e))))}const Vl={ariaLabel:"cell"};class Hl extends ql{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,Vl)}_transform(t,e){t.call(Rr,e,{},0,0)}}function Zl(t,{x:e,y:n,...r}={}){return[e,n]=et(e,n),new Hl(t,{...r,x:e,y:n})}const Ql={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Jl(t){return void 0===t.sort&&void 0===t.reverse?ee({channel:"-r"},t):t}class Kl extends Jr{constructor(t,n={}){const{x:r,y:o,r:i,rotate:a,symbol:s=e.symbolCircle,frameAnchor:c}=n,[u,f]=F(a,0),[h,d]=function(t){if(null==t||Gt(t))return[void 0,t];if("string"==typeof t){const e=_t.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[p,m]=F(i,null==h?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:p,scale:"r",filter:l,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},Jl(n),Ql),this.r=m,this.rotate=f,this.symbol=d,this.frameAnchor=Ot(c);const{channels:y}=this,{symbol:g}=y;if(g){const{fill:t,stroke:e}=y;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill,stroke:e?e.value===g.value?"color":"currentColor":this.stroke}}}render(t,n,r,o,i){const{x:a,y:l}=n,{x:c,y:u,r:f,rotate:h,symbol:d}=r,{r:p,rotate:m,symbol:y}=this,[g,v]=Pr(this,o),x=y===e.symbolCircle,w=f?void 0:p*p*Math.PI;return s(p)&&(t=[]),qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,{x:c&&a,y:u&&l}).call((n=>n.selectAll().data(t).enter().append(x?"circle":"path").call(zr,this).call(x?t=>{t.attr("cx",c?t=>c[t]:g).attr("cy",u?t=>u[t]:v).attr("r",f?t=>f[t]:p)}:t=>{t.attr("transform",Uo`translate(${c?t=>c[t]:g},${u?t=>u[t]:v})${h?t=>` rotate(${h[t]})`:m?` rotate(${m})`:""}`).attr("d",f&&d?t=>{const n=e.pathRound();return d[t].draw(n,f[t]*f[t]*Math.PI),n}:f?t=>{const n=e.pathRound();return y.draw(n,f[t]*f[t]*Math.PI),n}:d?t=>{const n=e.pathRound();return d[t].draw(n,w),n}:(()=>{const t=e.pathRound();return y.draw(t,w),t})())}).call(kr,this,r))).node()}}function ts(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=et(e,n)),new Kl(t,{...r,x:e,y:n})}const es={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ns extends Jr{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:nt(e),optional:!0}},e,es),this.z=o,this.curve=Ta(i,a),xo(this,e)}filter(t){return t}project(t,e,n){this.curve!==Ba&&super.project(t,e,n)}render(t,n,r,o,i){const{x:a,y:l}=r,{curve:s}=this;return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,n).call((n=>n.selectAll().data(Lr(t,[a,l],this,r)).enter().append("path").call(zr,this).call($r,this,r).call(zo,this,r,i).attr("d",s===Ba&&i.projection?function(t,n,r){const o=e.geoPath(t);return n=P(n),r=P(r),t=>{let e=[];const i=[e];for(const o of t)-1===o?(e=[],i.push(e)):e.push([n[o],r[o]]);return o({type:"MultiLineString",coordinates:i})}}(i.projection,a,l):e.line().curve(s).defined((t=>t>=0)).x((t=>a[t])).y((t=>l[t]))))).node()}}function rs(t,{x:e,y:n,...r}={}){return[e,n]=et(e,n),new ns(t,{...r,x:e,y:n})}function os(t,{x:e=A,y:n=L,...r}={}){return new ns(t,Da({...r,x:e,y:n}))}function is(t,{x:e=L,y:n=A,...r}={}){return new ns(t,ja({...r,x:e,y:n}))}const as={ariaLabel:"rect"};class ls extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,as),this.insetTop=R(l),this.insetRight=R(s),this.insetBottom=R(c),this.insetLeft=R(u),this.rx=Or(f,"auto"),this.ry=Or(h,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x1:l,y1:s,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return qe("svg:g",o).call(Ar,this,r,o).call(Rr,this,{x:l&&c&&i,y:s&&u&&a},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(zr,this).attr("x",l&&c&&(g||!ar(i))?t=>Math.min(l[t],c[t])+b:p+b).attr("y",s&&u&&(g||!ar(a))?t=>Math.min(s[t],u[t])+v:f+v).attr("width",l&&c&&(g||!ar(i))?t=>Math.max(0,Math.abs(c[t]-l[t])-b-x):m-h-p-x-b).attr("height",s&&u&&(g||!ar(a))?t=>Math.max(0,Math.abs(s[t]-u[t])-v-w):y-f-d-v-w).call(Er,"rx",k).call(Er,"ry",$).call(kr,this,n))).node()}}function ss(t,e){return new ls(t,No(Po(e)))}function cs(t,e={}){return H(e)||(e={...e,y:L,x2:A,interval:1}),new ls(t,hl(Po(sl(e))))}function us(t,e={}){return H(e)||(e={...e,x:L,y2:A,interval:1}),new ls(t,dl(No(cl(e))))}function fs(t,e){e=function({x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}={}){J(t)||(t=ps(t));J(e)||(e=ps(e));J(n)||(n=At(n)?{color:n}:ps(n));J(r)||(r=ps(r));J(o)&&({value:o}=ps(o));J(i)&&({value:i}=ps(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}}(e);const{x:n,y:r,color:o,size:i}=e,a=ds(t,n),l=ds(t,r),s=ds(t,o),c=ds(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:y,zero:g,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:z},mark:S}=e;if(void 0===y&&(y=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==y&&null==x&&null==A&&null!=m?"count":null),void 0!==z||null!=A||null!=L||null!=y||null!=w||null!=m&&!wt(a)||null!=x&&!wt(l)||(z="count"),void 0===g&&(g=!!ms(y)||void 0),void 0===b&&(b=!!ms(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=y&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===S&&(S=null!=A||null!=z?"dot":ms(y)||ms(w)||null!=L?"bar":null!=m&&null!=x?wt(a)||wt(l)||null==y&&null==w&&!hs(a)&&!hs(l)?"dot":"line":null!=m||null!=x?"rule":null),S){case"dot":h=ts,f="stroke";break;case"line":h=a&&l||null!=y||null!=w?b||null!=w||a&&hs(a)?is:g||null!=y||l&&hs(l)?os:rs:a?os:is,f="stroke",gs(s)&&(u=null);break;case"area":h=!b&&null==w&&(g||null!=y||l&&hs(l))?Tl:Bl,f="fill",gs(s)&&(u=null);break;case"rule":h=a?_o:Go,f="stroke";break;case"bar":h=b?ys(y,a)?Ul:us:g?ys(w,l)?Xl:cs:ys(y,a)&&ys(w,l)?Zl:ys(y,a)?Ul:ys(w,l)?Xl:null!=y?cs:null!=w?us:ss,f="fill";break;default:throw new Error(`invalid mark: ${S}`)}let E,R={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0,tip:!0},O={[f]:L??void 0,r:z??void 0};if(null!=y&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(O.y=w,E=wt(a)?ae:Na):null!=y?(O.x=y,E=wt(l)?le:Pa):null==L&&null==z||(a&&l?E=wt(a)&&wt(l)?se:wt(a)?Pa:wt(l)?Na:Ia:a?E=wt(a)?ae:Na:l&&(E=wt(l)?le:Pa)),E!==Ia&&E!==Na||(R.x={value:a,...v}),E!==Ia&&E!==Pa||(R.y={value:l,...k}),void 0===g&&(g=a&&!(E===Ia||E===Na)&&(h===Xl||h===Tl||h===cs||h===Go)),void 0===b&&(b=l&&!(E===Ia||E===Pa)&&(h===Ul||h===Bl||h===us||h===_o)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:y??null,zero:!!g,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:z??null},mark:S,markImpl:xs[h],markOptions:R,transformImpl:xs[E],transformOptions:O,colorMode:f}}function hs(t){let n,r;for(const o of t){if(null==o)continue;if(void 0===n){n=o;continue}const t=Math.sign(e.ascending(n,o));if(t){if(void 0!==r&&t!==r)return!1;n=o,r=t}}return!0}function ds(t,e){const n=w(t,e.value);return n&&(n.label=ft(e.value)),n}function ps(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&Z(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function ms(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function ys(t,e){return!(null!=t&&!function(t){return/^(?:first|last|mode)$/i.test(t)}(t)||!e)&&wt(e)}function gs(t){return!!t&&new e.InternSet(t).size>t.length>>1}const vs={dot:ts,line:rs,lineX:os,lineY:is,areaX:Tl,areaY:Bl,ruleX:_o,ruleY:Go,barX:Xl,barY:Ul,rect:ss,rectX:cs,rectY:us,cell:Zl,bin:Ia,binX:Na,binY:Pa,group:se,groupX:ae,groupY:le},xs=Object.fromEntries(Object.entries(vs).map((([t,e])=>[e,t])));function ws(t,e={}){let{x:n,x1:r,x2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,x:n=A});const i={};return null!=n&&(i.x=t),null!=r&&(i.x1=t),null!=o&&(i.x2=t),ks(i,e)}function bs(t,e={}){let{y:n,y1:r,y2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,y:n=A});const i={};return null!=n&&(i.y=t),null!=r&&(i.y1=t),null!=o&&(i.y2=t),ks(i,e)}function ks(t={},n={}){const r=nt(n),o=Object.entries(t).map((([t,e])=>{const r=st(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=ct(r);return{key:t,input:r,output:o,setOutput:i,map:$s(e)}}));return{...Vt(n,((t,n)=>{const i=w(t,r),a=o.map((({input:e})=>w(t,e))),l=o.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of i?e.group(t,(t=>i[t])).values():[t])o.forEach((({map:t},e)=>t.mapIndex(n,a[e],l[e])));return{data:t,facets:n}})),...Object.fromEntries(o.map((({key:t,output:e})=>[t,e])))}}function $s(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&Z(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return Ms(at(t));switch(`${t}`.toLowerCase()){case"cumsum":return Ls;case"rank":return Ms(((t,n)=>e.rank(t,(t=>n[t]))));case"quantile":return Ms(((t,n)=>function(t,n){const r=e.count(t,n)-1;return e.rank(t,n).map((t=>t/r))}(t,(t=>n[t]))))}throw new Error(`invalid map: ${t}`)}function Ms(t){return{mapIndex(e,n,r){const o=t(e,n);if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=o[t]}}}const Ls={mapIndex(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}},As={ariaLabel:"tick",fill:null,stroke:"currentColor"};class zs extends Jr{constructor(t,e,n){super(t,e,n,As),xo(this,n)}render(t,e,n,r,o){return qe("svg:g",o).call(Ar,this,r,o).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(zr,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(kr,this,n).call(Ao,this,n,o))).node()}}class Ss extends zs{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=R(i),this.insetBottom=R(a)}_transform(t,e,{x:n}){t.call(Rr,e,{x:n},yr,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}}class Es extends zs{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=R(i),this.insetLeft=R(a)}_transform(t,e,{y:n}){t.call(Rr,e,{y:n},0,yr)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Rs(t,{x:e=A,...n}={}){return new Ss(t,{...n,x:e})}function Os(t,{y:e=A,...n}={}){return new Es(t,{...n,y:e})}function Cs(t){const e=Ts(t),n=Bs(t);return t.map((t=>t<e||t>n?t:NaN))}function Ts(t){const n=2.5*Ns(t)-1.5*Ps(t);return e.min(t,(t=>t>=n?t:NaN))}function Bs(t){const n=2.5*Ps(t)-1.5*Ns(t);return e.max(t,(t=>t<=n?t:NaN))}function Ns(t){return e.quantile(t,.25)}function Ps(t){return e.quantile(t,.75)}const Is={ariaLabel:"raster",stroke:null,pixelSize:1};function Ws(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function js(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}class Ds extends Jr{constructor(t,e,n={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=n;if(null!=o&&(o=js(o,"width")),null!=i&&(i=js(i,"height")),null!=s&&(s=Ws(s,"x1")),null!=c&&(c=Ws(c,"y1")),null!=u&&(u=Ws(u,"x2")),null!=f&&(f=Ws(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%n*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(e-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/n)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...e},n,r),this.width=o,this.height=i,this.pixelSize=Ws(h,"pixelSize"),this.blur=Ws(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return Xs;switch(`${t}`.toLowerCase()){case"none":return Xs;case"nearest":return Vs;case"barycentric":return Us();case"random-walk":return Hs()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class Fs extends Ds{constructor(t,e={}){const{imageRendering:n}=e;if(null==t){const{fill:t,fillOpacity:n}=e;void 0!==F(n)[0]&&(e=Gs("fillOpacity",e)),void 0!==D(t)[0]&&(e=Gs("fill",e))}super(t,void 0,e,Is),this.imageRendering=Or(n,"auto")}scale(t,{color:e,...n},r){return super.scale(t,n,r)}render(t,n,r,o,i){const a=n[r.channels.fill?.scale]??(t=>t),{x:l,y:s}=r,{document:c}=i,[u,f,h,d]=Ys(r,o,i),p=h-u,m=d-f,{pixelSize:y,width:g=Math.round(Math.abs(p)/y),height:v=Math.round(Math.abs(m)/y)}=this,x=g*v;let{fill:w,fillOpacity:b}=r,k=0;if(this.interpolate){const e=g/p,n=v/m,r=G(l,(t=>(t-u)*e),Float64Array),o=G(s,(t=>(t-f)*n),Float64Array);w&&(w=this.interpolate(t,g,v,r,o,w)),b&&(b=this.interpolate(t,g,v,r,o,b))}else null==this.data&&t&&(k=t.fi*x);const $=c.createElement("canvas");$.width=g,$.height=v;const M=$.getContext("2d"),L=M.createImageData(g,v),A=L.data;let{r:z,g:S,b:E}=e.rgb(this.fill)??{r:0,g:0,b:0},R=255*(this.fillOpacity??1);for(let t=0;t<x;++t){const n=t<<2;if(w){const r=a(w[t+k]);if(null==r){A[n+3]=0;continue}({r:z,g:S,b:E}=e.rgb(r))}b&&(R=255*b[t+k]),A[n+0]=z,A[n+1]=S,A[n+2]=E,A[n+3]=R}return this.blur>0&&e.blurImage(L,this.blur),M.putImageData(L,0,0),qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,n).call((t=>t.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(Er,"image-rendering",this.imageRendering).call(zr,this).attr("xlink:href",$.toDataURL()))).node()}}function qs(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return void 0===r&&void 0===o&&function(t){if(!vt(t))return!1;for(const e of t)if(null!=e)return"object"==typeof e&&"0"in e&&"1"in e}(e)&&(r=O,o=C,void 0===i&&(i=T)),[e,{...a,x:r,y:o,[t]:i}]}function Ys({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,e&&null==i?e[0]:s,n&&null==i?n[0]:a-c,r&&null==i?r[0]:l-u]}function _s({x1:t,y1:e,x2:n,y2:r},o,i,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),Ys(Oe(l,o),i,a)}function Gs(t,e={}){const{[t]:n}=e;if("function"!=typeof n)throw new Error(`invalid ${t}: not a function`);return Ht({...e,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=_s(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=e,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let e=.5;e<x;++e)for(let r=.5;r<v;++r,++$)w[$]=n(c.invert(f+r*b),u.invert(h+e*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function Xs(t,e,n,r,o,i){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||o[l]<0||o[l]>=n||(a[Math.floor(o[l])*e+Math.floor(r[l])]=i[l]);return a}function Us({random:t=e.randomLcg(42)}={}){return(n,r,o,i,a,l)=>{const s=n.length,c=r>>2,u=(o>>2)-1,f=s+2*c+2*u,h=new Float64Array(2*f);for(let t=0;t<s;++t)h[2*t]=i[n[t]],h[2*t+1]=a[n[t]];let d=s;const p=(t,e)=>(h[2*d]=t,h[2*d+1]=e,d++);for(let t=0;t<=c;++t)p(t/c*r,0),p(t/c*r,o);for(let t=0;t<u;++t)p(r,t/u*o),p(0,t/u*o);l=ot(l,n);const m=new e.Delaunay(h.subarray(0,2*s));for(let t,e=s;e<f;++e)l[e]=l[t=m.find(h[2*e],h[2*e+1],t)];const{points:y,triangles:g}=new e.Delaunay(h),v=new l.constructor(r*o),x=function(t,e){return Mt(t)||bt(t)?Zs:function(t){return(e,n,r,o,i,a,l,s)=>{const c=t(l,s);return c<n?e:c<n+o?r:i}}(e)}(l,t);for(let t=0;t<g.length;t+=3){const e=g[t],n=g[t+1],i=g[t+2],a=y[2*e],s=y[2*n],c=y[2*i],u=y[2*e+1],f=y[2*n+1],h=y[2*i+1],d=Math.min(a,s,c),p=Math.max(a,s,c),m=Math.min(u,f,h),w=Math.max(u,f,h),b=(f-h)*(a-c)+(u-h)*(c-s);if(!b)continue;const k=l[e],$=l[n],M=l[i];for(let t=Math.floor(d);t<p;++t)for(let e=Math.floor(m);e<w;++e){if(t<0||t>=r||e<0||e>=o)continue;const n=t+.5,i=e+.5,l=((f-h)*(n-c)+(i-h)*(c-s))/b;if(l<0)continue;const d=((h-u)*(n-c)+(i-h)*(a-c))/b;if(d<0)continue;const p=1-l-d;p<0||(v[t+r*e]=x(k,l,$,d,M,p,t,e))}}return v}}function Vs(t,n,r,o,i,a){const l=new a.constructor(n*r),s=e.Delaunay.from(t,(t=>o[t]),(t=>i[t]));let c,u;for(let e=.5,o=0;e<r;++e){u=c;for(let r=.5;r<n;++r,++o)u=s.find(r,e,u),.5===r&&(c=u),l[o]=a[t[u]]}return l}function Hs({random:t=e.randomLcg(42),minDistance:n=.5,maxSteps:r=2}={}){return(o,i,a,l,s,c)=>{const u=new c.constructor(i*a),f=e.Delaunay.from(o,(t=>l[t]),(t=>s[t]));let h,d,p;for(let e=.5,m=0;e<a;++e){d=h;for(let a=.5;a<i;++a,++m){let i,y=a,g=e;p=d=f.find(y,g,d),.5===a&&(h=d);let v=0;for(;(i=Math.hypot(l[o[p]]-y,s[o[p]]-g))>n&&v<r;){const n=2*t(a,e,v)*Math.PI;y+=Math.cos(n)*i,g+=Math.sin(n)*i,p=f.find(y,g,p),++v}u[m]=c[o[p]]}}return u}}function Zs(t,e,n,r,o,i){return e*t+r*n+i*o}const Qs={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class Js extends Ds{constructor(t,{smooth:n=!0,value:r,...o}={}){const i=xr({},o,Qs);if(void 0===r)for(const t in i)if(null!=i[t].value){if(void 0!==r)throw new Error("ambiguous contour value");r=o[t],o[t]="value"}if(null!=r){const t={transform:t=>t.map((t=>t.value)),label:ft(r)};for(const e in i)"value"===o[e]&&(o[e]=t)}if(null==t){if(null==r)throw new Error("missing contour value");o=Gs("value",{value:r,...o}),r=null}else{let{interpolate:t}=o;void 0===r&&(r=A),void 0===t&&(o.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},function({thresholds:t,interval:n,...r}){return t=Ga(t,n,e.thresholdSturges),Ht(r,(function(n,r,o,i,a,l){const[s,c,u,f]=_s(o,i,a,l),h=u-s,d=f-c,{pixelSize:p,width:m=Math.round(Math.abs(h)/p),height:y=Math.round(Math.abs(d)/p)}=this,g=m/h,v=y/d,x=o.value.value,w=[];if(this.interpolate){const{x:t,y:e}=en(o,i,l),n=G(t,(t=>(t-s)*g),Float64Array),a=G(e,(t=>(t-c)*v),Float64Array),u=[o.x,o.y,o.value],f=[n,a,x];for(const t of r){const e=this.filter(t,u,f);w.push(this.interpolate(e,m,y,n,a,x))}}else if(r){const t=m*y,e=r.length;for(let n=0;n<e;++n)w.push(x.slice(n*t,n*t+t))}else w.push(x);if(this.blur>0)for(const t of w)e.blur2({data:t,width:m,height:y},this.blur);const b=function(t,n,r,o){if("function"==typeof t?.range)return t.range(t.floor(r),o);"function"==typeof t&&(t=t(n,r,o));if("number"!=typeof t)return _(t);const i=e.ticks(...e.nice(r,o,t),t);for(;i[i.length-1]>=o;)i.pop();for(;i[1]<r;)i.shift();return i}(t,x,...function(t){return[e.min(t,(t=>e.min(t,Ks))),e.max(t,(t=>e.max(t,Ks)))]}(w));if(null===b)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=e.contours().size([m,y]).smooth(this.smooth),$=[],M=[];for(const t of w)M.push(e.range($.length,$.push(...G(b,(e=>k(t,e))))));for(const{coordinates:t}of $)for(const e of t)for(const t of e)for(const e of t)e[0]=e[0]/g+s,e[1]=e[1]/v+c;return{data:$,facets:M,channels:Re(this.contourChannels,$)}}))}(o),Qs);const a={geometry:{value:A}};for(const t in this.channels){const e=this.channels[t],{scale:n}=e;"x"!==n&&"y"!==n&&"value"!==t&&(a[t]=e,delete this.channels[t])}this.contourChannels=a,this.smooth=!!n}filter(t,{x:e,y:n,value:r,...o},i){return super.filter(t,o,i)}render(t,n,r,o,i){const{geometry:a}=r,l=e.geoPath();return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(zr,this).attr("d",(t=>l(a[t]))).call(kr,this,r)})).node()}}function Ks(t){return isFinite(t)?t:NaN}function tc(t,e,n={}){const{x:r,y:o,maxRadius:i}=n,a=t({px:r,py:o,maxRadius:i}),l=[];null!=r&&l.push(_o(e,rc("x",{...a,inset:-6},n))),null!=o&&l.push(Go(e,rc("y",{...a,inset:-6},n))),null!=r&&l.push(Ko(e,oc("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),null!=o&&l.push(Ko(e,oc("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const t of l)t.ariaLabel=`crosshair ${t.ariaLabel}`;return Kr(...l)}function ec(t,{channels:e,...n},{facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:s,transform:c,initializer:u}){return{...n,facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:{...e,...s},transform:c,initializer:nc(t,u)}}function nc(t,e){return null==e?e:function(n,r,{x:o,y:i,px:a,py:l,...s},...c){const{channels:{x:u,y:f,...h}={},...d}=e.call(this,n,r,{...s,x:a,y:l},...c);return{channels:{...h,...u&&{px:u,..."x"===t&&{x:u}},...f&&{py:f,..."y"===t&&{y:f}}},...d}}}function rc(t,e,n){const{color:r="currentColor",opacity:o=.2,ruleStroke:i=r,ruleStrokeOpacity:a=o,ruleStrokeWidth:l}=n;return{...ec(t,e,n),stroke:i,strokeOpacity:a,strokeWidth:l}}function oc(t,e,n){const{color:r="currentColor",textFill:o=r,textFillOpacity:i,textStroke:a="white",textStrokeOpacity:l,textStrokeWidth:s=5}=n;return{...ec(t,e,ic(t,n)),fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s}}function ic(t,e){return Ht(e,((e,n,r)=>({channels:{text:{value:De(r,t)?.value}}})))}const ac={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},lc={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},sc={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},cc={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},uc={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class fc extends Jr{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,ac),this.curve=Ca(i,a),xo(this,e)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,{curve:f}=this,[h,d]=Pr(this,o),p=s?t=>s[t]:B(h),m=c?t=>c[t]:B(d),y=this;function g(t){let n=-1;const o=[],a={};for(const t in r)a[t]=[];const l=[],s=[],c=[],u=[];function h(e,i){e=t[e],i=t[i],o.push(++n),l[n]=p(e),c[n]=m(e),s[n]=p(i),u[n]=m(i);for(const t in r)a[t].push(r[t][i])}const{halfedges:d,hull:g,triangles:v}=e.Delaunay.from(t,p,m);for(let t=0;t<d.length;++t){const e=d[t];e>t&&h(v[t],v[e])}for(let t=0;t<g.length;++t)h(g[t],g[(t+1)%g.length]);e.select(this).selectAll().data(o).enter().append("path").call(zr,y).attr("d",(t=>{const n=e.pathRound(),r=f(n);return r.lineStart(),r.point(l[t],c[t]),r.point(s[t],u[t]),r.lineEnd(),n})).call(kr,y,a).call(Ao,y,a,i)}return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class hc extends Jr{constructor(t,e={},n,r=(({z:t})=>t)){const{x:o,y:i}=e;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Pr(this,o),d=s?t=>s[t]:B(f),p=c?t=>c[t]:B(h),m=this;function y(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(zr,m).attr("d",m._render(n,o)).call(kr,m,r)}return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class dc extends hc{constructor(t,e={}){super(t,e,lc),this.fill="none"}_render(t){return t.render()}}class pc extends hc{constructor(t,e={}){super(t,e,sc,nt)}_render(t){return t.renderHull()}}class mc extends Jr{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,cc)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Pr(this,o),d=s?t=>s[t]:B(f),p=c?t=>c[t]:B(h),m=this;function y(t){const n=gc(e.Delaunay.from(t,d,p),o);e.select(this).selectAll().data(t).enter().append("path").call(zr,m).attr("d",((t,e)=>n.renderCell(e))).call(kr,m,r)}return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class yc extends hc{constructor(t,e){super(t,e,uc),this.fill="none"}_render(t,e){return gc(t,e).render()}}function gc(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,o,n-i,r-a])}function vc(t,e,{x:n,y:r,...o}={}){return[n,r]=et(n,r),new t(e,{...o,x:n,y:r})}const xc={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class wc extends Jr{constructor(t,{x:n,y:r,z:o,weight:i,fill:a,stroke:l,...s}={}){const c=kc(a)&&(a="currentColor",!0),u=kc(l)&&(l="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:nt({z:o,fill:a,stroke:l}),optional:!0},weight:{value:i,optional:!0}},function(t,n,r){const o=100;let{bandwidth:i,thresholds:a}=t;return i=void 0===i?20:+i,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?P(a):+a,Ht(t,(function(t,l,s,c,u,f){const h=s.weight?P(s.weight.value):null,d=s.z?.value,{z:p}=this,[m,y]=Pr(this,u),{width:g,height:x}=u,{x:w,y:b}=en(s,c,f),k=Object.fromEntries(Object.entries(s).filter((([t])=>!bc.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),$=n&&[],M=r&&[],L=e.contourDensity().x(w?t=>w[t]:m).y(b?t=>b[t]:y).weight(h?t=>h[t]:1).size([g,x]).bandwidth(i),A=[];for(const t of l){const e=[];A.push(e);for(const n of d?Mr(t,d,p):[t]){const t=L.contours(n);e.push([n,t])}}let z=a;if(!(z instanceof v)){let t=0;for(const e of A)for(const[,n]of e){const e=n.max;e>t&&(t=e)}z=Float64Array.from({length:a-1},((e,n)=>t*o*(n+1)/a))}const S=[],E=[];for(const t of A){const e=[];S.push(e);for(const[n,r]of t)for(const t of z){e.push(E.length),E.push(r(t/o)),$&&$.push(t),M&&M.push(t);for(const t in k)k[t].value.push(s[t].value[n[0]])}}return $&&$.push(0),M&&M.push(0),{data:t,facets:S,channels:{...k,...$&&{fill:{value:$,scale:"color"}},...M&&{stroke:{value:M,scale:"color"}},contours:{value:E}}}}))}({...s,fill:a,stroke:l},c,u),xc),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(t){return t}render(t,n,r,o,i){const{contours:a}=r,l=e.geoPath();return qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(zr,this).call(kr,this,r).attr("d",(t=>l(a[t]))))).node()}}const bc=new Set(["x","y","z","weight"]);function kc(t){return/^density$/i.test(t)}const $c={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Mc extends Jr{constructor(t,e={}){const[n,r]=F(e.r,3);super(t,{geometry:{value:e.geometry},r:{value:n,scale:"r",filter:l,optional:!0}},Jl(e),$c),this.r=r}render(t,n,r,o,i){const{geometry:a,r:l}=r,c=e.geoPath(i.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:u}=this;return s(u)?t=[]:void 0!==u&&c.pointRadius(u),qe("svg:g",i).call(Ar,this,o,i).call(Rr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(zr,this).attr("d",l?t=>c.pointRadius(l[t])(a[t]):t=>c(a[t])).call(kr,this,r)})).node()}}function Lc(t,{geometry:e=A,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Mc(t,{geometry:e,...n})}const Ac=.5,zc=0;function Sc(t,e,n,r){const o=r*(1.5/Ft),i=new Map;for(const a of t){let t=e[a],l=n[a];if(isNaN(t)||isNaN(l))continue;let s=Math.round(l=(l-zc)/o),c=Math.round(t=(t-Ac)/r-(1&s)/2),u=l-s;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=s+(l<s?-1:1),o=t-n,i=l-r;e*e+u*u>o*o+i*i&&(c=n+(1&s?1:-1)/2,s=r)}const f=`${c},${s}`;let h=i.get(f);void 0===h&&(i.set(f,h=[]),h.x=(c+(1&s)/2)*r+Ac,h.y=s*o+zc),h.push(a)}return i.values()}const Ec={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class Rc extends Jr{constructor({binWidth:t=20,clip:e=!0,...n}={}){super($,void 0,{clip:e,...n},Ec),this.binWidth=R(t)}render(t,e,n,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Ac,d=u-l-Ac,p=a-zc,m=f-s-zc,y=i/2,g=y*qt,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${Oc(-g)}l${Oc(y)},${Oc(v)}v${Oc(g)}l${Oc(-y)},${Oc(v)}`;let A=L;for(let t=$;t<M;++t)for(let e=b;e<k;++e)A+=`M${Oc(e*x+(1&t)*y)},${Oc(t*w)}${L}`;return qe("svg:g",o).datum(0).call(Ar,this,r,o).call(Rr,this,{},yr+Ac,yr+zc).call((t=>t.append("path").call(zr,this).call(kr,this,n).attr("d",A))).node()}}function Oc(t){return Math.round(1e3*t)/1e3}const Cc={ariaLabel:"image",fill:null,stroke:null};class Tc extends Jr{constructor(t,e={}){let{x:n,y:r,r:o,width:i,height:a,rotate:s,src:c,preserveAspectRatio:u,crossOrigin:f,frameAnchor:h,imageRendering:d}=e;null==o&&(o=void 0),void 0===o&&void 0===i&&void 0===a?i=a=16:void 0===i&&void 0!==a?i=a:void 0===a&&void 0!==i&&(a=i);const[p,m]="string"==typeof(y=c)&&(function(t){return/^\.*\//.test(t)}(y)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(y))?[void 0,y]:[y,void 0];var y;const[g,v]=F(o),[x,w]=F(i,void 0!==v?2*v:void 0),[b,k]=F(a,void 0!==v?2*v:void 0),[$,M]=F(s,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:g,scale:"r",filter:l,optional:!0},width:{value:x,filter:l,optional:!0},height:{value:b,filter:l,optional:!0},rotate:{value:$,optional:!0},src:{value:p,optional:!0}},Jl(e),Cc),this.src=m,this.width=w,this.rotate=M,this.height=k,this.r=v,this.preserveAspectRatio=Or(u,"xMidYMid"),this.crossOrigin=E(f),this.frameAnchor=Ot(h),this.imageRendering=Or(d,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,width:c,height:u,r:f,rotate:h,src:d}=n,{r:p,width:m,height:y,rotate:g}=this,[v,x]=Pr(this,r);return qe("svg:g",o).call(Ar,this,r,o).call(Rr,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(zr,this).attr("x",Bc(l,c,f,v,m,p)).attr("y",Bc(s,u,f,x,y,p)).attr("width",c?t=>c[t]:void 0!==m?m:f?t=>2*f[t]:2*p).attr("height",u?t=>u[t]:void 0!==y?y:f?t=>2*f[t]:2*p).attr("transform",h?t=>`rotate(${h[t]})`:g?`rotate(${g})`:null).attr("transform-origin",h||g?Uo`${l?t=>l[t]:v}px ${s?t=>s[t]:x}px`:null).call(Er,"href",d?t=>d[t]:this.src).call(Er,"preserveAspectRatio",this.preserveAspectRatio).call(Er,"crossorigin",this.crossOrigin).call(Er,"image-rendering",this.imageRendering).call(Er,"clip-path",f?t=>`circle(${f[t]}px)`:void 0!==p?`circle(${p}px)`:null).call(kr,this,n))).node()}}function Bc(t,e,n,r,o,i){return e&&t?n=>t[n]-e[n]/2:e?t=>r-e[t]/2:t&&void 0!==o?e=>t[e]-o/2:void 0!==o?r-o/2:n&&t?e=>t[e]-n[e]:n?t=>r-n[t]:t?e=>t[e]-i:r-i}function Nc(t,e,n){var r=0===t||1===t?0:Math.exp(Ic(e+n)-Ic(e)-Ic(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*Pc(t,e,n)/e:1-r*Pc(1-t,n,e)/n)}function Pc(t,e,n){var r,o,i,a,l=1e-30,s=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(n-s)*t/((f+(r=2*s))*(e+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(e+s)*(c+s)*t/((e+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function Ic(t){var e,n,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.506628274631*a/e)-r}function Wc(t,e){var n=function(t,e,n){var r,o,i,a,l,s,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=s*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),s=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),o=Math.log(n/(e+n)),s=t<(a=Math.exp(e*r)/e)/(f=a+(l=Math.exp(n*o)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-Ic(e)-Ic(n)+Ic(e+n);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(Nc(s,e,n)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const jc={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Dc extends Jr{constructor(t,e={}){const{x:n,y:r,z:o,ci:i=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:nt(e),optional:!0}},e,jc),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,o){const{x:i,y:a,z:l}=n,{ci:s}=this;return qe("svg:g",o).call(Ar,this,r,o).call(Rr,this,e).call((e=>e.selectAll().data(l?Mr(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(zr,this).call($r,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!Et(this.fill)?t=>t.select(Fc).attr("stroke","none").call(zr,this).call($r,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Fc(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class qc extends Dc{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>r[t])),s=_c(t,r,n),c=Gc(t,r,n,(1-o)/2,s);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>r[t])),a=_c(t,r,n);return`M${a(o)},${o}L${a(i)},${i}`}}class Yc extends Dc{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>n[t])),s=_c(t,n,r),c=Gc(t,n,r,(1-o)/2,s);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=_c(t,n,r);return`M${o},${a(o)}L${i},${a(i)}`}}function _c(t,e,n){let r=0,o=0,i=0,a=0;for(const l of t){const t=e[l],s=n[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function Gc(t,n,r,o,i){const a=e.sum(t,(t=>n[t]))/t.length;let l=0,s=0;for(const e of t)l+=(n[e]-a)**2,s+=(r[e]-i(n[e]))**2;const c=Math.sqrt(s/(t.length-2)),u=Wc(o,t.length-2);return(e,n)=>{const r=i(e),o=c*Math.sqrt(1/t.length+(e-a)**2/l);return r+n*u*o}}function Xc({path:t=A,delimiter:n,frameAnchor:r,treeLayout:o=e.tree,treeSort:i,treeSeparation:a,treeAnchor:l,...s}={}){l=Vc(l),i=Qc(i),void 0===r&&(r=l.frameAnchor);const c=Kc(n),u=du(s,eu),[f,h]=ct(),[d,p]=ct();return{x:f,y:d,frameAnchor:r,...Vt(s,((n,r)=>{const s=c(w(n,t)),f=h([]),d=p([]);let m=-1;const y=[],g=[],v=e.stratify().path((t=>s[t])),x=o();x.nodeSize&&x.nodeSize([1,1]),x.separation&&void 0!==a&&x.separation(a??z);for(const t of u)t[hu]=t[uu]([]);for(const t of r){const e=[],r=v(t.filter((t=>null!=s[t]))).each((t=>t.data=n[t.data]));null!=i&&r.sort(i),x(r);for(const t of r.descendants()){e.push(++m),y[m]=t.data,l.position(t,m,f,d);for(const e of u)e[hu][m]=e[fu](t)}g.push(e)}return{data:y,facets:g}})),...Object.fromEntries(u)}}function Uc({path:t=A,delimiter:n,curve:r="bump-x",stroke:o="#555",strokeWidth:i=1.5,strokeOpacity:a=.5,treeLayout:l=e.tree,treeSort:s,treeSeparation:c,treeAnchor:u,...f}={}){u=Vc(u),s=Qc(s),f={curve:r,stroke:o,strokeWidth:i,strokeOpacity:a,...f};const h=Kc(n),d=du(f,nu),[p,m]=ct(),[y,g]=ct(),[v,x]=ct(),[b,k]=ct();return{x1:p,x2:y,y1:v,y2:b,...Vt(f,((n,r)=>{const o=h(w(n,t)),i=m([]),a=g([]),f=x([]),p=k([]);let y=-1;const v=[],b=[],$=e.stratify().path((t=>o[t])),M=l();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==c&&M.separation(c??z);for(const t of d)t[hu]=t[uu]([]);for(const t of r){const e=[],r=$(t.filter((t=>null!=o[t]))).each((t=>t.data=n[t.data]));null!=s&&r.sort(s),M(r);for(const{source:t,target:n}of r.links()){e.push(++y),v[y]=n.data,u.position(t,y,i,f),u.position(n,y,a,p);for(const e of d)e[hu][y]=e[fu](n,t)}b.push(e)}return{data:v,facets:b}})),...Object.fromEntries(d)}}function Vc(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return Hc;case"right":return Zc}throw new Error(`invalid tree anchor: ${t}`)}const Hc={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},Zc={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function Qc(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?Jc(eu(t)):Jc(function(t){return e=>e.data?.[t]}(t))}function Jc(t){return(e,n)=>r(t(e),t(n))}function Kc(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function tu(t){return Z(t)&&"function"==typeof t.node}function eu(t){if(tu(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return ou;case"node:path":return ru;case"node:internal":return lu;case"node:depth":return iu;case"node:height":return au}throw new Error(`invalid node value: ${t}`)}}function nu(t){if(tu(t))return t.node;if(Z(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return su(ou);case"parent:path":return su(ru);case"parent:depth":return su(iu);case"parent:height":return su(au);case"node:name":return ou;case"node:path":return ru;case"node:internal":return lu;case"node:depth":return iu;case"node:height":return au}throw new Error(`invalid link value: ${t}`)}}function ru(t){return t.id}function ou(t){return function(t){let e=t.length;for(;--e>0&&!cu(t,e););return t.slice(e+1)}(t.id)}function iu(t){return t.depth}function au(t){return t.height}function lu(t){return!!t.children}function su(t){return(e,n)=>null==n?void 0:t(n)}function cu(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const uu=2,fu=3,hu=4;function du(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);void 0!==i&&n.push([r,...ct(o),i])}return n}function pu(t,{fill:e,stroke:n,strokeWidth:r,strokeOpacity:o,strokeLinejoin:i,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:c,marker:u,markerStart:f=u,markerEnd:h=u,dot:d=St(f)&&St(h),text:p="node:name",textStroke:m="white",title:y="node:path",dx:g,dy:v,...x}={}){return void 0===g&&(g=Vc(x.treeAnchor).dx),Kr(Il(t,Uc({markerStart:f,markerEnd:h,stroke:void 0!==n?n:void 0===e?"node:internal":e,strokeWidth:r,strokeOpacity:o,strokeLinejoin:i,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:c,...x})),d?ts(t,Xc({fill:void 0===e?"node:internal":e,title:y,...x})):null,null!=p?Ko(t,Xc({text:p,fill:void 0===e?"currentColor":e,stroke:m,dx:g,dy:v,title:y,...x})):null)}function mu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function yu(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>=0?(i=a,o=a-1):r=a+1}return i}function gu(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>0?(i=a,o=a-1):r=a+1}return i}function vu(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<0?(i=a,r=a+1):o=a-1}return i}function xu(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<=0?(i=a,r=a+1):o=a-1}return i}function wu(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],l=void 0!==n?n(a,e):a-e;if(0===l)return i;l<=0?r=i+1:o=i-1}return-1}function bu(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var ku={ge:function(t,e,n,r,o){return bu(t,e,n,r,o,yu)},gt:function(t,e,n,r,o){return bu(t,e,n,r,o,gu)},lt:function(t,e,n,r,o){return bu(t,e,n,r,o,vu)},le:function(t,e,n,r,o){return bu(t,e,n,r,o,xu)},eq:function(t,e,n,r,o){return bu(t,e,n,r,o,wu)}},$u=function(t){if(!t||0===t.length)return new Iu(null);return new Iu(Pu(t))};function Mu(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Lu=Mu.prototype;function Au(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function zu(t,e){var n=Pu(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function Su(t,e){var n=t.intervals([]);n.push(e),zu(t,n)}function Eu(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),zu(t,n),1)}function Ru(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function Ou(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function Cu(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function Tu(t,e){return t-e}function Bu(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Nu(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Pu(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(Tu);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var l=t[n];l[1]<r?o.push(l):r<l[0]?i.push(l):a.push(l)}var s=a,c=a.slice();return s.sort(Bu),c.sort(Nu),new Mu(r,Pu(o),Pu(i),s,c)}function Iu(t){this.root=t}Lu.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Lu.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?Su(this,t):this.left.insert(t):this.left=Pu([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?Su(this,t):this.right.insert(t):this.right=Pu([t]);else{var n=ku.ge(this.leftPoints,t,Bu),r=ku.ge(this.rightPoints,t,Nu);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Lu.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Eu(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Eu(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}Au(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Au(this,this.left):Au(this,this.right);return 1}for(o=ku.ge(this.leftPoints,t,Bu);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=ku.ge(this.rightPoints,t,Nu);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),1}return 0},Lu.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return Ru(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Ou(this.rightPoints,t,e)}return Cu(this.leftPoints,e)},Lu.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?Ru(this.leftPoints,e,n):t>this.mid?Ou(this.rightPoints,t,n):Cu(this.leftPoints,n)};var Wu=Iu.prototype;Wu.insert=function(t){this.root?this.root.insert(t):this.root=new Mu(t[0],null,null,[t],[t])},Wu.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Wu.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Wu.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Wu,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Wu,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var ju=mu($u);const Du=({marginLeft:t})=>[1,t],Fu=({width:t,marginRight:e})=>[-1,t-e],qu=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Yu=({marginTop:t})=>[1,t],_u=({height:t,marginBottom:e})=>[-1,t-e],Gu=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function Xu(t){return"string"==typeof t?{anchor:t}:t}function Uu(t){const{anchor:e,padding:n,...r}=t,{r:o}=r;return[{anchor:e,padding:n,r:o},r]}function Vu(t,e,n,r,o,i){if(null!=o&&"number"!=typeof o){let{channels:t,sort:e,reverse:n}=i;t=Tt(t),void 0===t?.r&&(i={...i,channels:{...t,r:{value:o,scale:"r"}}}),void 0===e&&void 0===n&&(i.sort={channel:"-r"})}return Ht(i,(function(i,s,c,u,f,h){let{[e]:d,r:p}=c;if(!c[e])throw new Error(`missing channel: ${e}`);({[e]:d}=en(c,u,h));const m=p?void 0:void 0!==o?R(o):void 0!==this.r?this.r:3;p&&(p=w(p.value,u[p.scale]||A,Float64Array));let[y,g]=n(f);const v=y?Zu:Hu,x=new Float64Array(d.length),b=p?t=>p[t]:()=>m;for(let t of s){const e=ju();t=t.filter(p?t=>a(d[t])&&l(p[t]):t=>a(d[t]));const n=new Float64Array(2*t.length+2);for(const o of t){const t=b(o),i=y?t+r:0,a=d[o]-t,l=d[o]+t;let s=2;e.queryInterval(a-r,l+r,(([,,t])=>{const e=x[t]-i,a=d[o]-d[t],l=r+(p?p[o]+p[t]:2*m),c=Math.sqrt(l*l-a*a);n[s++]=e-c,n[s++]=e+c}));let c=n.slice(0,s);y&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(v)){for(let e=0;e<s;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;x[o]=t+i;break}e.insert([a,l,o])}}y||(y=1);for(const t of s)for(const e of t)x[e]=x[e]*y+g;return{data:i,facets:s,channels:{[t]:{value:x,source:null},[e]:{value:d,source:c[e]},...p&&{r:{value:p,source:c.r}}}}}))}function Hu(t,e){return Math.abs(t)-Math.abs(e)}function Zu(t,e){return t-e}function Qu(t){if(void 0===t)return ef;if("function"==typeof t)return Ju(at(t));if(/^p\d{2}$/i.test(t))return Ku(N(t));switch(`${t}`.toLowerCase()){case"deviation":return rf;case"first":return ef;case"last":return nf;case"max":return of;case"mean":return af;case"median":return lf;case"min":return sf;case"sum":return cf;case"extent":return tf}throw new Error(`invalid basis: ${t}`)}function Ju(t){return{mapIndex(e,n,r){const o=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/o}}}function Ku(t){return Ju(((e,n)=>t(e,(t=>n[t]))))}const tf={mapIndex(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=i-o;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-o)/a}},ef=Ju(((t,e)=>{for(let r=0;r<t.length;++r){const o=e[t[r]];if(n(o))return o}})),nf=Ju(((t,e)=>{for(let r=t.length-1;r>=0;--r){const o=e[t[r]];if(n(o))return o}})),rf={mapIndex(t,n,r){const o=e.mean(t,(t=>n[t])),i=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:i?(n[e]-o)/i:0}},of=Ku(e.max),af=Ku(e.mean),lf=Ku(e.median),sf=Ku(e.min),cf=Ku(e.sum);function uf(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:o,anchor:i,strict:a}=t;if(void 0===i&&void 0!==o&&(i=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(o),_e(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return hf(N(t));switch(t.toLowerCase()){case"deviation":return hf(e.deviation);case"max":return df(((t,n)=>e.max(t,(t=>n[t]))));case"mean":return mf;case"median":return hf(e.median);case"min":return df(((t,n)=>e.min(t,(t=>n[t]))));case"mode":return df(((t,n)=>e.mode(t,(t=>n[t]))));case"sum":return pf;case"variance":return hf(e.variance);case"difference":return wf;case"ratio":return bf;case"first":return kf;case"last":return $f}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return df(at(t))}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(i,n),a)}function ff(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function hf(t){return(e,n,r)=>r?{mapIndex(n,r,o){const i=t=>null==r[t]?NaN:+r[t];let a=0;for(let t=0;t<e-1;++t)isNaN(i(t))&&++a;for(let r=0,l=n.length-e+1;r<l;++r)isNaN(i(r+e-1))&&++a,o[n[r+i]]=0===a?t(ff(n,r,r+e),i):NaN,isNaN(i(r))&&--a}}:{mapIndex(n,r,o){const i=t=>null==r[t]?NaN:+r[t];for(let r=-i;r<0;++r)o[n[r+i]]=t(ff(n,0,r+e),i);for(let r=0,a=n.length-i;r<a;++r)o[n[r+i]]=t(ff(n,r,r+e),i)}}}function df(t){return(e,r,o)=>o?{mapIndex(o,i,a){let l=0;for(let t=0;t<e-1;++t)l+=n(i[o[t]]);for(let s=0,c=o.length-e+1;s<c;++s)l+=n(i[o[s+e-1]]),l===e&&(a[o[s+r]]=t(ff(o,s,s+e),i)),l-=n(i[o[s]])}}:{mapIndex(n,o,i){for(let a=-r;a<0;++a)i[n[a+r]]=t(ff(n,0,a+e),o);for(let a=0,l=n.length-r;a<l;++a)i[n[a+r]]=t(ff(n,a,a+e),o)}}}function pf(t,e,n){return n?{mapIndex(n,r,o){let i=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=n.length-t+1;l<s;++l){const s=r[n[l]],c=r[n[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[n[l+e]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(n,r,o){let i=0;const a=n.length;for(let o=0,l=Math.min(a,t-e-1);o<l;++o)i+=+r[n[o]]||0;for(let l=-e,s=a-e;l<s;++l)i+=+r[n[l+t-1]]||0,o[n[l+e]]=i,i-=+r[n[l]]||0}}}function mf(t,e,n){if(n){const r=pf(t,e,n);return{mapIndex(n,o,i){r.mapIndex(n,o,i);for(let r=0,o=n.length-t+1;r<o;++r)i[n[r+e]]/=t}}}return{mapIndex(n,r,o){let i=0,a=0;const l=n.length;for(let o=0,s=Math.min(l,t-e-1);o<s;++o){let t=r[n[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-e,c=l-e;s<c;++s){let l=r[n[s+t-1]],c=r[n[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[n[s+e]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function yf(t,e,r,o){for(let i=r+o;r<i;++r){const o=t[e[r]];if(n(o))return o}}function gf(t,e,r,o){for(let i=r+o-1;i>=r;--i){const r=t[e[i]];if(n(r))return r}}function vf(t,e,n,r){for(let o=n+r;n<o;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function xf(t,e,n,r){for(let o=n+r-1;o>=n;--o){let n=t[e[o]];if(null!==n&&!isNaN(n=+n))return n}}function wf(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l-a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=xf(r,n,i,t)-vf(r,n,i,t)}}}function bf(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l/a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=xf(r,n,i,t)/vf(r,n,i,t)}}}function kf(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=yf(r,n,i,t)}}}function $f(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i+t-1]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=gf(r,n,i,t)}}}function Mf(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Ef;case"max":return Rf}throw new Error(`unknown selector: ${t}`)}function Lf(t){return Of(null,zf,t)}function Af(t){return Of(null,Sf,t)}function*zf(t){yield t[0]}function*Sf(t){yield t[t.length-1]}function*Ef(t,n){yield e.least(t,(t=>n[t]))}function*Rf(t,n){yield e.greatest(t,(t=>n[t]))}function Of(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const o=nt(r);return Vt(r,((r,i)=>{const a=w(r,o),l=w(r,t),s=[];for(const t of i){const r=[];for(const o of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(o,l))r.push(t);s.push(r)}return{data:r,facets:s}}))}t.Area=Cl,t.Arrow=Dl,t.BarX=_l,t.BarY=Gl,t.Cell=Hl,t.Contour=Js,t.Density=wc,t.Dot=Kl,t.Frame=la,t.Geo=Mc,t.Hexgrid=Rc,t.Image=Tc,t.Line=ns,t.Link=Pl,t.Mark=Jr,t.Raster=Fs,t.Rect=ls,t.RuleX=qo,t.RuleY=Yo,t.Text=Zo,t.TickX=Ss,t.TickY=Es,t.Tip=fa,t.Vector=Li,t.area=function(t,e){return void 0===e?Bl(t,{x:O,y:C}):new Cl(t,e)},t.areaX=Tl,t.areaY=Bl,t.arrow=function(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=Wl(e,n,r),[i,a]=Wl(o,i,a),new Dl(t,{...l,x1:n,x2:r,y1:i,y2:a})},t.auto=function(t,e){const n=fs(t,e),{fx:r,fy:o,x:{zero:i},y:{zero:a},markOptions:l,transformOptions:s,colorMode:c}=n,u=vs[n.markImpl],f=vs[n.transformImpl],h=null!=r||null!=o?sa({strokeOpacity:.1}):null,d=[i?_o([0]):null,a?Go([0]):null],p=u(t,f?f(s,l):l);return"stroke"===c?Kr(h,d,p):Kr(h,p,d)},t.autoSpec=fs,t.axisFx=Wi,t.axisFy=Pi,t.axisX=Ii,t.axisY=Ni,t.barX=Xl,t.barY=Ul,t.bin=Ia,t.binX=Na,t.binY=Pa,t.boxX=function(t,{x:e=A,y:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?le:ie;return Kr(Go(t,u({x1:Ts,x2:Bs},{x:e,y:n,stroke:i,strokeOpacity:a,...c})),Xl(t,u({x1:"p25",x2:"p75"},{x:e,y:n,fill:r,fillOpacity:o,...c})),Rs(t,u({x:"p50"},{x:e,y:n,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),ts(t,ks({x:Cs},{x:e,y:n,z:n,stroke:i,strokeOpacity:a,...c})))},t.boxY=function(t,{y:e=A,x:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?ae:ie;return Kr(_o(t,u({y1:Ts,y2:Bs},{x:n,y:e,stroke:i,strokeOpacity:a,...c})),Ul(t,u({y1:"p25",y2:"p75"},{x:n,y:e,fill:r,fillOpacity:o,...c})),Os(t,u({y:"p50"},{x:n,y:e,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),ts(t,ks({y:Cs},{x:n,y:e,z:n,stroke:i,strokeOpacity:a,...c})))},t.cell=Zl,t.cellX=function(t,{x:e=L,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===D(r)[0]&&(n=A),new Hl(t,{...o,x:e,fill:n,stroke:r})},t.cellY=function(t,{y:e=L,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===D(r)[0]&&(n=A),new Hl(t,{...o,y:e,fill:n,stroke:r})},t.centroid=function({geometry:t=A,...n}={}){return Ht({...n,x:null,y:null},((n,r,o,i,a,{projection:l})=>{const s=w(n,t),c=s.length,u=new Float64Array(c),f=new Float64Array(c),h=e.geoPath(l);for(let t=0;t<c;++t)[u[t],f[t]]=h.centroid(s[t]);return{data:n,facets:r,channels:{x:{value:u,source:null},y:{value:f,source:null}}}}))},t.circle=function(t,e){return ts(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return pu(t,{...n,treeLayout:e.cluster})},t.column=ct,t.contour=function(){return new Js(...qs("value",...arguments))},t.crosshair=function(t,e){return tc(io,t,e)},t.crosshairX=function(t,e={}){return tc(ao,t,e)},t.crosshairY=function(t,e={}){return tc(lo,t,e)},t.delaunayLink=function(t,e){return vc(fc,t,e)},t.delaunayMesh=function(t,e){return vc(dc,t,e)},t.density=function(t,{x:e,y:n,...r}={}){return[e,n]=et(e,n),new wc(t,{...r,x:e,y:n})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=Uu(t));let{anchor:n="left",padding:r=1,r:o=e.r}=Xu(t);switch(`${n}`.toLowerCase()){case"left":n=Du;break;case"right":n=Fu;break;case"middle":n=qu;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Vu("x","y",n,R(r),o,e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=Uu(t));let{anchor:n="bottom",padding:r=1,r:o=e.r}=Xu(t);switch(`${n}`.toLowerCase()){case"top":n=Yu;break;case"bottom":n=_u;break;case"middle":n=Gu;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Vu("y","x",n,R(r),o,e)},t.dot=ts,t.dotX=function(t,{x:e=A,...n}={}){return new Kl(t,Do({...n,x:e}))},t.dotY=function(t,{y:e=A,...n}={}){return new Kl(t,jo({...n,y:e}))},t.filter=function(t,e){return Jt(e,Kt(t))},t.formatIsoDate=pr,t.formatMonth=function(t="en-US",e="short"){const n=hr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=dr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=sa,t.geo=Lc,t.geoCentroid=function({geometry:t=A,...n}={}){let r;return{...n,x:{transform:n=>Float64Array.from(r=w(w(n,t),e.geoCentroid),(([t])=>t))},y:{transform:()=>Float64Array.from(r,(([,t])=>t))}}},t.graticule=function({strokeOpacity:t=.1,...n}={}){return Lc(e.geoGraticule10(),{strokeOpacity:t,...n})},t.gridFx=_i,t.gridFy=qi,t.gridX=Yi,t.gridY=Fi,t.group=se,t.groupX=ae,t.groupY=le,t.groupZ=ie,t.hexagon=function(t,e){return ts(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){e=void 0===e?20:R(e),t=fe(t,n);const{z:r,fill:o,stroke:i}=n;return void 0===i&&St(o)&&ue(t,"fill")&&(n.stroke="none"),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||ue(t,"r")||(n.r=e/2),Ht(n,((n,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=en(i,a,s)),f=f?f.value:w(n,r),h=h?.value,d=d?.value,p=p?.value;const m=ge(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],b=[],k=[],$=[];let M=-1;for(const e of t)e.initialize(n);for(const n of o){const r=[];for(const e of t)e.scope("facet",n);for(const[o,i]of pe(n,m))for(const n of Sc(i,c,u,e)){r.push(++M),k.push(n.x),$.push(n.y),f&&y.push(m===f?o:f[n[0]]),h&&g.push(m===h?o:h[n[0]]),d&&v.push(m===d?o:d[n[0]]),p&&x.push(m===p?o:p[n[0]]);for(const e of t)e.reduce(n)}b.push(r)}const L=i.x.scale,A=i.y.scale;return{data:n,facets:b,channels:{x:{value:k,source:a[L]?{value:G(k,a[L].invert),scale:L}:null},y:{value:$,source:a[A]?{value:G($,a[A].invert),scale:A}:null},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:x,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:"auto",label:n.label,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new Rc(t)},t.hull=function(t,e){return vc(pc,t,e)},t.identity=A,t.image=function(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=et(e,n)),new Tc(t,{...r,x:e,y:n})},t.indexOf=L,t.initializer=Ht,t.interpolateNearest=Vs,t.interpolateNone=Xs,t.interpolatorBarycentric=Us,t.interpolatorRandomWalk=Hs,t.legend=function(t={}){for(const[e,n]of po){const r=t[e];if(Q(r)){const o=Fe(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&Q(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(Jn(e,r,i),mo(o,r,t),(e=>Q(t[e])?Jn(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=rs,t.lineX=os,t.lineY=is,t.linearRegressionX=function(t,{y:e=L,x:n=A,stroke:r,fill:o=(St(r)?"currentColor":r),...i}={}){return new qc(t,Da({...i,x:n,y:e,fill:o,stroke:r}))},t.linearRegressionY=function(t,{x:e=L,y:n=A,stroke:r,fill:o=(St(r)?"currentColor":r),...i}={}){return new Yc(t,ja({...i,x:e,y:n,fill:o,stroke:r}))},t.link=Il,t.map=ks,t.mapX=ws,t.mapY=bs,t.marks=Kr,t.normalize=Qu,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),ws(Qu(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),bs(Qu(t),e)},t.plot=ma,t.pointer=io,t.pointerX=ao,t.pointerY=lo,t.raster=function(){const[t,e]=qs("fill",...arguments);return new Fs(t,null==t||void 0!==e.fill||void 0!==e.fillOpacity?e:{...e,fill:A})},t.rect=ss,t.rectX=cs,t.rectY=us,t.reverse=function({sort:t,...e}={}){return{...Jt(e,te),sort:K(t)?t:null}},t.ruleX=_o,t.ruleY=Go,t.scale=function(t={}){let e;for(const n in t)if(Dt.has(n)&&Q(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=cr(Jn(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return Lf(e);case"last":return Af(e)}if("function"==typeof t)return Of(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=Mf(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return Of(n,r,e)},t.selectFirst=Lf,t.selectLast=Af,t.selectMaxX=function(t){return Of("x",Rf,t)},t.selectMaxY=function(t){return Of("y",Rf,t)},t.selectMinX=function(t){return Of("x",Ef,t)},t.selectMinY=function(t){return Of("y",Ef,t)},t.shuffle=function({seed:t,sort:n,...r}={}){return{...Jt(r,oe(null==t?Math.random:e.randomLcg(t))),sort:K(n)?n:null}},t.sort=ee,t.sphere=function({strokeWidth:t=1.5,...e}={}){return Lc({type:"Sphere"},{strokeWidth:t,...e})},t.spike=function(t,e={}){const{shape:n=$i,stroke:r=xi.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return Ai(t,{...s,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})},t.stackX=ul,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=pl(t));const{y1:n,y:r=n,x:o}=e,[i,a,l]=yl(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=pl(t));const{y1:n,y:r=n,x:o}=e,[i,a,,l]=yl(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackY=fl,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=pl(t));const{x1:n,x:r=n,y:o}=e,[i,a,l]=yl(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=pl(t));const{x1:n,x:r=n,y:o}=e,[i,a,,l]=yl(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.text=Ko,t.textX=ti,t.textY=ei,t.tickX=Rs,t.tickY=Os,t.tip=ha,t.transform=Vt,t.tree=pu,t.treeLink=Uc,t.treeNode=Xc,t.valueof=w,t.vector=Ai,t.vectorX=zi,t.vectorY=Si,t.version="0.6.7",t.voronoi=function(t,e){return vc(mc,t,e)},t.voronoiMesh=function(t,e){return vc(yc,t,e)},t.window=uf,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),ws(uf(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),bs(uf(t),e)}}));
