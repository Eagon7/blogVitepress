!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-selection"),require("d3")):"function"==typeof define&&define.amd?define(["d3-selection","d3"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Legend=e(t.d3,t.d3)}(this,(function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,i=void 0,"symbol"==typeof(i=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"))?i:String(i)),r)}var o,i}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=function(t){try{return!!t()}catch(t){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a=!o((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),u=a,c=Function.prototype,s=c.call,l=u&&c.bind.bind(s,s),f=u?l:function(t){return function(){return s.apply(t,arguments)}},p=function(t){return null==t},d=p,h=TypeError,m=function(t){if(d(t))throw h("Can't call method on "+t);return t},g=m,y=Object,v=function(t){return y(g(t))},b=v,w=f({}.hasOwnProperty),S=Object.hasOwn||function(t,e){return w(b(t),e)},O=i,j=S,$=Function.prototype,P=O&&Object.getOwnPropertyDescriptor,T=j($,"name"),x={EXISTS:T,PROPER:T&&"something"===function(){}.name,CONFIGURABLE:T&&(!O||O&&P($,"name").configurable)},k={},M={get exports(){return k},set exports(t){k=t}},E="object"==typeof document&&document.all,R={all:E,IS_HTMLDDA:void 0===E&&void 0!==E},C=R.all,N=R.IS_HTMLDDA?function(t){return"function"==typeof t||t===C}:function(t){return"function"==typeof t},B=function(t){return t&&t.Math==Math&&t},q=B("object"==typeof globalThis&&globalThis)||B("object"==typeof window&&window)||B("object"==typeof self&&self)||B("object"==typeof r&&r)||function(){return this}()||Function("return this")(),D=q,A=Object.defineProperty,I=function(t,e){try{A(D,t,{value:e,configurable:!0,writable:!0})}catch(n){D[t]=e}return e},G=I,L="__core-js_shared__",z=q[L]||G(L,{}),F=N,Y=z,_=f(Function.toString);F(Y.inspectSource)||(Y.inspectSource=function(t){return _(t)});var U,W,H=Y.inspectSource,V=N,J=q.WeakMap,K=V(J)&&/native code/.test(String(J)),X=N,Z=R.all,Q=R.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:X(t)||t===Z}:function(t){return"object"==typeof t?null!==t:X(t)},tt={},et=Q,nt=q.document,rt=et(nt)&&et(nt.createElement),ot=function(t){return rt?nt.createElement(t):{}},it=ot,at=!i&&!o((function(){return 7!=Object.defineProperty(it("div"),"a",{get:function(){return 7}}).a})),ut=i&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ct=Q,st=String,lt=TypeError,ft=function(t){if(ct(t))return t;throw lt(st(t)+" is not an object")},pt=a,dt=Function.prototype.call,ht=pt?dt.bind(dt):function(){return dt.apply(dt,arguments)},mt=q,gt=N,yt=function(t){return gt(t)?t:void 0},vt=function(t,e){return arguments.length<2?yt(mt[t]):mt[t]&&mt[t][e]},bt=f({}.isPrototypeOf),wt="undefined"!=typeof navigator&&String(navigator.userAgent)||"",St=q,Ot=wt,jt=St.process,$t=St.Deno,Pt=jt&&jt.versions||$t&&$t.version,Tt=Pt&&Pt.v8;Tt&&(W=(U=Tt.split("."))[0]>0&&U[0]<4?1:+(U[0]+U[1])),!W&&Ot&&(!(U=Ot.match(/Edge\/(\d+)/))||U[1]>=74)&&(U=Ot.match(/Chrome\/(\d+)/))&&(W=+U[1]);var xt=W,kt=xt,Mt=o,Et=!!Object.getOwnPropertySymbols&&!Mt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&kt&&kt<41})),Rt=Et&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Ct=vt,Nt=N,Bt=bt,qt=Object,Dt=Rt?function(t){return"symbol"==typeof t}:function(t){var e=Ct("Symbol");return Nt(e)&&Bt(e.prototype,qt(t))},At=String,It=function(t){try{return At(t)}catch(t){return"Object"}},Gt=N,Lt=It,zt=TypeError,Ft=function(t){if(Gt(t))return t;throw zt(Lt(t)+" is not a function")},Yt=Ft,_t=p,Ut=function(t,e){var n=t[e];return _t(n)?void 0:Yt(n)},Wt=ht,Ht=N,Vt=Q,Jt=TypeError,Kt={},Xt=z;({get exports(){return Kt},set exports(t){Kt=t}}.exports=function(t,e){return Xt[t]||(Xt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.28.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.28.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Zt=f,Qt=0,te=Math.random(),ee=Zt(1..toString),ne=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ee(++Qt+te,36)},re=Kt,oe=S,ie=ne,ae=Et,ue=Rt,ce=q.Symbol,se=re("wks"),le=ue?ce.for||ce:ce&&ce.withoutSetter||ie,fe=function(t){return oe(se,t)||(se[t]=ae&&oe(ce,t)?ce[t]:le("Symbol."+t)),se[t]},pe=ht,de=Q,he=Dt,me=Ut,ge=function(t,e){var n,r;if("string"===e&&Ht(n=t.toString)&&!Vt(r=Wt(n,t)))return r;if(Ht(n=t.valueOf)&&!Vt(r=Wt(n,t)))return r;if("string"!==e&&Ht(n=t.toString)&&!Vt(r=Wt(n,t)))return r;throw Jt("Can't convert object to primitive value")},ye=TypeError,ve=fe("toPrimitive"),be=function(t,e){if(!de(t)||he(t))return t;var n,r=me(t,ve);if(r){if(void 0===e&&(e="default"),n=pe(r,t,e),!de(n)||he(n))return n;throw ye("Can't convert object to primitive value")}return void 0===e&&(e="number"),ge(t,e)},we=Dt,Se=function(t){var e=be(t,"string");return we(e)?e:e+""},Oe=i,je=at,$e=ut,Pe=ft,Te=Se,xe=TypeError,ke=Object.defineProperty,Me=Object.getOwnPropertyDescriptor,Ee="enumerable",Re="configurable",Ce="writable";tt.f=Oe?$e?function(t,e,n){if(Pe(t),e=Te(e),Pe(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Ce in n&&!n[Ce]){var r=Me(t,e);r&&r[Ce]&&(t[e]=n.value,n={configurable:Re in n?n[Re]:r[Re],enumerable:Ee in n?n[Ee]:r[Ee],writable:!1})}return ke(t,e,n)}:ke:function(t,e,n){if(Pe(t),e=Te(e),Pe(n),je)try{return ke(t,e,n)}catch(t){}if("get"in n||"set"in n)throw xe("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Ne,Be,qe,De=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Ae=tt,Ie=De,Ge=i?function(t,e,n){return Ae.f(t,e,Ie(1,n))}:function(t,e,n){return t[e]=n,t},Le=ne,ze=Kt("keys"),Fe={},Ye=K,_e=q,Ue=Q,We=Ge,He=S,Ve=z,Je=function(t){return ze[t]||(ze[t]=Le(t))},Ke=Fe,Xe="Object already initialized",Ze=_e.TypeError,Qe=_e.WeakMap;if(Ye||Ve.state){var tn=Ve.state||(Ve.state=new Qe);tn.get=tn.get,tn.has=tn.has,tn.set=tn.set,Ne=function(t,e){if(tn.has(t))throw Ze(Xe);return e.facade=t,tn.set(t,e),e},Be=function(t){return tn.get(t)||{}},qe=function(t){return tn.has(t)}}else{var en=Je("state");Ke[en]=!0,Ne=function(t,e){if(He(t,en))throw Ze(Xe);return e.facade=t,We(t,en,e),e},Be=function(t){return He(t,en)?t[en]:{}},qe=function(t){return He(t,en)}}var nn={set:Ne,get:Be,has:qe,enforce:function(t){return qe(t)?Be(t):Ne(t,{})},getterFor:function(t){return function(e){var n;if(!Ue(e)||(n=Be(e)).type!==t)throw Ze("Incompatible receiver, "+t+" required");return n}}},rn=f,on=o,an=N,un=S,cn=i,sn=x.CONFIGURABLE,ln=H,fn=nn.enforce,pn=nn.get,dn=String,hn=Object.defineProperty,mn=rn("".slice),gn=rn("".replace),yn=rn([].join),vn=cn&&!on((function(){return 8!==hn((function(){}),"length",{value:8}).length})),bn=String(String).split("String"),wn=M.exports=function(t,e,n){"Symbol("===mn(dn(e),0,7)&&(e="["+gn(dn(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!un(t,"name")||sn&&t.name!==e)&&(cn?hn(t,"name",{value:e,configurable:!0}):t.name=e),vn&&n&&un(n,"arity")&&t.length!==n.arity&&hn(t,"length",{value:n.arity});try{n&&un(n,"constructor")&&n.constructor?cn&&hn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=fn(t);return un(r,"source")||(r.source=yn(bn,"string"==typeof e?e:"")),t};Function.prototype.toString=wn((function(){return an(this)&&pn(this).source||ln(this)}),"toString");var Sn=k,On=tt,jn=function(t,e,n){return n.get&&Sn(n.get,e,{getter:!0}),n.set&&Sn(n.set,e,{setter:!0}),On.f(t,e,n)},$n=i,Pn=x.EXISTS,Tn=f,xn=jn,kn=Function.prototype,Mn=Tn(kn.toString),En=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Rn=Tn(En.exec);$n&&!Pn&&xn(kn,"name",{configurable:!0,get:function(){try{return Rn(En,Mn(this))[1]}catch(t){return""}}});var Cn={},Nn={},Bn={}.propertyIsEnumerable,qn=Object.getOwnPropertyDescriptor,Dn=qn&&!Bn.call({1:2},1);Nn.f=Dn?function(t){var e=qn(this,t);return!!e&&e.enumerable}:Bn;var An=f,In=An({}.toString),Gn=An("".slice),Ln=function(t){return Gn(In(t),8,-1)},zn=o,Fn=Ln,Yn=Object,_n=f("".split),Un=zn((function(){return!Yn("z").propertyIsEnumerable(0)}))?function(t){return"String"==Fn(t)?_n(t,""):Yn(t)}:Yn,Wn=Un,Hn=m,Vn=function(t){return Wn(Hn(t))},Jn=i,Kn=ht,Xn=Nn,Zn=De,Qn=Vn,tr=Se,er=S,nr=at,rr=Object.getOwnPropertyDescriptor;Cn.f=Jn?rr:function(t,e){if(t=Qn(t),e=tr(e),nr)try{return rr(t,e)}catch(t){}if(er(t,e))return Zn(!Kn(Xn.f,t,e),t[e])};var or=N,ir=tt,ar=k,ur=I,cr=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(or(n)&&ar(n,i,r),r.global)o?t[e]=n:ur(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:ir.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},sr={},lr=Math.ceil,fr=Math.floor,pr=Math.trunc||function(t){var e=+t;return(e>0?fr:lr)(e)},dr=function(t){var e=+t;return e!=e||0===e?0:pr(e)},hr=dr,mr=Math.max,gr=Math.min,yr=dr,vr=Math.min,br=function(t){return t>0?vr(yr(t),9007199254740991):0},wr=function(t){return br(t.length)},Sr=Vn,Or=function(t,e){var n=hr(t);return n<0?mr(n+e,0):gr(n,e)},jr=wr,$r=function(t){return function(e,n,r){var o,i=Sr(e),a=jr(i),u=Or(r,a);if(t&&n!=n){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===n)return t||u||0;return!t&&-1}},Pr={includes:$r(!0),indexOf:$r(!1)},Tr=S,xr=Vn,kr=Pr.indexOf,Mr=Fe,Er=f([].push),Rr=function(t,e){var n,r=xr(t),o=0,i=[];for(n in r)!Tr(Mr,n)&&Tr(r,n)&&Er(i,n);for(;e.length>o;)Tr(r,n=e[o++])&&(~kr(i,n)||Er(i,n));return i},Cr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Nr=Rr,Br=Cr.concat("length","prototype");sr.f=Object.getOwnPropertyNames||function(t){return Nr(t,Br)};var qr={};qr.f=Object.getOwnPropertySymbols;var Dr=vt,Ar=sr,Ir=qr,Gr=ft,Lr=f([].concat),zr=Dr("Reflect","ownKeys")||function(t){var e=Ar.f(Gr(t)),n=Ir.f;return n?Lr(e,n(t)):e},Fr=S,Yr=zr,_r=Cn,Ur=tt,Wr=o,Hr=N,Vr=/#|\.prototype\./,Jr=function(t,e){var n=Xr[Kr(t)];return n==Qr||n!=Zr&&(Hr(e)?Wr(e):!!e)},Kr=Jr.normalize=function(t){return String(t).replace(Vr,".").toLowerCase()},Xr=Jr.data={},Zr=Jr.NATIVE="N",Qr=Jr.POLYFILL="P",to=Jr,eo=q,no=Cn.f,ro=Ge,oo=cr,io=I,ao=function(t,e,n){for(var r=Yr(e),o=Ur.f,i=_r.f,a=0;a<r.length;a++){var u=r[a];Fr(t,u)||n&&Fr(n,u)||o(t,u,i(e,u))}},uo=to,co=function(t,e){var n,r,o,i,a,u=t.target,c=t.global,s=t.stat;if(n=c?eo:s?eo[u]||io(u,{}):(eo[u]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=no(n,r))&&a.value:n[r],!uo(c?r:u+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;ao(i,o)}(t.sham||o&&o.sham)&&ro(i,"sham",!0),oo(n,r,i,t)}},so=Rr,lo=Cr,fo=Object.keys||function(t){return so(t,lo)},po=i,ho=f,mo=ht,go=o,yo=fo,vo=qr,bo=Nn,wo=v,So=Un,Oo=Object.assign,jo=Object.defineProperty,$o=ho([].concat),Po=!Oo||go((function(){if(po&&1!==Oo({b:1},Oo(jo({},"a",{enumerable:!0,get:function(){jo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=Oo({},t)[n]||yo(Oo({},e)).join("")!=r}))?function(t,e){for(var n=wo(t),r=arguments.length,o=1,i=vo.f,a=bo.f;r>o;)for(var u,c=So(arguments[o++]),s=i?$o(yo(c),i(c)):yo(c),l=s.length,f=0;l>f;)u=s[f++],po&&!mo(a,c,u)||(n[u]=c[u]);return n}:Oo,To=Po;co({target:"Object",stat:!0,arity:2,forced:Object.assign!==To},{assign:To});var xo={};xo[fe("toStringTag")]="z";var ko="[object z]"===String(xo),Mo=ko,Eo=N,Ro=Ln,Co=fe("toStringTag"),No=Object,Bo="Arguments"==Ro(function(){return arguments}()),qo=Mo?Ro:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=No(t),Co))?n:Bo?Ro(e):"Object"==(r=Ro(e))&&Eo(e.callee)?"Arguments":r},Do=qo,Ao=ko?{}.toString:function(){return"[object "+Do(this)+"]"};ko||cr(Object.prototype,"toString",Ao,{unsafe:!0});var Io="undefined"!=typeof process&&"process"==Ln(process),Go=f,Lo=Ft,zo=N,Fo=String,Yo=TypeError,_o=function(t,e,n){try{return Go(Lo(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}},Uo=ft,Wo=function(t){if("object"==typeof t||zo(t))return t;throw Yo("Can't set "+Fo(t)+" as a prototype")},Ho=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=_o(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Uo(n),Wo(r),e?t(n,r):n.__proto__=r,n}}():void 0),Vo=tt.f,Jo=S,Ko=fe("toStringTag"),Xo=vt,Zo=jn,Qo=i,ti=fe("species"),ei=bt,ni=TypeError,ri=f,oi=o,ii=N,ai=qo,ui=H,ci=function(){},si=[],li=vt("Reflect","construct"),fi=/^\s*(?:class|function)\b/,pi=ri(fi.exec),di=!fi.exec(ci),hi=function(t){if(!ii(t))return!1;try{return li(ci,si,t),!0}catch(t){return!1}},mi=function(t){if(!ii(t))return!1;switch(ai(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return di||!!pi(fi,ui(t))}catch(t){return!0}};mi.sham=!0;var gi,yi,vi,bi,wi=!li||oi((function(){var t;return hi(hi.call)||!hi(Object)||!hi((function(){t=!0}))||t}))?mi:hi,Si=wi,Oi=It,ji=TypeError,$i=ft,Pi=function(t){if(Si(t))return t;throw ji(Oi(t)+" is not a constructor")},Ti=p,xi=fe("species"),ki=a,Mi=Function.prototype,Ei=Mi.apply,Ri=Mi.call,Ci="object"==typeof Reflect&&Reflect.apply||(ki?Ri.bind(Ei):function(){return Ri.apply(Ei,arguments)}),Ni=Ln,Bi=f,qi=function(t){if("Function"===Ni(t))return Bi(t)},Di=Ft,Ai=a,Ii=qi(qi.bind),Gi=function(t,e){return Di(t),void 0===e?t:Ai?Ii(t,e):function(){return t.apply(e,arguments)}},Li=vt("document","documentElement"),zi=f([].slice),Fi=TypeError,Yi=/(?:ipad|iphone|ipod).*applewebkit/i.test(wt),_i=q,Ui=Ci,Wi=Gi,Hi=N,Vi=S,Ji=o,Ki=Li,Xi=zi,Zi=ot,Qi=function(t,e){if(t<e)throw Fi("Not enough arguments");return t},ta=Yi,ea=Io,na=_i.setImmediate,ra=_i.clearImmediate,oa=_i.process,ia=_i.Dispatch,aa=_i.Function,ua=_i.MessageChannel,ca=_i.String,sa=0,la={},fa="onreadystatechange";Ji((function(){gi=_i.location}));var pa=function(t){if(Vi(la,t)){var e=la[t];delete la[t],e()}},da=function(t){return function(){pa(t)}},ha=function(t){pa(t.data)},ma=function(t){_i.postMessage(ca(t),gi.protocol+"//"+gi.host)};na&&ra||(na=function(t){Qi(arguments.length,1);var e=Hi(t)?t:aa(t),n=Xi(arguments,1);return la[++sa]=function(){Ui(e,void 0,n)},yi(sa),sa},ra=function(t){delete la[t]},ea?yi=function(t){oa.nextTick(da(t))}:ia&&ia.now?yi=function(t){ia.now(da(t))}:ua&&!ta?(bi=(vi=new ua).port2,vi.port1.onmessage=ha,yi=Wi(bi.postMessage,bi)):_i.addEventListener&&Hi(_i.postMessage)&&!_i.importScripts&&gi&&"file:"!==gi.protocol&&!Ji(ma)?(yi=ma,_i.addEventListener("message",ha,!1)):yi=fa in Zi("script")?function(t){Ki.appendChild(Zi("script"))[fa]=function(){Ki.removeChild(this),pa(t)}}:function(t){setTimeout(da(t),0)});var ga={set:na,clear:ra},ya=function(){this.head=null,this.tail=null};ya.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var va,ba,wa,Sa,Oa,ja=ya,$a=/ipad|iphone|ipod/i.test(wt)&&"undefined"!=typeof Pebble,Pa=/web0s(?!.*chrome)/i.test(wt),Ta=q,xa=Gi,ka=Cn.f,Ma=ga.set,Ea=ja,Ra=Yi,Ca=$a,Na=Pa,Ba=Io,qa=Ta.MutationObserver||Ta.WebKitMutationObserver,Da=Ta.document,Aa=Ta.process,Ia=Ta.Promise,Ga=ka(Ta,"queueMicrotask"),La=Ga&&Ga.value;if(!La){var za=new Ea,Fa=function(){var t,e;for(Ba&&(t=Aa.domain)&&t.exit();e=za.get();)try{e()}catch(t){throw za.head&&va(),t}t&&t.enter()};Ra||Ba||Na||!qa||!Da?!Ca&&Ia&&Ia.resolve?((Sa=Ia.resolve(void 0)).constructor=Ia,Oa=xa(Sa.then,Sa),va=function(){Oa(Fa)}):Ba?va=function(){Aa.nextTick(Fa)}:(Ma=xa(Ma,Ta),va=function(){Ma(Fa)}):(ba=!0,wa=Da.createTextNode(""),new qa(Fa).observe(wa,{characterData:!0}),va=function(){wa.data=ba=!ba}),La=function(t){za.head||va(),za.add(t)}}var Ya=La,_a=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Ua=q.Promise,Wa="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Ha=!Wa&&!Io&&"object"==typeof window&&"object"==typeof document,Va=q,Ja=Ua,Ka=N,Xa=to,Za=H,Qa=fe,tu=Ha,eu=Wa,nu=xt;Ja&&Ja.prototype;var ru=Qa("species"),ou=!1,iu=Ka(Va.PromiseRejectionEvent),au=Xa("Promise",(function(){var t=Za(Ja),e=t!==String(Ja);if(!e&&66===nu)return!0;if(!nu||nu<51||!/native code/.test(t)){var n=new Ja((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[ru]=r,!(ou=n.then((function(){}))instanceof r))return!0}return!e&&(tu||eu)&&!iu})),uu={CONSTRUCTOR:au,REJECTION_EVENT:iu,SUBCLASSING:ou},cu={},su=Ft,lu=TypeError,fu=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw lu("Bad Promise constructor");e=t,n=r})),this.resolve=su(e),this.reject=su(n)};cu.f=function(t){return new fu(t)};var pu,du,hu,mu=co,gu=Io,yu=q,vu=ht,bu=cr,wu=Ho,Su=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Jo(t,Ko)&&Vo(t,Ko,{configurable:!0,value:e})},Ou=function(t){var e=Xo(t);Qo&&e&&!e[ti]&&Zo(e,ti,{configurable:!0,get:function(){return this}})},ju=Ft,$u=N,Pu=Q,Tu=function(t,e){if(ei(e,t))return t;throw ni("Incorrect invocation")},xu=function(t,e){var n,r=$i(t).constructor;return void 0===r||Ti(n=$i(r)[xi])?e:Pi(n)},ku=ga.set,Mu=Ya,Eu=function(t,e){try{1==arguments.length?console.error(t):console.error(t,e)}catch(t){}},Ru=_a,Cu=ja,Nu=nn,Bu=Ua,qu=cu,Du="Promise",Au=uu.CONSTRUCTOR,Iu=uu.REJECTION_EVENT,Gu=uu.SUBCLASSING,Lu=Nu.getterFor(Du),zu=Nu.set,Fu=Bu&&Bu.prototype,Yu=Bu,_u=Fu,Uu=yu.TypeError,Wu=yu.document,Hu=yu.process,Vu=qu.f,Ju=Vu,Ku=!!(Wu&&Wu.createEvent&&yu.dispatchEvent),Xu="unhandledrejection",Zu=function(t){var e;return!(!Pu(t)||!$u(e=t.then))&&e},Qu=function(t,e){var n,r,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,c=t.resolve,s=t.reject,l=t.domain;try{u?(a||(2===e.rejection&&oc(e),e.rejection=1),!0===u?n=i:(l&&l.enter(),n=u(i),l&&(l.exit(),o=!0)),n===t.promise?s(Uu("Promise-chain cycle")):(r=Zu(n))?vu(r,n,c,s):c(n)):s(i)}catch(t){l&&!o&&l.exit(),s(t)}},tc=function(t,e){t.notified||(t.notified=!0,Mu((function(){for(var n,r=t.reactions;n=r.get();)Qu(n,t);t.notified=!1,e&&!t.rejection&&nc(t)})))},ec=function(t,e,n){var r,o;Ku?((r=Wu.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),yu.dispatchEvent(r)):r={promise:e,reason:n},!Iu&&(o=yu["on"+t])?o(r):t===Xu&&Eu("Unhandled promise rejection",n)},nc=function(t){vu(ku,yu,(function(){var e,n=t.facade,r=t.value;if(rc(t)&&(e=Ru((function(){gu?Hu.emit("unhandledRejection",r,n):ec(Xu,n,r)})),t.rejection=gu||rc(t)?2:1,e.error))throw e.value}))},rc=function(t){return 1!==t.rejection&&!t.parent},oc=function(t){vu(ku,yu,(function(){var e=t.facade;gu?Hu.emit("rejectionHandled",e):ec("rejectionhandled",e,t.value)}))},ic=function(t,e,n){return function(r){t(e,r,n)}},ac=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,tc(t,!0))},uc=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw Uu("Promise can't be resolved itself");var r=Zu(e);r?Mu((function(){var n={done:!1};try{vu(r,e,ic(uc,n,t),ic(ac,n,t))}catch(e){ac(n,e,t)}})):(t.value=e,t.state=1,tc(t,!1))}catch(e){ac({done:!1},e,t)}}};if(Au&&(_u=(Yu=function(t){Tu(this,_u),ju(t),vu(pu,this);var e=Lu(this);try{t(ic(uc,e),ic(ac,e))}catch(t){ac(e,t)}}).prototype,(pu=function(t){zu(this,{type:Du,done:!1,notified:!1,parent:!1,reactions:new Cu,rejection:!1,state:0,value:void 0})}).prototype=bu(_u,"then",(function(t,e){var n=Lu(this),r=Vu(xu(this,Yu));return n.parent=!0,r.ok=!$u(t)||t,r.fail=$u(e)&&e,r.domain=gu?Hu.domain:void 0,0==n.state?n.reactions.add(r):Mu((function(){Qu(r,n)})),r.promise})),du=function(){var t=new pu,e=Lu(t);this.promise=t,this.resolve=ic(uc,e),this.reject=ic(ac,e)},qu.f=Vu=function(t){return t===Yu||undefined===t?new du(t):Ju(t)},$u(Bu)&&Fu!==Object.prototype)){hu=Fu.then,Gu||bu(Fu,"then",(function(t,e){var n=this;return new Yu((function(t,e){vu(hu,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete Fu.constructor}catch(t){}wu&&wu(Fu,_u)}mu({global:!0,constructor:!0,wrap:!0,forced:Au},{Promise:Yu}),Su(Yu,Du,!1),Ou(Du);var cc={},sc=cc,lc=fe("iterator"),fc=Array.prototype,pc=qo,dc=Ut,hc=p,mc=cc,gc=fe("iterator"),yc=function(t){if(!hc(t))return dc(t,gc)||dc(t,"@@iterator")||mc[pc(t)]},vc=ht,bc=Ft,wc=ft,Sc=It,Oc=yc,jc=TypeError,$c=ht,Pc=ft,Tc=Ut,xc=Gi,kc=ht,Mc=ft,Ec=It,Rc=function(t){return void 0!==t&&(sc.Array===t||fc[lc]===t)},Cc=wr,Nc=bt,Bc=function(t,e){var n=arguments.length<2?Oc(t):e;if(bc(n))return wc(vc(n,t));throw jc(Sc(t)+" is not iterable")},qc=yc,Dc=function(t,e,n){var r,o;Pc(t);try{if(!(r=Tc(t,"return"))){if("throw"===e)throw n;return n}r=$c(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return Pc(r),n},Ac=TypeError,Ic=function(t,e){this.stopped=t,this.result=e},Gc=Ic.prototype,Lc=function(t,e,n){var r,o,i,a,u,c,s,l=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_RECORD),d=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),m=xc(e,l),g=function(t){return r&&Dc(r,"normal",t),new Ic(!0,t)},y=function(t){return f?(Mc(t),h?m(t[0],t[1],g):m(t[0],t[1])):h?m(t,g):m(t)};if(p)r=t.iterator;else if(d)r=t;else{if(!(o=qc(t)))throw Ac(Ec(t)+" is not iterable");if(Rc(o)){for(i=0,a=Cc(t);a>i;i++)if((u=y(t[i]))&&Nc(Gc,u))return u;return new Ic(!1)}r=Bc(t,o)}for(c=p?t.next:r.next;!(s=kc(c,r)).done;){try{u=y(s.value)}catch(t){Dc(r,"throw",t)}if("object"==typeof u&&u&&Nc(Gc,u))return u}return new Ic(!1)},zc=fe("iterator"),Fc=!1;try{var Yc=0,_c={next:function(){return{done:!!Yc++}},return:function(){Fc=!0}};_c[zc]=function(){return this},Array.from(_c,(function(){throw 2}))}catch(t){}var Uc=Ua,Wc=function(t,e){if(!e&&!Fc)return!1;var n=!1;try{var r={};r[zc]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},Hc=uu.CONSTRUCTOR||!Wc((function(t){Uc.all(t).then(void 0,(function(){}))})),Vc=ht,Jc=Ft,Kc=cu,Xc=_a,Zc=Lc;co({target:"Promise",stat:!0,forced:Hc},{all:function(t){var e=this,n=Kc.f(e),r=n.resolve,o=n.reject,i=Xc((function(){var n=Jc(e.resolve),i=[],a=0,u=1;Zc(t,(function(t){var c=a++,s=!1;u++,Vc(n,e,t).then((function(t){s||(s=!0,i[c]=t,--u||r(i))}),o)})),--u||r(i)}));return i.error&&o(i.value),n.promise}});var Qc=co,ts=uu.CONSTRUCTOR,es=Ua,ns=vt,rs=N,os=cr,is=es&&es.prototype;if(Qc({target:"Promise",proto:!0,forced:ts,real:!0},{catch:function(t){return this.then(void 0,t)}}),rs(es)){var as=ns("Promise").prototype.catch;is.catch!==as&&os(is,"catch",as,{unsafe:!0})}var us=ht,cs=Ft,ss=cu,ls=_a,fs=Lc;co({target:"Promise",stat:!0,forced:Hc},{race:function(t){var e=this,n=ss.f(e),r=n.reject,o=ls((function(){var o=cs(e.resolve);fs(t,(function(t){us(o,e,t).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var ps=ht,ds=cu;co({target:"Promise",stat:!0,forced:uu.CONSTRUCTOR},{reject:function(t){var e=ds.f(this);return ps(e.reject,void 0,t),e.promise}});var hs=ft,ms=Q,gs=cu,ys=co,vs=uu.CONSTRUCTOR,bs=function(t,e){if(hs(t),ms(e)&&e.constructor===t)return e;var n=gs.f(t);return(0,n.resolve)(e),n.promise};function ws(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${Ss(-a,6)}`:a>9999?`+${Ss(a,6)}`:Ss(a,4)}-${Ss(t.getUTCMonth()+1,2)}-${Ss(t.getUTCDate(),2)}${n||r||o||i?`T${Ss(n,2)}:${Ss(r,2)}${o||i?`:${Ss(o,2)}${i?`.${Ss(i,3)}`:""}`:""}Z`:""}`;var a}function Ss(t,e){return`${t}`.padStart(e,"0")}vt("Promise"),ys({target:"Promise",stat:!0,forced:vs},{resolve:function(t){return bs(this,t)}});const Os=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function js(t,e){return Os.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const $s=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["week",e.timeWeek],["month",e.timeMonth],["year",e.timeYear],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday]]),Ps=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.utcDay],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);function Ts(t){const e=$s.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}function xs(t){const e=Ps.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}const ks=Object.getPrototypeOf(Uint8Array),Ms=Object.prototype.toString,Es=t=>null==t?t:`${t}`,Rs=t=>()=>t;function Cs(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:Us(t)?[void 0,t]:[t,void 0]}function Ns(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function Bs(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof ks?t:Array.from(t):t instanceof e?t:e.from(t)}function qs(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function Ds(t){return t?.toString===Ms}function As(t){return Ds(t)&&(void 0!==t.type||void 0!==t.domain)}function Is(t,n){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("string"==typeof t)return("time"===n?Ts:xs)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Gs(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Ls(t){for(const e of t)if(null!=e)return e instanceof Date}function zs(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&js(e)}function Fs(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function Ys(t,e){for(const n of t)if(null!=n)return e(n)}function _s(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function Us(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function Ws(t){return null==t||function(t){return/^\s*none\s*$/i.test(t)}(t)}function Hs(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}const Vs=Symbol("position"),Js=Symbol("color"),Ks=Symbol("radius"),Xs=Symbol("length"),Zs=Symbol("opacity"),Qs=Symbol("symbol"),tl=new Map([["x",Vs],["y",Vs],["fx",Vs],["fy",Vs],["r",Ks],["color",Js],["opacity",Zs],["symbol",Qs],["length",Xs]]);function el(t){return null!=t&&!Number.isNaN(t)}function nl(t,n){return+el(n)-+el(t)||e.ascending(t,n)}function rl(t){return isFinite(t)?t:NaN}function ol(t){return t>0&&isFinite(t)?t:NaN}function il(t){return t<0&&isFinite(t)?t:NaN}const al=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",cl(e.schemeBrBG,e.interpolateBrBG)],["prgn",cl(e.schemePRGn,e.interpolatePRGn)],["piyg",cl(e.schemePiYG,e.interpolatePiYG)],["puor",cl(e.schemePuOr,e.interpolatePuOr)],["rdbu",cl(e.schemeRdBu,e.interpolateRdBu)],["rdgy",cl(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",cl(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",cl(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",cl(e.schemeSpectral,e.interpolateSpectral)],["burd",sl(e.schemeRdBu,e.interpolateRdBu)],["buylrd",sl(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",ul(e.schemeBlues,e.interpolateBlues)],["greens",ul(e.schemeGreens,e.interpolateGreens)],["greys",ul(e.schemeGreys,e.interpolateGreys)],["oranges",ul(e.schemeOranges,e.interpolateOranges)],["purples",ul(e.schemePurples,e.interpolatePurples)],["reds",ul(e.schemeReds,e.interpolateReds)],["turbo",ll(e.interpolateTurbo)],["viridis",ll(e.interpolateViridis)],["magma",ll(e.interpolateMagma)],["inferno",ll(e.interpolateInferno)],["plasma",ll(e.interpolatePlasma)],["cividis",ll(e.interpolateCividis)],["cubehelix",ll(e.interpolateCubehelixDefault)],["warm",ll(e.interpolateWarm)],["cool",ll(e.interpolateCool)],["bugn",ul(e.schemeBuGn,e.interpolateBuGn)],["bupu",ul(e.schemeBuPu,e.interpolateBuPu)],["gnbu",ul(e.schemeGnBu,e.interpolateGnBu)],["orrd",ul(e.schemeOrRd,e.interpolateOrRd)],["pubu",ul(e.schemePuBu,e.interpolatePuBu)],["pubugn",ul(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",ul(e.schemePuRd,e.interpolatePuRd)],["rdpu",ul(e.schemeRdPu,e.interpolateRdPu)],["ylgn",ul(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",ul(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",ul(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",ul(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",fl(e.interpolateRainbow)],["sinebow",fl(e.interpolateSinebow)]]);function ul(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function cl(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function sl(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function ll(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function fl(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function pl(t){const e=`${t}`.toLowerCase();if(!al.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return al.get(e)}function dl(t,e){const n=pl(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const hl=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function ml(t){const e=`${t}`.toLowerCase();if(!hl.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return hl.get(e)}const gl=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function yl(t){return null!=t&&gl.has(`${t}`.toLowerCase())}const vl=t=>e=>t(1-e),bl=[0,1],wl=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function Sl(t){const e=`${t}`.toLowerCase();if(!wl.has(e))throw new Error(`unknown interpolator: ${e}`);return wl.get(e)}function Ol(t,n,r,{type:o,nice:i,clamp:a,zero:u,domain:c=Tl(t,r),unknown:s,round:l,scheme:f,interval:p,range:d=(tl.get(t)===Ks?kl(r,c):tl.get(t)===Xs?Ml(r,c):tl.get(t)===Zs?bl:void 0),interpolate:h=(tl.get(t)===Js?null==f&&void 0!==d?e.interpolateRgb:ml(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):l?e.interpolateRound:e.interpolateNumber),reverse:m}){if(p=Is(p,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),m=!!m,"function"!=typeof h&&(h=Sl(h)),1===h.length?(m&&(h=vl(h),m=!1),void 0===d&&2===(d=Float64Array.from(c,((t,e)=>e/(c.length-1)))).length&&(d=bl),n.interpolate((d===bl?Rs:Cl)(h))):n.interpolate(h),u){const[t,n]=e.extent(c);(t>0||n<0)&&(c=function(t,e=Array){return t instanceof e?t.slice():e.from(t)}(c),Hs(c)!==Math.sign(t)?c[c.length-1]=0:c[0]=0)}return m&&(c=e.reverse(c)),n.domain(c).unknown(s),i&&(n.nice(!0===i?void 0:i),c=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:c,range:d,scale:n,interpolate:h,interval:p}}function jl(t,n,{exponent:r=1,...o}){return Ol(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function $l(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:u=(void 0!==a?e.quantize(a,r.length+1):tl.get(t)===Js?dl(i,r.length+1):void 0),reverse:c}){const s=Hs(Bs(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const o=e.descending(t,n);return 0===o||o===r}(t,n,s))))throw new Error(`the ${t} scale has a non-monotonic domain`);return c&&(u=e.reverse(u)),{type:"threshold",scale:e.scaleThreshold(s<0?e.reverse(r):r,void 0===u?[]:u).unknown(o),domain:r,range:u}}function Pl(t,n=rl){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function Tl(t,e){const n=tl.get(t);return(n===Ks||n===Zs||n===Xs?xl:Pl)(e)}function xl(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,rl))):1]}function kl(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,ol))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function Ml(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function El(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return Pl(t,ol);if(n<0)return Pl(t,il)}return[1,10]}function Rl(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function Cl(t){return(e,n)=>r=>t(e+r*(n-e))}function Nl(t,n,r,o,{type:i,nice:a,clamp:u,domain:c=Pl(o),unknown:s,pivot:l=0,scheme:f,range:p,symmetric:d=!0,interpolate:h=(tl.get(t)===Js?null==f&&void 0!==p?e.interpolateRgb:ml(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){l=+l;let[g,y]=c;if(e.descending(g,y)<0&&([g,y]=[y,g],m=!m),g=Math.min(g,l),y=Math.max(y,l),"function"!=typeof h&&(h=Sl(h)),void 0!==p&&(h=1===h.length?Cl(h)(...p):e.piecewise(h,p)),m&&(h=vl(h)),d){const t=r.apply(l),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,l,y]).unknown(s).interpolator(h),u&&n.clamp(u),a&&n.nice(a),{type:i,domain:[g,y],pivot:l,interpolate:h,scale:n}}function Bl(t,n,{exponent:r=1,...o}){return Nl(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Il:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function ql(t,n,{constant:r=1,...o}){return Nl(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Dl={apply:t=>t,invert:t=>t},Al={apply:Math.log,invert:Math.exp},Il={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Gl(t,e,n,r){return Ol(t,e,n,r)}const Ll=2/Math.sqrt(3),zl={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*Ll,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},Fl=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",zl],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function Yl(t){return t&&"function"==typeof t.draw}function _l(t){return!!Yl(t)||"string"==typeof t&&Fl.has(t.toLowerCase())}function Ul(t){if(null==t||Yl(t))return t;const e=Fl.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const Wl=Symbol("ordinal");function Hl(t,n,r,{type:o,interval:i,domain:a,range:u,reverse:c,hint:s}){return i=Is(i,o),void 0===a&&(a=Kl(r,i,t)),"categorical"!==o&&o!==Wl||(o="ordinal"),c&&(a=e.reverse(a)),n.domain(a),void 0!==u&&("function"==typeof u&&(u=u(a)),n.range(u)),{type:o,domain:a,range:u,scale:n,hint:s,interval:i}}function Vl(t,n,{type:r,interval:o,domain:i,range:a,scheme:u,unknown:c,...s}){let l;if(o=Is(o,r),void 0===i&&(i=Kl(n,o,t)),tl.get(t)===Qs)l=function(t){return{fill:Xl(t,"fill"),stroke:Xl(t,"stroke")}}(n),a=void 0===a?function(t){return Ws(t.fill)?e.symbolsStroke:e.symbolsFill}(l):qs(a,Ul);else if(tl.get(t)===Js&&(void 0!==a||"ordinal"!==r&&r!==Wl||(a=function(t,e="greys"){const n=new Set,[r,o]=dl(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,u),void 0!==a&&(u=void 0)),void 0===u&&void 0===a&&(u="ordinal"===r?"turbo":"tableau10"),void 0!==u))if(void 0!==a){const t=ml(u),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=pl(u);if(c===e.scaleImplicit)throw new Error("implicit unknown is not supported");return Hl(t,e.scaleOrdinal().unknown(c),n,{...s,type:r,domain:i,range:a,hint:l})}function Jl(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=Hl(r,t,e,n)).round=o,t}function Kl(t,n,r){const o=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)o.add(t)}if(void 0!==n){const[t,r]=e.extent(o).map(n.floor,n);return n.range(t,n.offset(r))}if(o.size>1e4&&tl.get(r)===Vs)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(o,nl)}function Xl(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Zl(t){console.warn(t)}function Ql(t,n,r){return function(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:u}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==u||(n=ef);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===ef)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const c=tl.get(t);if(c===Js&&void 0===o&&void 0===i&&rf(r,e,Us))return"identity";if(c===Qs&&void 0===o&&rf(r,e,_l))return"identity";if(c===Ks)return"sqrt";if(c===Zs||c===Xs)return"linear";if(c===Qs)return"ordinal";if((r||o||[]).length>2)return nf(c);if(void 0!==r)return Gs(r)?nf(c):Ls(r)?"utc":c!==Js||null==a&&!yl(i)?"linear":"diverging";const s=e.map((({value:t})=>t)).filter((t=>void 0!==t));return s.some(Gs)?nf(c):s.some(Ls)?"utc":c!==Js||null==a&&!yl(i)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&of({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Ls)?Zl(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${tf(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${tf(o)}".`):e.some(zs)?Zl(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${tf(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${tf(o)}".`):e.some(Fs)&&Zl(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${tf(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${tf(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=af(n,r,sf);break;case"identity":switch(tl.get(t)){case Vs:r=af(n,r,sf);break;case Qs:r=af(n,r,uf)}break;case"utc":case"time":r=af(n,r,cf)}switch(o){case"diverging":return function(t,n,r){return Nl(t,e.scaleDiverging(),Dl,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Bl(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Bl(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=Pl(n,o<0?il:ol),...a}){return Nl(t,e.scaleDivergingLog().base(r=+r),Al,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return ql(t,n,r);case"categorical":case"ordinal":case Wl:return Vl(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return Ol(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return jl(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return $l(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:u=Rl(n),interpolate:c,reverse:s}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):tl.get(t)===Js?dl(a,i):void 0),u.length>0&&(u=e.scaleQuantile(u,void 0===r?{length:i}:r).quantiles()),$l(t,0,{domain:u,range:r,reverse:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=Tl(t,n),unknown:u,interpolate:c,reverse:s}){const[l,f]=e.extent(a);let p;return void 0===r?(p=e.ticks(l,f,o),p[0]<=l&&p.splice(0,1),p[p.length-1]>=f&&p.pop(),o=p.length+1,r=void 0!==c?e.quantize(c,o):tl.get(t)===Js?dl(i,o):void 0):(p=e.quantize(e.interpolateNumber(l,f),o+1).slice(1,-1),l instanceof Date&&(p=p.map((t=>new Date(t))))),Hs(Bs(a))<0&&p.reverse(),$l(t,0,{domain:p,range:r,reverse:s,unknown:u})}(t,n,r);case"pow":return jl(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=El(n),...i}){return Ol(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return Ol(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return Gl(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Gl(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return Jl(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...u}){return Jl(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,u,t)}(t,n,r);case"identity":return tl.get(t)===Vs?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}(t,void 0===r?void 0:[{hint:r}],{...n})}function tf(t){return"symbol"==typeof t?t.description:t}const ef={toString:()=>"projection"};function nf(t){switch(t){case Vs:return"point";case Js:return Wl;default:return"ordinal"}}function rf(t,e,n){return void 0!==t?Ys(t,n)&&_s(t,n):e.some((({value:t})=>void 0!==t&&Ys(t,n)))&&e.every((({value:t})=>void 0===t||_s(t,n)))}function of({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Wl}function af(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function uf(t){return qs(t,Ul)}function cf(t){return qs(t,ff)}function sf(t){return function(t){return t instanceof ks}(t)?t:qs(t,lf,Float64Array)}function lf(t){return null==t?NaN:+t}function ff(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?js(t):null==t||isNaN(t=+t)?void 0:new Date(t)}const pf=Math.PI,df=2*pf;function hf({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},u){if(null==t)return;if("function"==typeof t.stream)return t;let c,s,l="frame";if(Ds(t)){let e;if(({type:t,domain:s,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:l=l,...c}=t),null==t)return}"function"!=typeof t&&({type:t}=function(t){switch(`${t}`.toLowerCase()){case"albers-usa":return mf(e.geoAlbersUsa,.7463,.4673);case"albers":return gf(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return mf(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return mf(e.geoAzimuthalEquidistant,df,df);case"conic-conformal":return gf(e.geoConicConformal,df,df);case"conic-equal-area":return gf(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return gf(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return mf(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return mf(e.geoEquirectangular,df,pf);case"gnomonic":return mf(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:yf};case"reflect-y":return{type:vf};case"mercator":return mf(e.geoMercator,df,df);case"orthographic":return mf(e.geoOrthographic,2,2);case"stereographic":return mf(e.geoStereographic,2,2);case"transverse-mercator":return mf(e.geoTransverseMercator,df,df);default:throw new Error(`unknown projection type: ${t}`)}}(t));const{width:f,height:p,marginLeft:d,marginRight:h,marginTop:m,marginBottom:g}=u,y=f-d-h-a-o,v=p-m-g-r-i;if(t=t?.({width:y,height:v,clip:l,...c}),null==t)return;l=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(l,d,m,f-h,p-g);let b,w=d+a,S=m+r;if(null!=s){const[[n,r],[o,i]]=e.geoPath(t).bounds(s),a=Math.min(y/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-y)/2,S-=(a*(r+i)-v)/2,b=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+S)}})):Zl("Warning: the projection could not be fit to the specified domain; using the default scale.")}return b??=0===w&&0===S?yf():e.geoTransform({point(t,e){this.stream.point(t+w,e+S)}}),{stream:e=>t.stream(b.stream(l(e)))}}function mf(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:u})=>{const c=t();return null!=a&&c.precision?.(a),null!=i&&c.rotate?.(i),"number"==typeof u&&c.clipAngle?.(u),c.scale(Math.min(r/e,o/n)),c.translate([r/2,o/2]),c},aspectRatio:n/e}}function gf(t,e,n){const{type:r,aspectRatio:o}=mf(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const yf=Rs({stream:t=>t}),vf=Rs(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function bf(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:hf(t,e)}}function wf(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}const Sf=function(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}((t=>new Intl.NumberFormat(t)));function Of(t){return ws(t,"Invalid Date")}function jf(t,e){if((t=Es(t))!==e)return t}!function(t="en-US"){const e=function(t="en-US"){const e=Sf(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t)}();const $f=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function Pf(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!$f.test(t))throw new Error(`invalid class name: ${t}`);return t}function Tf(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function xf(t){return of(t)&&void 0===t.interval?void 0:"tabular-nums"}function kf(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Mf(t,n={},r,o){let{columns:i,tickFormat:a,fontVariant:u=xf(t),swatchSize:c=15,swatchWidth:s=c,swatchHeight:l=c,marginLeft:f=0,className:p,style:d,width:h}=n;const m=bf(n);p=Pf(p),a=function(t,n){return void 0===t?Ls(n)?Of:Es:"function"==typeof t?t:("string"==typeof t?Ls(n)?e.utcFormat:e.format:Rs)(t)}(a,t.domain);const g=wf("div",m).attr("class",p).attr("style",`\n        --swatchWidth: ${+s}px;\n        --swatchHeight: ${+l}px;\n      `);let y;return null!=i?(y=`\n      .${p}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${p}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${p}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,g.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${p}-swatch`).call(r,t).call((t=>t.append("div").attr("class",`${p}-label`).attr("title",a).text(a)))):(y=`\n      .${p} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${p}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,g.selectAll().data(t.domain).enter().append("span").attr("class",`${p}-swatch`).call(r,t).append((function(){return this.ownerDocument.createTextNode(a.apply(this,arguments))}))),g.call((t=>t.insert("style","*").text(`\n        .${p} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===f?"":`\n          margin-left: ${+f}px;`}${void 0===h?"":`\n          width: ${h}px;`}\n        }\n        ${o(p)}\n        ${y}\n      `))).style("font-variant",jf(u,"normal")).call(Tf,d).node()}const Ef=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:Ws(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:u=4.5,...c}={},s){const[l,f]=Cs(n),[p,d]=Cs(o),h=kf(s,l),m=kf(s,p),g=u*u*Math.PI;return r=Ns(r)[1],i=Ns(i)[1],a=Ns(a)[1],Mf(t,c,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===l?t=>h.scale(t):null).attr("stroke","color"===p?t=>m.scale(t):null).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,g),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${i};\n      }`))}],["color",Cf],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return Cf({type:t,...r,interpolate:Nf(i)},{legend:o,...a})}]]);function Rf(t,{label:e,ticks:n,tickFormat:r}={},o){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(o,t,{label:e,ticks:n,tickFormat:r})}function Cf(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,e){if(!of(t)&&!function({type:t}){return"threshold"===t}(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Mf(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:u=18,marginRight:c=0,marginBottom:s=16+o,marginLeft:l=0,style:f,ticks:p=(i-l-c)/64,tickFormat:d,fontVariant:h=xf(t),round:m=!0,className:g}=n;const y=bf(n);g=Pf(g),null===d&&(d=()=>null);const v=wf("svg",y).attr("class",g).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`\n        .${g} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${g} text {\n          white-space: pre;\n        }\n      `))).call(Tf,f);let b,w=t=>t.selectAll(".tick line").attr("y1",u+s-a);const S=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:O,domain:j,range:$,interpolate:P,scale:T,pivot:x}=t;if(P){const t=void 0===$?P:e.piecewise(1===P.length?Cl(P):P,$);b=S(T.copy(),e.quantize(e.interpolateNumber(l,i-c),Math.min(j.length+(void 0!==x),void 0===$?1/0:$.length)));const n=256,r=y.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);v.append("image").attr("x",l).attr("y",u).attr("width",i-l-c).attr("height",a-u-s).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===O){const t=j,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;b=S(e.scaleLinear().domain([-1,$.length-1]),[l,i-c]),v.append("g").selectAll().data($).enter().append("rect").attr("x",((t,e)=>b(e-1))).attr("y",u).attr("width",((t,e)=>b(e)-b(e-1))).attr("height",a-u-s).attr("fill",(t=>t)),p=qs(t,((t,e)=>e)),d=e=>n(t[e],e)}else b=S(e.scaleBand().domain(j),[l,i-c]),v.append("g").selectAll().data(j).enter().append("rect").attr("x",b).attr("y",u).attr("width",Math.max(0,b.bandwidth()-1)).attr("height",a-u-s).attr("fill",T),w=()=>{};return v.append("g").attr("transform",`translate(0,${a-s})`).call(e.axisBottom(b).ticks(Array.isArray(p)?null:p,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(p)?p:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",jf(h,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==r&&v.append("text").attr("x",l).attr("y",u-6).attr("fill","currentColor").attr("font-weight","bold").text(r),v.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Nf(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}var Bf="#ch-plugin-legend",qf={enabled:!0,itemSelector:null,label:null,width:130},Df=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Legend",this.calendar=t,this.root=null,this.shown=!1,this.options=qf}var r,o,i;return r=e,o=[{key:"setup",value:function(t){this.options=Object.assign(Object.assign({},qf),t)}},{key:"paint",value:function(){var e=this.calendar.options.options.scale,n=this.options,r=n.enabled,o=n.itemSelector;if(!r||o&&t.select(o).empty())return this.destroy();this.shown=!0,this.root=t.select(o||this.calendar.options.options.itemSelector),this.root.select(Bf).empty()?this.root=this.root.append("div").attr("id",Bf.slice(1)):this.root=this.root.select(Bf);var i=function(t={}){for(const[e,n]of Ef){const r=t[e];if(As(r)){const o=bf(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&As(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(Ql(e,r,i),Rf(o,r,t),(e=>As(t[e])?Ql(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")}(Object.assign(Object.assign({},e),this.options));return this.root.selectAll("*").remove(),this.root.append((function(){return i})),Promise.resolve()}},{key:"destroy",value:function(){return null!==this.root&&(this.root.remove(),this.root=null),Promise.resolve()}}],o&&n(r.prototype,o),i&&n(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();return Df}));//# sourceMappingURL=Legend.min.js.map
